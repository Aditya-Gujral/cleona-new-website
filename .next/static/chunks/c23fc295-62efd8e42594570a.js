"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[865],{71613:function(e,t,n){let i,r;n.r(t),n.d(t,{BackLink:function(){return eP},ChildLink:function(){return eA},ComponentBuilder:function(){return rF},ComponentViewBuilder:function(){return rX},ConfirmDeleteDialogContainer:function(){return eY},DEFAULT_INTENT_HANDLER:function(){return r9},DocumentBuilder:function(){return r1},DocumentInspectorHeader:function(){return t3},DocumentListBuilder:function(){return os},DocumentListItemBuilder:function(){return of},DocumentPane:function(){return iG},DocumentPaneProvider:function(){return iq},DocumentTypeListBuilder:function(){return og},FormViewBuilder:function(){return rY},GenericListBuilder:function(){return oi},GenericViewBuilder:function(){return rG},HELP_URL:function(){return rM},InitialValueTemplateItemBuilder:function(){return r3},LOADING_PANE:function(){return tG},ListBuilder:function(){return op},ListItemBuilder:function(){return om},LoadingPane:function(){return tU},MenuItemBuilder:function(){return rL},MenuItemGroupBuilder:function(){return rU},Pane:function(){return e1},PaneContainer:function(){return rz},PaneContent:function(){return e3},PaneHeader:function(){return tp},PaneHeaderActions:function(){return t$},PaneItem:function(){return tD},PaneLayout:function(){return tj},ParameterizedLink:function(){return eO},ReferenceChildLink:function(){return eN},SerializeError:function(){return r$},StructureToolProvider:function(){return oq},_DEBUG:function(){return tF},component:function(){return rZ},createStructureBuilder:function(){return ow},defaultInitialValueTemplateItems:function(){return r5},defaultIntentChecker:function(){return r6},documentFromEditor:function(){return r2},documentFromEditorWithInitialValue:function(){return r8},form:function(){return rQ},getOrderingMenuItem:function(){return rA},getOrderingMenuItemsForSchemaType:function(){return rO},getTypeNamesFromFilter:function(){return ol},isDocumentListItem:function(){return ox},maybeSerializeInitialValueTemplateItem:function(){return r4},maybeSerializeMenuItem:function(){return rP},maybeSerializeMenuItemGroup:function(){return rN},maybeSerializeView:function(){return rW},menuItemsFromInitialValueTemplateItems:function(){return r7},pane:function(){return oG},pane$1:function(){return oW},setActivePanes:function(){return ok},shallowIntentChecker:function(){return on},structureLocaleNamespace:function(){return ek},structureTool:function(){return oF},useDocumentPane:function(){return tH},useDocumentTitle:function(){return t0},usePane:function(){return e8},usePaneLayout:function(){return eL},usePaneRouter:function(){return eU},useStructureTool:function(){return tK}});var o=n(3870),s=n(57437),l=n(31031),a=n(2265),c=n(97806),d=n(16144),u=n(6811),p=n(34532),m=n(75080),h=n(97277),f=n(88477),x=n(17245),g=n(95492),y=n(81976),b=n(80203),j=n(90195),v=n(4572),w=n(89183),C=n(24735),_=n(83826),k=n(28748),I=n(5730),E=n(59023),T=n(74222),S=n(8450),z=n(3609),$=n(16628),M=n(64221),R=n(71134),D=n(45715),P=n(96059),L=n(61125),A=n(54196),O=n(9043),N=n(76598),U=n(1228),H=n(18952),V=n(2502),B=n(75086),F=n(65690),q=n(69944),G=n(70394),W=n(2127),K=n(78699),X=n(47127),Y=n(39864),Q=n(79375),Z=n(50054),J=n(99095),ee=n(88581),et=n(43182),en=n(1537),ei=n(42764),er=n(90089),eo=n(81302),es=n(4381),el=n(27025),ea=n(49530),ec=n(67424),ed=n(66345),eu=n(1770),ep=n(48527),em=n(20450),eh=n(12916),ef=n(37063),ex=n(45789),eg=n(60555),ey=n(71519),eb=n(90374),ej=n(89648),ev=n(25616),ew=n(34641),eC=n(33514),e_=n(54175);let ek="structure",eI=(0,f.CVH)({locale:"en-US",namespace:ek,resources:()=>n.e(6927).then(n.bind(n,46927))});function eE(e){let{document:t}=e,n=(0,f.I_y)().get(t._type),{t:i}=(0,f.$G7)(ek),{error:r,value:o}=(0,f._2T)({schemaType:n,value:t});return n?r?(0,s.jsx)(s.Fragment,{children:i("doc-title.error.text",{errorMessage:r.message})}):(0,s.jsx)(s.Fragment,{children:o?.title||(0,s.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:i("doc-title.fallback.text")})}):(0,s.jsx)("code",{children:i("doc-title.unknown-schema-type.text",{schemaType:t._type})})}let eT=(0,w.zo)(l.xu)`
  margin-left: auto;
`,eS=w.zo.details`
  flex: none;

  &[open] ${eT} {
    transform: rotate(180deg);
  }
`,ez=w.zo.summary`
  list-style: none;

  &::-webkit-details-marker {
    display: none;
  }
`,e$=w.zo.table`
  width: 100%;
  text-align: left;
  padding: 0 ${({theme:e})=>(0,l.hO)(e.sanity.space[2])};
  border-collapse: collapse;

  th {
    padding: ${({theme:e})=>(0,l.hO)(e.sanity.space[1])};
  }

  td {
    padding: 0 ${({theme:e})=>(0,l.hO)(e.sanity.space[1])};
  }

  tr > *:last-child {
    text-align: right;
  }
`,eM=(0,w.zo)(l.kC)`
  min-height: 33px;
`,eR=e=>{let{t}=(0,f.$G7)(ek),n=e.totalCount-e.references.length;return n?(0,s.jsx)(l.xu,{padding:2,children:(0,s.jsxs)(l.gF,{space:2,children:[(0,s.jsx)(l.xv,{size:1,muted:!0,children:t("confirm-delete-dialog.other-reference-count.title",{count:n})}),(0,s.jsx)(o.u,{portal:!0,placement:"top",content:t("confirm-delete-dialog.other-reference-count.tooltip"),children:(0,s.jsx)(l.xv,{size:1,muted:!0,children:(0,s.jsx)(d.hQ6,{})})})]})}):null};function eD(e){let{icon:t,layout:n,presence:i,schemaType:r,value:c}=e,d=(0,f.Uy$)(c.title)&&(0,a.isValidElement)(c.title)||ey(c.title)||eg(c.title)?c.title:null,u=(0,a.useMemo)(()=>(0,f.eLL)(e.documentPreviewStore,r,c._id,d),[e.documentPreviewStore,r,d,c._id]),{draft:p,published:m,isLoading:h}=(0,el.m)(u,{draft:null,isLoading:!0,published:null}),x=h?null:(0,s.jsx)(o.uE,{children:(0,s.jsxs)(l.kC,{align:"center",gap:3,children:[i&&i.length>0&&(0,s.jsx)(f.mEJ,{presence:i}),(0,s.jsx)(f.aAo,{draft:p,published:m})]})}),g=(0,s.jsx)(f._mO,{draft:p,published:m});return(0,s.jsx)(f.ogX,{...(0,f.L_b)({value:c,draft:p,published:m}),isPlaceholder:h,icon:t,layout:n,status:x,tooltip:g})}let eP=(0,a.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i}=(0,a.useContext)(c.ud),r=(0,a.useMemo)(()=>n.slice(0,i),[i,n]),o=(0,a.useMemo)(()=>({panes:r}),[r]);return(0,s.jsx)(_.Px,{...e,ref:t,state:o})});function eL(){let e=(0,a.useContext)(c.yq);if(!e)throw Error("PaneLayout: missing context value");return e}let eA=(0,a.forwardRef)(function(e,t){let{childId:n,childPayload:i,childParameters:r,...o}=e,{routerPanesState:l,groupIndex:d}=(0,a.useContext)(c.ud);return(0,s.jsx)(_.Px,{...o,ref:t,state:{panes:[...l.slice(0,d+1),[{id:n,params:r,payload:i}]]}})}),eO=(0,a.forwardRef)(function(e,t){let{routerPanesState:n,groupIndex:i,siblingIndex:r}=(0,a.useContext)(c.ud),{params:o,payload:l,...d}=e,u=(0,f.BoV)(o),p=(0,f.BoV)(l),m=(0,a.useMemo)(()=>{let e=n[i],t=e[r],o={...t,params:u??t.params,payload:p??t.payload},s=[...e.slice(0,r),o,...e.slice(r+1)];return{panes:[...n.slice(0,i),s,...n.slice(i+1)]}},[n,i,u,p,r]);return(0,s.jsx)(_.Px,{ref:t,...d,state:m})}),eN=(0,a.forwardRef)(function({documentId:e,documentType:t,parentRefPath:n,children:i,template:r,...o},l){return(0,s.jsx)(eA,{...o,ref:l,childId:e,childPayload:r?.params,childParameters:{type:t,parentRefPath:(0,k.BB)(n),...r&&{template:r?.id}},children:i})});function eU(){return(0,a.useContext)(c.ud)}let eH=[];function eV(e){let{onClick:t,type:n,value:i}=e,r=(0,f.vsM)(i?._id),o=(0,f.Dqo)(r),l=(0,f.rq_)(),{ReferenceChildLink:c}=eU(),d=(0,a.useCallback)(function(e){return(0,s.jsx)(c,{documentId:i?._id,documentType:n?.name,parentRefPath:eH,...e})},[c,n?.name,i?._id]);return(0,s.jsx)(f.oUE,{__unstable_focusRing:!0,as:d,"data-as":"a",onClick:t,radius:2,children:(0,s.jsx)(eD,{documentPreviewStore:l,icon:n?.icon,layout:"compact",presence:o?.length>0?o:eH,schemaType:n,value:i})})}function eB({crossDatasetReferences:e,internalReferences:t,documentTitle:n,totalCount:i,action:r,datasetNames:c,hasUnknownDatasetNames:u,onReferenceLinkClick:p}){let m=(0,f.I_y)(),h=(0,l.pm)(),{t:x}=(0,f.$G7)(ek),g=(0,a.useCallback)(e=>{let t=m.get(e._type);return t?(0,s.jsx)(eV,{type:t,value:e,onClick:p}):(0,s.jsx)(l.xu,{padding:2,children:(0,s.jsx)(f.ogX,{icon:d.Tzq,title:x("confirm-delete-dialog.preview-item.preview-unavailable.title"),subtitle:x("confirm-delete-dialog.preview-item.preview-unavailable.subtitle",{documentId:e._id}),layout:"default"})})},[m,x,p]);if(t?.totalCount===0&&e?.totalCount===0)return(0,s.jsx)(l.xv,{as:"p",size:1,children:(0,s.jsx)(f.vNl,{t:x,i18nKey:"confirm-delete-dialog.confirmation.text",context:r,components:{DocumentTitle:()=>(0,s.jsx)("strong",{children:n})}})});let y=[...c,...u?["unavailable"]:[]],b=x("confirm-delete-dialog.cdr-summary.subtitle",{count:y.length,datasets:y.join(", "),context:u&&y.length?"unavailable":""});return(0,s.jsxs)(l.kC,{direction:"column",gap:4,children:[(0,s.jsx)(l.Zb,{padding:3,radius:2,tone:"caution",flex:"none",children:(0,s.jsxs)(l.kC,{children:[(0,s.jsx)(l.xv,{"aria-hidden":"true",size:1,children:(0,s.jsx)(d.foC,{})}),(0,s.jsx)(l.xu,{flex:1,marginLeft:3,children:(0,s.jsx)(l.xv,{size:1,children:(0,s.jsx)(f.vNl,{i18nKey:"confirm-delete-dialog.referring-document-count.text",components:{DocumentTitle:()=>n},t:x,values:{count:i}})})})]})}),(0,s.jsx)(l.xu,{flex:"none",children:(0,s.jsx)(l.xv,{size:1,children:(0,s.jsx)(f.vNl,{i18nKey:"confirm-delete-dialog.referring-documents-descriptor.text",t:x,context:r,components:{DocumentTitle:()=>n}})})}),(0,s.jsx)(l.Zb,{radius:2,shadow:1,flex:"auto",padding:2,children:(0,s.jsxs)(l.kC,{direction:"column",children:[t.totalCount>0&&(0,s.jsxs)(l.Kq,{as:"ul",marginBottom:2,space:2,"data-testid":"internal-references",children:[t?.references.map(e=>s.jsx(l.xu,{as:"li",children:g(e)},e._id)),t.totalCount>t.references.length&&(0,s.jsx)(l.xu,{as:"li",padding:3,children:(0,s.jsx)(eR,{...t})})]}),e.totalCount>0&&(0,s.jsxs)(eS,{"data-testid":"cross-dataset-references",style:{borderTop:t.totalCount>0?"1px solid var(--card-shadow-outline-color)":void 0},children:[(0,s.jsx)(ez,{children:(0,s.jsx)(l.Zb,{as:"a",marginTop:t.totalCount>0?2:0,radius:2,shadow:1,paddingY:1,children:(0,s.jsxs)(l.kC,{align:"center",gap:3,paddingX:3,paddingY:1,children:[(0,s.jsx)(l.xv,{size:1,children:(0,s.jsx)(d.TAM,{})}),(0,s.jsxs)(l.Kq,{space:2,children:[(0,s.jsx)(l.xv,{textOverflow:"ellipsis",size:1,children:x("confirm-delete-dialog.cdr-summary.title",{count:y.length,documentCount:x("confirm-delete-dialog.cdr-summary.document-count",{count:e.totalCount})})}),(0,s.jsx)(l.xv,{title:b,textOverflow:"ellipsis",size:1,muted:!0,children:b})]}),(0,s.jsx)(eT,{children:(0,s.jsx)(l.xv,{muted:!0,size:1,children:(0,s.jsx)(d.v4q,{})})})]})})}),(0,s.jsxs)(l.xu,{overflow:"auto",paddingTop:2,children:[(0,s.jsxs)(e$,{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:(0,s.jsx)(l.xv,{muted:!0,size:1,style:{minWidth:"5rem"},weight:"medium",children:x("confirm-delete-dialog.cdr-table.project-id.label")})}),(0,s.jsx)("th",{children:(0,s.jsx)(l.xv,{muted:!0,size:1,weight:"medium",children:x("confirm-delete-dialog.cdr-table.dataset.label")})}),(0,s.jsx)("th",{children:(0,s.jsx)(l.xv,{muted:!0,size:1,weight:"medium",children:x("confirm-delete-dialog.cdr-table.document-id.label")})})]})}),(0,s.jsx)("tbody",{children:e.references.filter(e=>"projectId"in e).map(({projectId:e,datasetName:t,documentId:n},i)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)(l.xv,{size:1,children:e})}),(0,s.jsx)("td",{children:(0,s.jsx)(l.xv,{size:1,children:t||"unavailable"})}),(0,s.jsx)("td",{children:(0,s.jsxs)(eM,{align:"center",gap:2,justify:"flex-end",children:[(0,s.jsx)(l.xv,{textOverflow:"ellipsis",size:1,children:n||"unavailable"}),n&&(0,s.jsx)(ex,{text:n,onCopy:()=>{h.push({title:x("confirm-delete-dialog.cdr-table.id-copied-toast.title"),status:"success"})},children:(0,s.jsx)(o.zx,{mode:"bleed",icon:d.TIy,tooltipProps:{content:x("confirm-delete-dialog.cdr-table.copy-id-button.tooltip")}})})]})})]},`${n}-${i}`))})]}),(0,s.jsx)(eR,{...e})]})]})]})}),(0,s.jsx)(l.xu,{flex:"none",children:(0,s.jsx)(l.xv,{size:1,children:(0,s.jsx)(f.vNl,{i18nKey:"confirm-delete-dialog.referential-integrity-disclaimer.text",t:x,context:r,components:{DocumentTitle:()=>n}})})})]})}let eF=()=>(i||(i=(0,I.R)(document,"visibilitychange").pipe((0,X.O)(null),(0,F.U)(()=>"visible"===document.visibilityState),(0,Y.x)(),(0,Q.w)(e=>e?(0,E.H)(0,5e3):T.E),(0,Z.d)({refCount:!0,bufferSize:1}))),i),eq=(0,f.ek8)(([e,t])=>t.listenQuery({fetch:'{"references":*[references($documentId)][0...100]{_id,_type},"totalCount":count(*[references($documentId)])}',listen:"*[references($documentId)]"},{documentId:e},{tag:"use-referring-documents",transitions:["appear","disappear"],throttleTime:5e3})),eG=(0,f.ek8)(([e,t])=>eF().pipe((0,Q.w)(()=>(function(e,t){let{versionedClient:n}=t;return eF().pipe((0,Q.w)(()=>(function(e,{versionedClient:t}){let n=(0,f.qyu)(e),i=(0,f.vsM)(e),r={uri:t.getDataUrl("doc",`${n},${i}`),json:!0,query:{excludeContent:"true"},tag:"use-referring-documents.document-existence"};return t.observable.request(r).pipe((0,F.U)(({omitted:e})=>{let t=e.filter(e=>"existence"===e.reason);if(2!==t.length)return 0===t.length||t.some(e=>e.id===n)?i:n}))})(e,t)),(0,Q.w)(e=>{if(!e)return(0,S.of)({totalCount:0,references:[]});let t=n.config().dataset;return n.observable.request({url:`/data/references/${t}/documents/${e}/to?excludeInternalReferences=true&excludePaths=true`,tag:"use-referring-documents.external"}).pipe((0,K.K)(e=>{if("object"==typeof e&&e&&"statusCode"in e&&"response"in e&&404===e.statusCode)return(0,S.of)({totalCount:0,references:[]});throw e}))}))})(e,{versionedClient:t})))),eW=(0,w.zo)(l.xu)`
  box-sizing: border-box;
`,eK=(0,w.zo)(l.kC).attrs({align:"center",direction:"column",justify:"center"})`
  height: 110px;
`;function eX({id:e,type:t,action:n="delete",onCancel:i,onConfirm:r}){let{t:l}=(0,f.$G7)(ek),c=`deletion-confirmation-${(0,a.useId)()}`,{internalReferences:d,crossDatasetReferences:u,isLoading:p,totalCount:m,projectIds:h,datasetNames:x,hasUnknownDatasetNames:g}=function(e){let t=(0,f.m85)(f.Dr7),n=(0,f.H__)(),i=(0,f.vsM)(e),[r,o]=eq((0,a.useMemo)(()=>[i,n],[n,i])),[s,l]=eG((0,a.useMemo)(()=>[i,t],[i,t])),c=(0,a.useMemo)(()=>Array.from(new Set(s?.references.map(e=>e.projectId).filter(Boolean))).sort(),[s?.references]),d=(0,a.useMemo)(()=>Array.from(new Set(s?.references.map(e=>e?.datasetName||"").filter(e=>!!e&&""!==e))).sort(),[s?.references]),u=(0,a.useMemo)(()=>!!s?.references.some(e=>"string"!=typeof e.datasetName),[s?.references]);return{totalCount:(r?.totalCount||0)+(s?.totalCount||0),projectIds:c,datasetNames:d,hasUnknownDatasetNames:u,internalReferences:r,crossDatasetReferences:s,isLoading:o||l}}(e),y=(0,s.jsx)(eE,{document:(0,a.useMemo)(()=>({_id:e,_type:t}),[e,t])}),b=!p;return(0,s.jsx)(o.Vq,{width:1,id:c,header:l("confirm-delete-dialog.header.text",{context:n}),footer:{cancelButton:{onClick:i,text:l("confirm-delete-dialog.cancel-button.text")},confirmButton:b?{text:l(m>0?"confirm-delete-dialog.confirm-anyway-button.text":"confirm-delete-dialog.confirm-button.text",{context:n}),onClick:r}:void 0},onClose:i,onClickOutside:i,children:(0,s.jsx)(eW,{children:u&&d&&!p?(0,s.jsx)(eB,{crossDatasetReferences:u,internalReferences:d,documentTitle:y,isLoading:p,totalCount:m,action:n,projectIds:h,datasetNames:x,hasUnknownDatasetNames:g,onReferenceLinkClick:i}):(0,s.jsx)(eK,{"data-testid":"loading-container",children:(0,s.jsx)(f.Bwn,{showText:!0,title:l("confirm-delete-dialog.loading.text")})})})})}function eY(e){let{t}=(0,f.$G7)(ek),n=(0,a.useId)(),[i,r]=(0,a.useState)(null),c=(0,a.useCallback)(()=>r(null),[]);return i?(0,s.jsx)(o.Vq,{id:`dialog-error-${n}`,"data-testid":"confirm-delete-error-dialog",header:t("confirm-delete-dialog.error.title.text"),footer:{confirmButton:{text:t("confirm-delete-dialog.error.retry-button.text"),onClick:c,tone:"default"}},onClose:e.onCancel,children:(0,s.jsx)(l.xu,{padding:4,children:(0,s.jsx)(l.xv,{size:1,children:t("confirm-delete-dialog.error.message.text")})})}):(0,s.jsx)(l.SV,{onCatch:r,children:(0,s.jsx)(eX,{...e})})}function eQ({children:e,ms:t=0}){let[n,i]=(0,a.useState)(t<=0);return(0,a.useEffect)(()=>{if(t<=0)return;let e=setTimeout(()=>i(!0),t);return()=>{clearTimeout(e)}},[t]),n&&e?"function"==typeof e?e():e:(0,s.jsx)(s.Fragment,{})}let eZ=(0,w.zo)(l.mh)`
  position: relative;
  width: 1px;
  min-width: 1px;

  &:before {
    content: '';
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: 1px;
    background-color: var(--card-border-color);
  }

  &:not([data-disabled]) {
    cursor: ew-resize;
    width: 9px;
    min-width: 9px;
    margin: 0 -4px;

    &:before {
      left: 4px;
    }

    &:after {
      content: '';
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    &[data-dragging]:after,
    &:hover:after {
      opacity: 0.2;
    }
  }
`;function eJ({disabled:e,element:t}){let{resize:n}=eL(),[i,r]=(0,a.useState)(!1),o=(0,a.useCallback)(e=>{if(!t)return;r(!0),e.preventDefault();let i=e.pageX;n("start",t,0);let o=e=>{e.preventDefault(),n("move",t,e.pageX-i)},s=e=>{e.preventDefault(),r(!1),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",s),n("end",t,0)};window.addEventListener("mousemove",o),window.addEventListener("mouseup",s)},[t,n]);return(0,s.jsx)(eZ,{"data-disabled":e?"":void 0,"data-dragging":i?"":void 0,onMouseDown:o})}let e0=(0,w.zo)(l.Zb)`
  outline: none;

  // NOTE: This will render a border to the right side of each pane
  // without taking up physical space.
  box-shadow: 1px 0 0 var(--card-border-color);
`,e1=(0,a.forwardRef)(function(e,t){let{children:n,currentMinWidth:i,currentMaxWidth:r,flex:o=1,id:d,minWidth:u,maxWidth:p,selected:m=!1,...h}=e,[x,g]=(0,a.useState)(null),{collapse:y,collapsed:b,expand:j,expandedElement:v,mount:w,panes:C}=eL(),_=C.find(e=>e.element===x),k=_&&C.indexOf(_),I="number"==typeof k?C[k+1]:void 0,E=k===C.length-1,T=!b&&(_?.collapsed||!1),S=I?.collapsed||!1,z=(0,a.useRef)(null),$=_?.flex??o,M=_?.currentMinWidth??i,R=_?.currentMaxWidth??r;(0,a.useImperativeHandle)(t,()=>z.current);let D=(0,a.useCallback)(e=>{g(e),z.current=e},[]);(0,a.useEffect)(()=>{if(x)return w(x,{currentMinWidth:i,currentMaxWidth:r,flex:o,id:d,minWidth:u,maxWidth:p})},[i,r,o,d,u,p,w,x]);let P=(0,a.useCallback)(()=>{x&&y(x)},[y,x]),L=(0,a.useCallback)(()=>{x&&j(x)},[j,x]),A=(0,a.useMemo)(()=>({collapse:P,collapsed:!b&&T,expand:L,index:k,isLast:E,rootElement:x}),[T,P,L,E,b,k,x]),O=(0,a.useMemo)(()=>{if(!b)return T?51:0===M||E?u||204:M||u||204},[T,M,E,b,u]),N=(0,a.useMemo)(()=>T?51:b&&E?void 0:E?p?R??p:void 0:R??p,[T,R,E,b,p]),U=b&&!E,H=(0,a.useMemo)(()=>!E&&!b&&(0,s.jsx)(f.jr5,{zOffset:"paneResizer",children:(0,s.jsx)(eJ,{disabled:T||S,element:x})}),[T,E,b,S,x]),V=(0,a.useMemo)(()=>({flex:$,minWidth:O,maxWidth:N===1/0?void 0:N}),[$,O,N]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.jr5,{zOffset:"pane",children:(0,s.jsx)(c.tc.Provider,{value:A,children:(0,s.jsx)(f.K4Y,{isLastPane:E,children:(0,s.jsxs)(e0,{"data-testid":"pane","data-ui":"Pane",tone:"inherit",hidden:U,id:d,overflow:b?void 0:"hidden",...h,"data-pane-collapsed":T?"":void 0,"data-pane-index":k,"data-pane-selected":m?"":void 0,ref:D,style:V,children:[!1,(0,s.jsx)(l.NM,{element:x,children:!U&&(0,s.jsx)(l.kC,{direction:"column",height:"fill",children:n})})]})})})}),H]})}),e2=(0,w.zo)(l.Zb)`
  position: relative;
  outline: none;
`;function e8(){let e=(0,a.useContext)(c.tc);if(!e)throw Error("Pane: missing context value");return e}e2.displayName="PaneContent__root";let e3=(0,a.forwardRef)(function(e,t){let{as:n,children:i,overflow:r,padding:o,...l}=e,{collapsed:a}=e8(),{collapsed:c}=eL();return(0,s.jsx)(e2,{"data-testid":"pane-content",forwardedAs:n,...l,flex:1,hidden:a,overflow:c?void 0:r,padding:o,ref:t,tone:"inherit",children:i})}),e5={constrainSize:!0,placement:"left-start",portal:!0};function e4(e){let{disabled:t,isAfterGroup:n,node:i}=e,r=(0,f.sr_)("i18n"in i?i:void 0);if("divider"===i.type)return(0,s.jsx)(l.R,{});let{title:a}=r(i);return"group"===i.type?0===i.children.length?null:i.expanded?(0,s.jsxs)(s.Fragment,{children:[n&&(0,s.jsx)(l.R,{}),i.children.map((e,n)=>(0,s.jsx)(e4,{disabled:t||!!i.disabled,isAfterGroup:i.children[n-1]?.type==="group",node:e},e.key))]}):(0,s.jsxs)(s.Fragment,{children:[n&&(0,s.jsx)(l.R,{}),(0,s.jsx)(o.kS,{disabled:t,icon:i.icon,popover:e5,text:a,children:i.children.map((e,n)=>(0,s.jsx)(e4,{disabled:t||!!i.disabled,isAfterGroup:i.children[n-1]?.type==="group",node:e},e.key))})]}):(0,s.jsxs)(s.Fragment,{children:[n&&(0,s.jsx)(l.R,{}),(0,s.jsx)(e7,{disabled:t,node:i})]})}function e7(e){let{node:t}=e;return t.intent?(0,s.jsx)(e6,{...e,intent:t.intent}):(0,s.jsx)(e9,{...e})}function e9(e){let{disabled:t,node:n}=e,i="object"==typeof n.disabled&&(0,s.jsx)(l.xv,{size:1,children:n.disabled.reason}),{title:r}=(0,f.v0Z)(n);return(0,s.jsx)(f.xMr,{content:i,placement:"left",children:(0,s.jsx)(o.sN,{disabled:t||!!n.disabled,hotkeys:n.hotkey?.split("+"),icon:n.icon,iconRight:n.iconRight||n.selected&&d.KML,onClick:n.onAction,pressed:n.selected,text:r,tone:n.tone})})}function e6(e){let{disabled:t,intent:n,node:i}=e,r="object"==typeof i.disabled&&(0,s.jsx)(l.xv,{size:1,children:i.disabled.reason}),c=(0,_.PM)({intent:n.type,params:n.params}),u=(0,a.useCallback)(e=>{c.onClick(e),i.onAction()},[c,i]),{title:p}=(0,f.v0Z)(i);return(0,s.jsx)(f.xMr,{content:r,placement:"left",children:(0,s.jsx)(o.sN,{as:"a",disabled:t||!!i.disabled,hotkeys:i.hotkey?.split("+"),href:c.href,icon:i.icon,iconRight:i.selected?d.KML:void 0,onClick:u,pressed:i.selected,text:p,tone:i.tone})})}let te={constrainSize:!0,placement:"bottom",portal:!0};function tt(e,t){return e.some(e=>"item"===e.type&&e.tone===t||"group"===e.type&&tt(e.children,t))}function tn(e){let{nodes:t,actionsNodes:n}=e,i=(0,a.useId)(),r=tt(t,"critical"),c=tt(t,"caution");return(0,s.jsx)(o.j2,{button:(0,s.jsx)(f.lXN,{tone:r?"critical":c?"caution":void 0,"data-testid":"pane-context-menu-button"}),id:i,menu:(0,s.jsxs)(l.v2,{children:[n&&(0,s.jsxs)(s.Fragment,{children:[n,(0,s.jsx)(l.R,{})]}),t.map((e,n)=>{let i=t[n-1]?.type==="group";return(0,s.jsx)(e4,{isAfterGroup:i,node:e},e.key)})]}),popover:te})}let ti=(0,w.zo)(l.mh)`
  position: sticky;
  bottom: 0;

  &:before {
    content: '';
    display: block;
    position: absolute;
    left: 0;
    right: 0;
    top: -1px;
    border-bottom: 1px solid var(--card-border-color);
  }
`,tr=(0,w.zo)(l.Zb)`
  padding-bottom: env(safe-area-inset-bottom);
`,to=(0,a.forwardRef)(function(e,t){let{children:n,padding:i}=e,{collapsed:r}=e8();return(0,s.jsx)(f.jr5,{zOffset:"paneFooter",children:(0,s.jsx)(ti,{"data-testid":"pane-footer",hidden:r,ref:t,children:(0,s.jsx)(tr,{tone:"inherit",children:(0,s.jsx)(l.xu,{padding:i,children:n})})})})}),ts=(0,w.zo)(l.mh)(({$border:e})=>(0,w.iv)`
    line-height: 0;
    position: sticky;
    top: 0;

    &:not([data-collapsed]):after {
      content: '';
      display: block;
      position: absolute;
      left: 0;
      right: 0;
      bottom: -1px;
      border-bottom: 1px solid ${e?"var(--card-border-color)":"transparent"};
      opacity: 1;
    }
  `),tl=(0,w.zo)(l.kC)`
  transform-origin: calc(51px / 2);

  [data-collapsed] > div > & {
    transform: rotate(90deg);
  }
`,ta=(0,w.zo)(l.Zb)(({theme:e})=>{let{fg:t,bg:n}=e.sanity.color.card.enabled;return(0,w.iv)`
    background-color: ${n};

    [data-ui='Text'] {
      color: ${t};
    }
  `}),tc=(0,w.zo)(l.Qr)`
  width: 66%;
  max-width: 175px;
`,td=(0,w.zo)(l.xv)`
  cursor: default;
  outline: none;
`,tu=(0,w.zo)(l.xu)(({theme:e})=>{let{color:t,space:n}=e.sanity;return(0,w.iv)`
    overflow: hidden;
    overflow: clip;
    position: relative;

    & > div {
      white-space: nowrap;
      overflow: auto;
      /* Hide scrollbars */
      scrollbar-width: none;
      &::-webkit-scrollbar {
        width: 0;
        height: 0;
      }
    }

    /* right padding */
    & > div:after {
      content: '';
      display: inline-block;
      top: 0;
      right: 0;
      bottom: 0;
      width: ${n[3]}px;
      height: 1px;
    }

    /* Gradient that makes it look like tabs disappear into nothing (looks nicer) */
    &:after {
      content: '';
      display: block;
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(to right, ${(0,l.m4)(t.base.bg,0)}, var(--card-bg-color));
      width: ${n[3]}px;
      pointer-events: none;
    }
  `}),tp=(0,a.forwardRef)(function(e,t){let{actions:n,backButton:i,border:r,contentAfter:o,loading:c,subActions:d,tabs:u,tabIndex:p,title:m}=e,{collapse:h,collapsed:x,expand:g,rootElement:y}=e8(),b=(0,l.XL)(y||null),j=(0,a.useMemo)(()=>({width:x?b?.height||window.innerHeight:void 0}),[x,b]),v=(0,a.useCallback)(()=>{x||h()},[h,x]),w=(0,a.useCallback)(()=>{x&&g()},[x,g]);return(0,s.jsx)(l.li,{zOffset:100,children:(0,s.jsx)(ts,{$border:r,"data-collapsed":x?"":void 0,"data-testid":"pane-header",ref:t,children:(0,s.jsx)(f.jr5,{zOffset:"paneHeader",children:(0,s.jsxs)(l.Zb,{"data-collapsed":x?"":void 0,tone:"inherit",children:[(0,s.jsxs)(tl,{gap:1,onClick:w,padding:3,paddingBottom:x?3:2,sizing:"border",style:j,children:[i&&(0,s.jsx)(l.xu,{flex:"none",children:i}),(0,s.jsxs)(ta,{__unstable_focusRing:!0,flex:1,forwardedAs:"button",onClick:v,paddingLeft:i?1:2,padding:2,tabIndex:p,children:[c&&(0,s.jsx)(tc,{animated:!0,radius:1,size:1}),!c&&(0,s.jsx)(td,{size:1,textOverflow:"ellipsis",weight:"semibold",children:m})]}),n&&(0,s.jsx)(l.kC,{align:"center",hidden:x,children:(0,s.jsx)(f.jr5,{zOffset:"paneHeader",children:n})})]}),!!(!x&&(u||d))&&(0,s.jsxs)(l.kC,{align:"center",hidden:x,overflow:"auto",paddingBottom:3,paddingX:3,children:[(0,s.jsx)(tu,{flex:1,marginRight:d?3:0,children:u}),d&&d]}),!x&&o&&o]})})})})});function tm(e){return e.disabled?{disabledReason:"object"==typeof e.disabled?e.disabled.reason:void 0,ariaLabel:"object"==typeof e.disabled&&"string"==typeof e.disabled?.reason?e.disabled.reason:"This is disabled",isDisabled:!!e.disabled}:{disabledReason:void 0,ariaLabel:void 0,isDisabled:!1}}function th(e){let{node:t}=e;return"item"===t.type?(0,s.jsx)(tf,{node:t}):"group"===t.type?(0,s.jsx)(tg,{node:t}):(console.warn('unknown menu node (expected `type: "item" | "group"`):',t),null)}function tf(e){let{node:t}=e,{title:n}=(0,f.v0Z)(t),{t:i}=(0,f.$G7)();if(t.intent)return(0,s.jsx)(tx,{...e,intent:t.intent});let{disabledReason:r,ariaLabel:o,isDisabled:l}=tm(t);return(0,s.jsx)(f.YG6,{disabled:l,icon:t.icon,onClick:t.onAction,selected:t.selected,tone:t.tone,"aria-label":o||n||i("status-button.aria-label"),tooltipProps:{hotkeys:!l&&t.hotkey?t.hotkey.split("+"):void 0,content:l?r:n}})}function tx(e){let{intent:t,node:n}=e,i=(0,_.PM)({intent:t.type,params:t.params}),{t:r}=(0,f.$G7)(),o=(0,a.useCallback)(e=>{i.onClick(e),n.onAction()},[i,n]),{disabledReason:l,ariaLabel:c,isDisabled:d}=tm(n);return(0,s.jsx)(f.YG6,{forwardedAs:"a",disabled:d,href:i.href,icon:n.icon,onClick:o,selected:n.selected,tone:n.tone,"aria-label":c||n.title||r("status-button.aria-label"),tooltipProps:{hotkeys:!d&&n.hotkey?n.hotkey.split("+"):void 0,content:d?l:n.title,placement:"bottom",portal:!0}})}function tg(e){let{node:t}=e,{title:n}=(0,f.v0Z)(t);return(0,s.jsx)(o.j2,{button:(0,s.jsx)(o.zx,{disabled:!!t.disabled,icon:t.icon??d.Tzq,label:n,mode:"bleed",tooltipProps:{content:t.title,portal:!0}}),id:(0,a.useId)(),menu:(0,s.jsx)(l.v2,{children:t.children.map((e,n)=>(0,s.jsx)(e4,{disabled:!!t.disabled,isAfterGroup:t.children[n-1]?.type==="group",node:e},e.key))})})}let ty=(0,w.zo)(l.Zb)`
  transition: opacity 200ms;
  position: relative;
  z-index: 1;
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
  opacity: 0;

  &:not([hidden]) {
    display: flex;
  }

  &:not([data-collapsed]) {
    overflow: auto;
  }

  &[data-mounted] {
    opacity: 1;
  }

  &[data-resizing] {
    pointer-events: none;
  }
`,tb=[];function tj(e){let{children:t,minWidth:n,onCollapse:i,onExpand:r,...o}=e,d=(0,a.useMemo)(()=>(function(){let e=[],t=[],n=new WeakMap,i=new Set,r={},o=null,s=0,l=null,a=new Map,c=!1;function d(e){i.delete(e),l=e,u()}return{collapse:function(e){i.add(e),l===e&&(l=null),u()},expand:d,mount:function(e,i){return n.set(e,{...i,original:i}),t.push(e),o&&function(e,t){let n=new WeakMap;for(let i of t)n.set(i,function(e,t){let n=[],i=t;for(;i!==e;){let t=i.parentElement;if(!t)break;let r=Array.from(t.childNodes).indexOf(i);if(n.unshift(r),t===e)break;i=t}return n}(e,i));t.sort((e,t)=>{let i=n.get(e)||tb,r=n.get(t)||tb,o=Math.max(i.length,r.length);for(let e=0;e<o;e+=1){let t=i[e]||-1,n=r[e]||-1;if(t!==n)return t-n}return 0})}(o,t),d(e),()=>{let i=t.indexOf(e);i>-1&&t.splice(i,1),n.delete(e),u()}},resize:function(e,i,o){let s=t.indexOf(i),l=n.get(i);if(!l)return;let d=t[s+1],p=n.get(d);if(p){if("start"===e&&(c=!0,r.left={element:i,flex:l.flex||1,width:i.offsetWidth},r.right={element:d,flex:p.flex||1,width:d.offsetWidth},u()),"move"===e&&r.left&&r.right){a=new Map;let{leftW:e,rightW:t,leftFlex:n,rightFlex:s}=function(e,t,n,i){let r={flex:e.left.flex+e.right.flex,width:e.left.width+e.right.width},o=t.minWidth??204,s=n.minWidth??204,l=Math.min(t.maxWidth||1/0,r.width-s),a=Math.min(n.maxWidth||1/0,r.width-o),c=o-e.left.width,d=e.right.width-a;c<d&&(c=d);let u=e.right.width-s,p=l-e.left.width;u>p&&(u=p);let m=Math.min(Math.max(i,c),u),h=e.left.width+m,f=e.right.width-m;return{leftFlex:h/r.width*r.flex,leftW:h,rightFlex:f/r.width*r.flex,rightW:f}}(r,l,p,o);a.set(i,{flex:n,width:e}),a.set(d,{flex:s,width:t}),u()}if("end"===e){c=!1;let e=a.get(i),t=a.get(d);n.set(i,{...l,currentMinWidth:0,currentMaxWidth:l.maxWidth??1/0,flex:e?.flex??l.flex}),n.set(d,{...p,currentMinWidth:0,currentMaxWidth:l.maxWidth??1/0,flex:t?.flex??p.flex}),a=new Map,delete r.left,delete r.right,u()}}},setRootElement:function(e){o=e},setRootWidth:function(e){s=e,u()},subscribe:function(t){return e.push(t),()=>{let n=e.push(t);n>-1&&e.splice(n,1)}}};function u(){if(!s)return;let r=[];for(let e of t)e!==l&&r.unshift(e);l&&r.unshift(l);let o=new WeakMap,d=r.length,u=r[0],p=s-(d-1)*51;for(let e of r){let t=n.get(e);if(!t)continue;let r=t.currentMinWidth||t.minWidth||204,s=e===u,l=i.has(e),c=r>p,d=!s&&(l||c),m=a.get(e);o.set(e,{element:e,collapsed:d,currentMinWidth:m?.width??t.currentMinWidth,currentMaxWidth:m?.width??t.currentMaxWidth,flex:m?.flex??t.flex??1}),d?p-=51:p-=r-51}let m=[];for(let e of t){let t=o.get(e);t&&m.push(t)}for(let n of e)n({expandedElement:l||t[t.length-1]||null,panes:m,resizing:c})}})(),[]),[u,p]=(0,a.useState)(null),m=l.XL(u)?.width||0,h=void 0!==m&&n?m<n:void 0,[f,x]=(0,a.useState)({expandedElement:null,panes:[],resizing:!1});(0,a.useEffect)(()=>d.setRootElement(u),[d,u]),(0,a.useEffect)(()=>d.setRootWidth(m),[d,m]),(0,a.useEffect)(()=>d.subscribe(x),[d]),(0,a.useEffect)(()=>{void 0!==h&&(h&&i&&i(),!h&&r&&r())},[h,i,r]);let g=(0,a.useMemo)(()=>({collapse:d.collapse,collapsed:h,expand:d.expand,expandedElement:f.expandedElement,mount:d.mount,panes:f.panes,resize:d.resize,resizing:f.resizing}),[h,d,f.expandedElement,f.panes,f.resizing]);return(0,s.jsx)(c.yq.Provider,{value:g,children:(0,s.jsx)(ty,{"data-ui":"PaneLayout",...o,"data-collapsed":h?"":void 0,"data-resizing":f.resizing?"":void 0,"data-mounted":m?"":void 0,ref:p,children:t})})}function tv(e){return("item"===e.type||"group"===e.type)&&e.renderAsButton}let tw=ej(tv);function tC(e){let{fieldActions:t=[],menuItems:n,menuItemGroups:i}=e,r=[],o=0;for(let e=0;e<t.length;e+=1){let n=t[e];r.push(function e(t,n){return"divider"===t.type?{type:"divider",key:n}:"group"===t.type?{type:"group",key:n,children:t.children.map((t,i)=>e(t,`${n}-${i}-${t.type}`)),disabled:t.disabled,expanded:t.expanded??!0,icon:t.icon,title:t.title,i18n:t.i18n,renderAsButton:t.renderAsButton??!1}:{type:"item",key:n,intent:t.intent,disabled:t.disabled,icon:t.icon,iconRight:t.iconRight,onAction:t.onAction,renderAsButton:t.renderAsButton??!1,selected:t.selected,title:t.title,i18n:t.i18n,tone:t.tone}}(n,`${e}-${n.type}`))}o+=r.length;let s=[];for(let e of i)s.find(t=>t.key===e.id)||s.push({type:"group",key:e.id,children:[],expanded:!0,renderAsButton:!1,title:e.title,i18n:e.i18n});let l=[];for(let t=0;t<n.length;t+=1){let i=n[t],r=i.group&&s.find(e=>e.key===i.group);i.group&&!r&&(r={type:"group",key:i.group,expanded:!0,icon:i.icon,title:i.group,children:[],renderAsButton:!1},s.push(r)),r?r.children.push({type:"item",key:`${o+t}-item`,hotkey:i.shortcut,icon:i.icon,intent:i.intent,onAction:()=>e.actionHandler(i),renderAsButton:i.showAsAction??!1,selected:i.selected,title:i.title,i18n:i.i18n,tone:i.tone}):l.push({type:"item",key:`${o+t}-item`,hotkey:i.shortcut,icon:i.icon,intent:i.intent,onAction:()=>e.actionHandler(i),renderAsButton:i.showAsAction??!1,selected:i.selected,title:i.title,i18n:i.i18n,tone:i.tone})}return[...l,...s,...r]}let t_=(0,a.forwardRef)(function(e,t){let{intent:n,...i}=e,r=(0,a.useMemo)(()=>(0,a.forwardRef)(function(e,t){return(0,s.jsx)(_.nR,{...e,intent:n.type,params:n.params,ref:t})}),[n]);return e.disabled?(0,s.jsx)(o.zx,{...i,as:"a",role:"link","aria-disabled":"true"}):(0,s.jsx)(o.zx,{...i,as:r,"data-as":"a",ref:t})});function tk({reveal:e,context:t,loading:n,children:i}){let r=(0,f.xJ)(),{t:l}=(0,f.$G7)(ek);return e?(0,s.jsx)(o.u,{content:n?l("insufficient-permissions-message-tooltip.loading-text"):(0,s.jsx)(f.FMn,{context:t,currentUser:r}),portal:!0,children:(0,s.jsx)("div",{children:i})}):(0,s.jsx)(s.Fragment,{children:i})}let tI={constrainSize:!0,placement:"bottom",portal:!0},tE=(e,t,n)=>{let i=t.find(e=>e.id===n.templateId)?.schemaType;if(!i)return null;let r={template:n.templateId,type:i,id:n.initialDocumentId};return{type:"create",params:n.parameters?[r,n.parameters]:r}};function tT({templateItems:e}){let t=(0,f.I_y)(),n=(0,f.zEW)(),{t:i}=(0,f.$G7)(ek),r=(0,f.sr_)([...e,...n]),[c,u]=(0,f.UMU)({templateItems:e}),p=(0,a.useMemo)(()=>!u&&c?.every(e=>!e.granted),[u,c]),m=(0,a.useMemo)(()=>c?c.reduce((e,t)=>(e[t.id]=t,e),{}):{},[c]);if(p)return(0,s.jsx)(tk,{context:"create-document-type",reveal:!0,loading:u,children:(0,s.jsx)(o.zx,{"aria-label":i("pane-header.disabled-created-button.aria-label"),icon:d.dtP,"data-testid":"action-intent-button",disabled:!0,mode:"bleed",tooltipProps:null})});if(1===e.length){let o=e[0],l=!m[o.id]?.granted,a=tE(t,n,o);return a?(0,s.jsx)(tk,{reveal:l,loading:u,context:"create-document-type",children:(0,s.jsx)(t_,{"aria-label":r(o).title,icon:o.icon||d.dtP,intent:a,mode:"bleed",disabled:l,"data-testid":"action-intent-button",tooltipProps:l?null:{content:i("pane-header.create-new-button.tooltip")}})}):null}return(0,s.jsx)(o.j2,{button:(0,s.jsx)(o.zx,{icon:d.dtP,mode:"bleed","data-testid":"multi-action-intent-button",tooltipProps:{content:i("pane-header.create-new-button.tooltip")}}),id:"create-menu",menu:(0,s.jsx)(l.v2,{children:e.map((e,l)=>{let c=!m[e.id]?.granted,d=tE(t,n,e),p=n.find(t=>t.id===e.templateId);if(!p||!d)return null;let h=(0,a.forwardRef)((e,t)=>c?(0,s.jsx)("button",{type:"button",disabled:!0,...e,ref:t}):(0,s.jsx)(_.nR,{...e,intent:d.type,params:d.params,ref:t}));h.displayName="Link";let{title:f}=r({...e,title:e.title||r(p).title});return(0,s.jsx)(tk,{context:"create-document-type",reveal:c,loading:u,children:(0,s.jsx)(o.sN,{as:h,"data-as":c?"button":"a",text:f,"aria-label":c?i("pane-header.disabled-created-button.aria-label"):f,disabled:c,"data-testid":`action-intent-button-${l}`})},e.id)})}),popover:tI})}function tS(e){return null!=e}let tz=e=>{let t=e=>"object"==typeof e&&e?Array.isArray(e)?e.map(t):Object.entries(e).sort(([e],[t])=>e.localeCompare(t,"en")):e;return JSON.stringify(t(JSON.parse(JSON.stringify(e))))},t$=(0,a.memo)(function(e){let{initialValueTemplateItems:t=f.LZ8,menuItems:n=f.LZ8,menuItemGroups:i=f.LZ8,actionHandlers:r=f.NuZ}=e,o=(0,f.zEW)(),c=(0,a.useCallback)(e=>{if("string"==typeof e.action&&!(e.action in r))return console.warn("No handler for action:",e.action),!1;let t="function"==typeof e.action?e.action:"string"==typeof e.action?r[e.action]:null;return!!t&&(t(e.params),!0)},[r]),d=(0,a.useMemo)(()=>tC({actionHandler:c,menuItemGroups:i,menuItems:n.filter(e=>e.intent?.type!=="create")}),[c,i,n]),u=(0,a.useMemo)(()=>d.filter(tv),[d]),p=(0,a.useMemo)(()=>d.filter(tw),[d]),m=(0,a.useMemo)(()=>n.map((e,t)=>{if(e.intent?.type!=="create")return null;let{params:n}=e.intent;if(!n)return null;let i=Array.isArray(n)?n[0]:n,r=Array.isArray(n)?n[1]:void 0,s=i.template||i.type;if(!s)return null;let l=o.find(e=>e.id===s);return l?{item:e,template:l,templateParams:r,menuItemIndex:t,initialDocumentId:i.id}:null}).filter(tS).map(({initialDocumentId:e,item:t,template:n,menuItemIndex:i,templateParams:r})=>({id:`menuItem${i}`,initialDocumentId:e,templateId:n.id,type:"initialValueTemplateItem",title:t.title||n.title,i18n:t.i18n||n.i18n,icon:t.icon,description:n.description,parameters:r,schemaType:n.schemaType})),[n,o]),h=(0,a.useMemo)(()=>eb([...m,...t],e=>tz([e.initialDocumentId,e.templateId,e.parameters])),[m,t]);return(0,s.jsxs)(l.kC,{gap:1,children:[h.length>0&&(0,s.jsx)(tT,{templateItems:h}),u.map(e=>(0,s.jsx)(th,{node:e},e.key)),p.length>0&&(0,s.jsx)(tn,{nodes:p})]})});function tM(e){let{t}=(0,f.$G7)(ek),{layout:n,value:i}=e;return(0,s.jsx)(f.ogX,{title:(0,s.jsx)("em",{children:(0,s.jsx)(f.vNl,{t,i18nKey:"pane-item.missing-schema-type.title",components:{Code:"code"},values:{documentType:i._type}})}),subtitle:(0,s.jsx)(f.vNl,{t,i18nKey:"pane-item.missing-schema-type.subtitle",components:{Code:"code"},values:{documentId:i._id}}),media:()=>(0,s.jsx)(d.foC,{}),layout:n})}function tR(e,t,n){return!1!==e&&(e||t&&t.icon||n||!1)}function tD(e){let{icon:t,id:n,layout:i="default",pressed:r,schemaType:o,selected:c,title:u,value:p,margin:m,marginBottom:h,marginTop:g}=e,y=(0,f.I_y)(),b=(0,f.rq_)(),{ChildLink:j}=eU(),v=(0,f.Dqo)(n),w=!!(o&&o.name&&y.get(o.name)),[C,_]=(0,a.useState)(!1),k=(0,a.useMemo)(()=>p&&(0,x.Si)(p)?o&&w?(0,s.jsx)(eD,{documentPreviewStore:b,icon:tR(t,o,d.$lS),layout:i,schemaType:o,value:p,presence:v}):(0,s.jsx)(tM,{value:p}):(0,s.jsx)(f.ogX,{status:(0,s.jsx)(l.xu,{style:{opacity:.5},children:(0,s.jsx)(l.xv,{muted:!0,size:1,children:(0,s.jsx)(d.XCv,{})})}),icon:tR(t,o,d.ROc),layout:"compact",title:u}),[b,w,t,i,o,u,p,v]),I=(0,a.useMemo)(()=>function(e){return(0,s.jsx)(j,{...e,childId:n})},[j,n]),E=(0,a.useCallback)(e=>{if(e.metaKey){_(!1);return}_(!0)},[]);return(0,a.useEffect)(()=>_(!1),[c]),(0,s.jsx)(f.oUE,{"data-testid":`pane-item-${u}`,__unstable_focusRing:!0,as:I,"data-as":"a",margin:m,marginBottom:h,marginTop:g,onClick:E,pressed:r,radius:2,selected:c||C,sizing:"border",tabIndex:-1,tone:"inherit",children:k})}let tP=(0,a.memo)(e=>{let{actions:t,children:n,actionProps:i,onActionComplete:r,group:o}=e;return(0,s.jsx)(f.duV,{onReset:r,hooks:t,args:i,group:o,children:n})});tP.displayName="Memo(RenderActionCollectionState)";let tL=(0,a.memo)(e=>{let{badges:t,children:n,badgeProps:i}=e;return(0,s.jsx)(f.duV,{hooks:t,args:i,children:n})});function tA(e){let{children:t,currentMinWidth:n,flex:i,minWidth:r,paneKey:o,title:a="Error",tone:c="critical"}=e;return(0,s.jsxs)(e1,{currentMinWidth:n,flex:i,id:o,minWidth:r,tone:c,children:[(0,s.jsx)(tp,{title:a}),(0,s.jsx)(e3,{overflow:"auto",children:(0,s.jsx)(l.xu,{paddingX:4,paddingY:5,children:t})})]})}function tO(e){let t=[{ms:300,messageKey:"panes.resolving.default-message"},{ms:5e3,messageKey:"panes.resolving.slow-resolve-message"}];if(f.r8Q){let n=["Check console for errors?","Is your observable/promise resolving?",e.length>0?`Structure path: ${e.join(" ➝ ")}`:""];t.push({ms:1e4,message:n.join(`
`)})}let n=(0,S.of)(null);return(0,z.T)(...t.map(e=>n.pipe((0,J.h)("messageKey"in e?{messageKey:e.messageKey}:{message:e.message}),(0,ee.g)(e.ms))))}tL.displayName="Memo(RenderBadgeCollectionState)";let tN=(0,w.zo)(l.kC)`
  opacity: 0;
  transition: opacity 200ms;

  &[data-mounted] {
    opacity: 1;
  }
`,tU=(0,a.memo)(e=>{let{delay:t=300,flex:n,message:i=tO,minWidth:r,paneKey:o,path:c,selected:d,title:u,tone:p}=e,{t:m}=(0,f.$G7)(ek),h=(0,a.useMemo)(()=>"function"==typeof i?i(c?c.split(";"):[]):i,[i,c]),[x,g]=(0,a.useState)(()=>"string"==typeof h?h:m("panes.resolving.default-message"));(0,a.useEffect)(()=>{if("object"!=typeof h||"function"!=typeof h.subscribe)return;let e=h.subscribe(e=>{g("messageKey"in e?m(e.messageKey):e.message)});return()=>e.unsubscribe()},[h,m]);let[y,b]=(0,a.useState)(null),[j,v]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{if(y)return(0,l.RE)(()=>v(!0))},[y]),(0,s.jsx)(e1,{flex:n,id:o,minWidth:r,selected:d,tone:p,children:(0,s.jsx)(e3,{children:(0,s.jsx)(tN,{align:"center","data-mounted":j?"":void 0,direction:"column",height:"fill",justify:"center",ref:b,children:(0,s.jsx)(f.Bwn,{showText:!0,title:u||x})})})})});function tH(){let e=(0,a.useContext)(c.cO);if(!e)throw Error("DocumentPane: missing context value");return e}function tV(e){let{children:t,documentId:n,documentType:i}=e;return(0,s.jsx)(f.EM1,{documentId:n,documentType:i,children:(0,s.jsx)(tB,{documentId:n,documentType:i,children:t})})}function tB(e){let{children:t,documentId:n,documentType:i}=e,{enabled:r}=(0,f.g7N)(),{connectionState:o,onPathOpen:l,inspector:c,openInspector:d}=tH(),{params:u,setParams:p,createPathWithParams:m}=eU(),h=u?.comment,x=(0,a.useRef)(u);(0,a.useLayoutEffect)(()=>{x.current=u},[u]);let g=(0,a.useCallback)(e=>{let t=m({...x.current,comment:e,inspect:f.q$K});return`${window.location.origin}${t}`},[m]),y=(0,a.useCallback)(()=>{p({...x.current,comment:void 0})},[p]),b=(0,a.useCallback)(()=>{c?.name!==f.q$K&&d(f.q$K)},[c?.name,d]);return r?(0,s.jsx)(f.Cr6,{documentId:n,documentType:i,getCommentLink:g,isCommentsOpen:c?.name===f.q$K,isConnecting:"connecting"===o,onClearSelectedComment:y,onCommentsOpen:b,onPathOpen:l,selectedCommentId:h,sortOrder:"desc",type:"field",children:t}):(0,s.jsx)(s.Fragment,{children:t})}tU.displayName="Memo(LoadingPane)";let tF=!1,tq={},tG=Symbol("LOADING_PANE"),tW="documentPanelPortalElement";function tK(){let e=(0,a.useContext)(c.r1);if(!e)throw Error("StructureTool: missing context value");return e}let tX={},tY="inspect:",tQ=[{id:"inspectors"},{id:"links"}],tZ="sanity/structure/history";function tJ(e){let{documentId:t,documentType:n,inspectors:i,onMenuItems:r}=e,o=i.length,l=(0,a.useRef)(o),[c,d]=(0,a.useState)(()=>Array.from(Array(o))),u=(0,a.useRef)(c);(0,a.useEffect)(()=>{if(l.current!==o){let e=Array.from(Array(o));for(let t=0;t<o;t++)e[t]=u.current[t];l.current=o,d(()=>(u.current=e,e))}},[o]);let p=(0,a.useCallback)((e,t)=>{d(n=>{let i=[...n];return i[e]=t,u.current=i,i})},[]);(0,a.useEffect)(()=>{r(c.filter(Boolean))},[c,r]);let m=(0,a.useMemo)(()=>i.map((e,i)=>e.useMenuItem?[function({documentId:e,documentType:t,index:n,setMenuItem:i,useMenuItem:r}){return(0,a.memo)(function(){let o=r({documentId:e,documentType:t}),s=(0,f.BoV)(o);return(0,a.useEffect)(()=>{i(n,s)},[s]),null})}({documentId:t,documentType:n,index:i,setMenuItem:p,useMenuItem:e.useMenuItem}),e.name]:[()=>null,""]),[t,n,i,p]);return(0,s.jsx)(s.Fragment,{children:m.map(([e,t])=>t&&(0,s.jsx)(e,{},t))})}function t0(){let{connectionState:e,schemaType:t,title:n,value:i}=tH(),{error:r,value:o}=(0,f._2T)({enabled:!!i&&"connecting"!==e,schemaType:t,value:i});return"connecting"===e?{error:void 0,title:void 0}:n?{error:void 0,title:n}:i?r?{error:`Error: ${r.message}`,title:void 0}:{error:void 0,title:o?.title}:{error:void 0,title:`New ${t?.title||t?.name}`}}let t1=["patch","commit"],t2=(0,a.memo)(function(){let{push:e}=(0,l.pm)(),{documentId:t,documentType:n,value:i}=tH(),r=t0(),o=r.error,c=(0,f.E6V)(t,n),d=(0,a.useRef)(c),u=eU(),{t:p}=(0,f.$G7)(ek),m=(0,a.useMemo)(()=>r.title||o||t1.includes(c?.op)||"string"!=typeof i.title||c?.type!=="success"?r.title:i.title,[r.title,o,c,i.title])||p("panes.document-operation-results.operation-undefined-title"),h=m.length>25?`${m.slice(0,25)}...`:m;return(0,a.useEffect)(()=>{let t;if(c&&c!==d.current)return"error"===c.type&&e({closable:!0,duration:3e4,status:"error",title:p("panes.document-operation-results.operation-error",{context:c.op}),description:(0,s.jsxs)("details",{children:[(0,s.jsx)("summary",{children:p("panes.document-operation-results.error.summary.title")}),c.error.message]})}),"success"!==c.type||t1.includes(c.op)||e({closable:!0,status:"success",title:(0,s.jsx)(f.vNl,{context:c.op,i18nKey:"panes.document-operation-results.operation-success",t:p,values:{op:c.op,title:h},components:{Strong:"strong"}})}),"success"===c.type&&"delete"===c.op&&(t=setTimeout(()=>u.closeCurrentAndAfter(),0)),d.current=c,()=>clearTimeout(t)},[c,u,e,p,h]),null}),t8=(0,w.zo)(l.Zb)({position:"relative",zIndex:1,lineHeight:0});function t3(e){let{as:t,children:n,closeButtonLabel:i,onClose:r,title:a,...c}=e,{t:u}=(0,f.$G7)(ek);return(0,s.jsxs)(t8,{...c,as:t,children:[(0,s.jsxs)(l.kC,{padding:2,children:[(0,s.jsx)(l.xu,{flex:1,padding:3,children:(0,s.jsx)(l.xv,{as:"h1",size:1,weight:"medium",children:a})}),(0,s.jsx)(l.xu,{flex:"none",padding:1,children:(0,s.jsx)(o.zx,{"aria-label":i,icon:d.Two,mode:"bleed",onClick:r,tooltipProps:{content:u("document-inspector.close-button.tooltip")}})})]}),n]})}let t5=w.zo.div`
  position: absolute;
  top: 0;
  left: -4px;
  bottom: 0;
  width: 9px;
  z-index: 201;
  cursor: ew-resize;

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  /* Hover effect */
  & > span:nth-child(2) {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 9px;
    bottom: 0;
    background-color: var(--card-border-color);
    opacity: 0;
    transition: opacity 150ms;
  }

  @media (hover: hover) {
    &:hover > span:nth-child(2) {
      opacity: 0.2;
    }
  }
`;function t4(e){let{onResize:t,onResizeStart:n}=e,i=(0,a.useRef)(0),r=(0,a.useCallback)(e=>{e.preventDefault(),i.current=e.pageX,n();let r=e=>{e.preventDefault(),t(e.pageX-i.current)},o=()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",o)},[t,n]);return(0,s.jsxs)(t5,{onMouseDown:r,children:[(0,s.jsx)("span",{}),(0,s.jsx)("span",{})]})}let t7=(0,w.zo)(l.xu)`
  position: relative;
  flex: 1;
  padding-left: 1px;
`;function t9(e){let{as:t,children:n,minWidth:i,maxWidth:r,...o}=e,[l,c]=(0,a.useState)(null),d=(0,a.useRef)(),[u,p]=(0,a.useState)(),m=(0,a.useCallback)(()=>{d.current=l?.offsetWidth},[l]),h=(0,a.useCallback)(e=>{let t=d.current;t&&p(Math.min(Math.max(t-e,i),r))},[i,r]),f=(0,a.useMemo)(()=>u?{flex:"none",width:u}:{minWidth:i,maxWidth:r},[i,r,u]);return(0,s.jsxs)(t7,{as:t,...o,ref:c,style:f,children:[n,(0,s.jsx)(t4,{onResize:h,onResizeStart:m})]})}function t6(e){let{documentId:t,documentType:n,flex:i}=e,{collapsed:r}=e8(),{closeInspector:o,inspector:c}=tH(),{features:d}=tK(),u=(0,a.useCallback)(()=>{c&&o(c.name)},[o,c]);if(r||!c)return null;let p=(0,a.createElement)(c.component,{onClose:u,documentId:t,documentType:n});return d.resizablePanes?(0,s.jsx)(t9,{as:"aside","data-ui":"DocumentInspectorPanel",flex:i,maxWidth:540,minWidth:320,children:p}):(0,s.jsx)(l.xu,{as:"aside","data-ui":"DocumentInspectorPanel",flex:i,children:p})}function ne(e,t,n){let i=(0,f.tJW)(),[r,o]=(0,a.useState)(n),s=["studio.structure-tool",e,t].filter(Boolean).join("."),l=(0,a.useMemo)(()=>i.getKey(s),[i,s]);(0,a.useEffect)(()=>{let e=l.pipe((0,X.O)(n),(0,F.U)(e=>null===e?n:e)).subscribe({next:o});return()=>e?.unsubscribe()},[n,s,l]);let c=(0,a.useCallback)(e=>{e!==r&&(o(e),i.setKey(s,e))},[i,s,r]);return(0,a.useMemo)(()=>[r,c],[c,r])}let nt={id:"parsed",title:"document-inspector.view-mode.parsed"},nn={id:"raw",title:"document-inspector.view-mode.raw-json"},ni=[nt,nn],nr=new es({maxSize:1e3});function no(e){let{path:t}=e,n=nr.get(t);void 0!==n&&nr.set(t,!n)}function ns(e){let t=window.getSelection();if(t){let n=document.createRange();t.removeAllRanges(),n.selectNodeContents(e),t.addRange(n)}}function nl(e){ns(e.currentTarget)}function na(e){65===e.keyCode&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),ns(e.currentTarget))}let nc=w.zo.div(({theme:e})=>{let{color:t,fonts:n,space:i}=e.sanity;return(0,w.iv)`
    & .json-inspector,
    & .json-inspector .json-inspector__selection {
      font-family: ${n.code.family};
      font-size: ${n.code.sizes[1].fontSize}px;
      line-height: ${n.code.sizes[1].lineHeight}px;
      color: var(--card-code-fg-color);
    }

    & .json-inspector .json-inspector__leaf {
      padding-left: ${(0,l.hO)(i[4])};
    }

    & .json-inspector .json-inspector__leaf.json-inspector__leaf_root {
      padding-top: ${(0,l.hO)(i[3])};
      padding-left: 0;
    }

    & .json-inspector > .json-inspector__leaf_root > .json-inspector__line > .json-inspector__key {
      display: none;
    }

    & .json-inspector .json-inspector__line {
      display: block;
      position: relative;
      cursor: default;
    }

    & .json-inspector .json-inspector__line::after {
      content: '';
      position: absolute;
      top: 0;
      left: -200px;
      right: -50px;
      bottom: 0;
      z-index: -1;
      pointer-events: none;
    }

    & .json-inspector .json-inspector__line:hover::after {
      background: var(--card-code-bg-color);
    }

    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line {
      cursor: pointer;
    }

    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line::before {
      content: '▸ ';
      margin-left: calc(0 - ${(0,l.hO)(i[4])} + 3px);
      font-size: ${n.code.sizes[1].fontSize}px;
      line-height: ${n.code.sizes[1].lineHeight}px;
    }

    &
      .json-inspector
      .json-inspector__leaf_expanded.json-inspector__leaf_composite
      > .json-inspector__line::before {
      content: '▾ ';
      font-size: ${n.code.sizes[1].fontSize}px;
      line-height: ${n.code.sizes[1].lineHeight}px;
    }

    & .json-inspector .json-inspector__radio,
    & .json-inspector .json-inspector__flatpath {
      display: none;
    }

    & .json-inspector .json-inspector__value {
      margin-left: ${(0,l.hO)(i[4]/2)};
    }

    &
      .json-inspector
      > .json-inspector__leaf_root
      > .json-inspector__line
      > .json-inspector__key
      + .json-inspector__value {
      margin: 0;
    }

    & .json-inspector .json-inspector__key {
      color: ${t.syntax.property};
    }

    & .json-inspector .json-inspector__value_helper,
    & .json-inspector .json-inspector__value_null {
      color: ${t.syntax.constant};
    }

    & .json-inspector .json-inspector__not-found {
      padding-top: ${(0,l.hO)(i[3])};
    }

    & .json-inspector .json-inspector__value_string {
      color: ${t.syntax.string};
    }

    & .json-inspector .json-inspector__value_boolean {
      color: ${t.syntax.boolean};
    }

    & .json-inspector .json-inspector__value_number {
      color: ${t.syntax.number};
    }

    & .json-inspector .json-inspector__show-original {
      display: inline-block;
      padding: 0 6px;
      cursor: pointer;
    }

    & .json-inspector .json-inspector__show-original:hover {
      color: inherit;
    }

    & .json-inspector .json-inspector__show-original::before {
      content: '↔';
    }

    & .json-inspector .json-inspector__show-original:hover::after {
      content: ' expand';
    }
  `});function nd(e){let{onChange:t,query:n}=e,i=(0,a.useCallback)(e=>t(e.target.value),[t]),{t:r}=(0,f.$G7)(ek);return(0,s.jsx)(l.oi,{icon:d.W1M,onChange:i,placeholder:r("document-inspector.search.placeholder"),radius:2,value:n||""})}function nu(e){let{value:t}=e,{onInspectClose:n,paneKey:i}=tH(),r=`${i}_inspect_`,[c,d]=ne("inspect-view-mode",null,"parsed"),u=ni.find(e=>e.id===c),p=(0,a.useCallback)(()=>{d(nt.id)},[d]),m=(0,a.useCallback)(()=>{d(nn.id)},[d]),{t:h}=(0,f.$G7)(ek);return(0,s.jsx)(o.Vq,{bodyHeight:"fill",id:`${r}dialog`,header:(0,f.Uy$)(t)&&(0,f.HD0)(t._id)&&(0,f.HD0)(t._type)?(0,s.jsx)(f.vNl,{t:h,i18nKey:"document-inspector.dialog.title",components:{DocumentTitle:()=>(0,s.jsx)("em",{children:(0,s.jsx)(eE,{document:t})})}}):(0,s.jsx)("em",{children:h("document-inspector.dialog.title-no-value")}),onClose:n,onClickOutside:n,padding:!1,width:2,children:(0,s.jsxs)(l.kC,{direction:"column",height:"fill",children:[(0,s.jsx)(l.Zb,{padding:3,paddingTop:0,shadow:1,style:{position:"sticky",bottom:0,zIndex:3},children:(0,s.jsxs)(l.td,{space:1,children:[(0,s.jsx)(o.OK,{"aria-controls":`${r}tabpanel`,id:`${r}tab-${nt.id}`,label:h(nt.title),onClick:p,selected:u===nt}),(0,s.jsx)(o.OK,{"aria-controls":`${r}tabpanel`,id:`${r}tab-${nn.id}`,label:h(nn.title),onClick:m,selected:u===nn})]})}),(0,s.jsxs)(l.x4,{"aria-labelledby":`${r}tab-${c}`,flex:1,id:`${r}tabpanel`,overflow:"auto",padding:4,style:{outline:"none"},children:[u===nt&&(0,s.jsx)(nc,{children:(0,s.jsx)(eo,{data:t,isExpanded:function e(t,n){let i=nr.get(t);return void 0===i?(nr.set(t,Array.isArray(n)||(0,f.Uy$)(n)),e(t,n)):i},onClick:no,search:nd,filterOptions:{ignoreCase:!0}})}),u===nn&&(0,s.jsx)(l.EK,{language:"json",tabIndex:0,onKeyDown:na,onDoubleClick:nl,onFocus:nl,size:1,children:JSON.stringify(t,null,2)})]})]})})}function np({size:e}){return(0,s.jsx)(o.zx,{"aria-hidden":!0,disabled:!0,size:e,style:{pointerEvents:"none",visibility:"hidden",width:0},text:"-"})}function nm(e){let{action:t,content:n,icon:i,tone:r="transparent",...a}=e;return(0,s.jsx)(l.Zb,{borderBottom:!0,paddingX:4,paddingY:2,tone:r,...a,children:(0,s.jsxs)(l.kC,{align:"center",gap:3,children:[i&&(0,s.jsx)(l.xv,{size:0,children:(0,s.jsx)(i,{})}),(0,s.jsx)(l.kC,{align:"center",flex:1,gap:2,paddingY:3,children:n}),(0,s.jsx)(np,{}),t&&(0,s.jsx)(o.zx,{as:t?.as,mode:"ghost",onClick:t?.onClick,text:t.text,tone:t.tone||"default"})]})})}function nh({revisionId:e}){let{documentId:t,documentType:n}=tH(),{restore:i}=(0,f.d9t)(t,n),{navigateIntent:r}=(0,_.tv)(),o=(0,a.useCallback)(()=>{e&&(i.execute(e),r("edit",{id:t,type:n}))},[t,n,r,i,e]),{t:c}=(0,f.$G7)(ek);return(0,s.jsx)(nm,{action:e?{onClick:o,text:c("banners.deleted-document-banner.restore-button.text")}:void 0,content:(0,s.jsx)(l.xv,{size:1,weight:"medium",children:c("banners.deleted-document-banner.text")}),"data-testid":"deleted-document-banner",icon:d.CPA})}function nf(){let{schemaType:e}=tH(),{t}=(0,f.$G7)(ek);return(0,x.Ax)(e)?(0,s.jsx)(nm,{content:(0,s.jsxs)(l.xv,{size:1,weight:"medium",children:[(0,s.jsx)(f.vNl,{t,i18nKey:"banners.deprecated-document-type-banner.text"})," ",e.deprecated.reason]}),"data-testid":"deprecated-document-type-banner",icon:d.uIy}):null}function nx({granted:e,requiredPermission:t}){let n=(0,f.xJ)(),i=(0,f.WEl)({style:"short"}),{t:r}=(0,f.$G7)(ek);if(e)return null;let o=(n?.roles||[]).map(e=>e.title),a=i.formatToParts(o).map(e=>"element"===e.type?(0,s.jsx)("code",{children:e.value},e.value):e.value);return(0,s.jsx)(nm,{content:(0,s.jsx)(l.xv,{size:1,weight:"medium",children:(0,s.jsx)(f.vNl,{t:r,i18nKey:"banners.permission-check-banner.missing-permission",components:{Roles:()=>(0,s.jsx)(s.Fragment,{children:a})},values:{count:a.length,roles:o},context:t})}),"data-testid":"permission-check-banner",icon:d.CPA})}let ng=(0,a.memo)(()=>{let e=(0,f.rq_)(),{params:t,groupIndex:n,routerPanesState:i,replaceCurrent:r,BackLink:o}=eU(),c=i[n]?.[0].id,u=i[n-1]?.[0],p=u?.id,m=!!u?.params?.rev,h=(0,a.useMemo)(()=>t?.parentRefPath&&(0,k.mL)(t.parentRefPath)||null,[t?.parentRefPath]),{t:x}=(0,f.$G7)(ek),g=(0,a.useMemo)(()=>{let t=h?.[0];if(!p||!t||!h)return(0,S.of)({loading:!1});let n=(0,f.vsM)(p),i=(0,k.mL)(t),r=i.findIndex(e=>"object"==typeof e&&"_key"in e);return(0,$.z)((0,S.of)({loading:!0}),e.unstable_observePathsDocumentPair(n,-1===r?i:i.slice(0,r)).pipe((0,et.b)(750),(0,F.U)(({draft:e,published:t})=>({loading:!1,result:{availability:{draft:e.availability,published:t.availability},refValue:k.U2(e.snapshot||t.snapshot,h)?._ref}}))))},[e,p,h]),y=(0,el.m)(g,{loading:!0}),b=(0,a.useCallback)(()=>{y.loading||y.result?.refValue&&r({id:y.result.refValue,params:t})},[y.loading,y.result,r,t]);return p&&h&&!m&&!y.loading&&(y.result?.availability.draft.available||y.result?.availability.published.available)&&y.result?.refValue!==c?(0,s.jsx)(nm,{action:y.result?.refValue?{onClick:b,icon:d.bnu,text:x("banners.reference-changed-banner.reason-changed.reload-button.text")}:{as:o,icon:d.Two,text:x("banners.reference-changed-banner.reason-removed.close-button.text")},"data-testid":"reference-changed-banner",content:(0,s.jsx)(l.xv,{size:1,weight:"medium",children:x(y.result?.refValue?"banners.reference-changed-banner.reason-changed.text":"banners.reference-changed-banner.reason-removed.text")}),icon:d.foC,tone:"caution"}):null});ng.displayName="Memo(ReferenceChangedBanner)";let ny=(0,w.zo)(l.Kq)`
  ${({theme:e})=>(0,w.iv)`
      @supports not (container-type: inline-size) {
        display: none !important;
      }

      container-type: inline-size;

      [data-heading] {
        font-size: ${e.sanity.fonts.heading.sizes[4].fontSize}px;
        line-height: ${e.sanity.fonts.heading.sizes[4].lineHeight}px;
        overflow-wrap: break-word;
        text-wrap: pretty;
      }

      @container (max-width: 560px) {
        [data-heading] {
          font-size: ${e.sanity.fonts.heading.sizes[3].fontSize}px;
          line-height: ${e.sanity.fonts.heading.sizes[3].lineHeight}px;
        }
      }

      @container (max-width: 420px) {
        [data-heading] {
          font-size: ${e.sanity.fonts.heading.sizes[2].fontSize}px;
          line-height: ${e.sanity.fonts.heading.sizes[2].lineHeight}px;
        }
      }
    `}
`,nb=({documentId:e,schemaType:t,title:n})=>{let i=e===t.name,{t:r}=(0,er.$G)(ek);return!1===t.__experimental_formPreviewTitle?null:(0,s.jsxs)(ny,{marginBottom:6,space:4,children:[!i&&(0,s.jsx)(l.xv,{muted:!0,size:1,children:t.title??t.name}),(0,s.jsx)(l.X6,{as:"h2","data-heading":!0,muted:!n,"data-testid":"document-panel-document-title",children:n??r("document-view.form-view.form-title-fallback")})]})},nj=e=>e.preventDefault(),nv=(0,a.forwardRef)(function(e,t){let{hidden:n,margins:i}=e,{collapsedFieldSets:r,collapsedPaths:o,displayed:c,editState:d,documentId:u,documentType:p,fieldActions:m,onChange:h,validation:x,ready:g,formState:y,onFocus:b,connectionState:j,onBlur:v,onSetCollapsedPath:w,onPathOpen:C,onSetCollapsedFieldSet:_,onSetActiveFieldGroup:k,openPath:I}=tH(),E=(0,f.H__)(),T=(0,f.Dqo)(u),{title:S}=t0(),z=(0,a.useMemo)(()=>(0,f.fm0)(),[]),$=d?.transactionSyncLock?.enabled,{t:M}=(0,f.$G7)(ek);(function(e){let t=(0,l.pm)();(0,a.useEffect)(()=>(e.enabled&&t.push({...e,duration:20736e5}),()=>{e.enabled&&t.push({...e,duration:.01})}),[e,t])})((0,a.useMemo)(()=>({id:"sync-lock",status:"warning",enabled:$,title:M("document-view.form-view.sync-lock-toast.title"),description:M("document-view.form-view.sync-lock-toast.description"),closable:!0}),[$,M])),(0,a.useEffect)(()=>{let e=E.pair.documentEvents(u,p).pipe((0,G.b)(e=>{"mutation"===e.type&&z.publish(function(e){let t=e.mutations.map(e=>e.patch).filter(Boolean);return{type:"mutation",snapshot:e.document,patches:(0,f.Sis)(e.origin,t)}}(e)),"rebase"===e.type&&z.publish(function(e){let t=e.remoteMutations.map(e=>e.patch).filter(Boolean),n=e.localMutations.map(e=>e.patch).filter(Boolean);return{type:"rebase",snapshot:e.document,patches:(0,f.Sis)("remote",t).concat((0,f.Sis)("local",n))}}(e))})).subscribe();return()=>{e.unsubscribe()}},[u,E,p,z]);let R=!!c?._rev;(0,a.useEffect)(()=>{R&&z.publish({type:"mutation",patches:[],snapshot:c})},[R]);let[D,P]=(0,a.useState)(null),[L,A]=(0,a.useState)(!1);(0,a.useEffect)(()=>{!L&&g&&!y?.focusPath.length&&D&&(A(!0),(0,l.fo)(D))},[L,D,y?.focusPath.length,g]);let O=(0,a.useCallback)(e=>{P(e),"function"==typeof t?t(e):t&&(t.current=e)},[t]);return(0,s.jsx)(l.W2,{hidden:n,paddingX:4,paddingTop:5,paddingBottom:9,sizing:"border",width:1,children:(0,s.jsx)(f.$rW,{margins:i,children:(0,s.jsx)(l.xu,{as:"form",onSubmit:nj,ref:O,children:"connecting"===j?(0,s.jsx)(eQ,{ms:300,children:(0,s.jsxs)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:[(0,s.jsx)(l.$j,{muted:!0}),(0,s.jsx)(l.xu,{marginTop:3,children:(0,s.jsx)(l.xv,{align:"center",muted:!0,size:1,children:M("document-view.form-view.loading")})})]})}):null===y||n?(0,s.jsx)(l.xu,{padding:2,children:(0,s.jsx)(l.xv,{children:M("document-view.form-view.form-hidden")})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nb,{documentId:u,schemaType:y.schemaType,title:S}),(0,s.jsx)(f.quP,{__internal_fieldActions:m,__internal_patchChannel:z,changed:y.changed,collapsedFieldSets:r,collapsedPaths:o,focused:y.focused,focusPath:y.focusPath,groups:y.groups,id:"root",members:y.members,onChange:h,onFieldGroupSelect:k,onPathBlur:v,onPathFocus:b,onPathOpen:C,onSetFieldSetCollapsed:_,onSetPathCollapsed:w,openPath:I,presence:T,readOnly:"reconnecting"===j||y.readOnly,schemaType:y.schemaType,validation:x,value:y.value})]})})})})}),nw=(0,w.zo)(l.xu)({position:"relative"}),nC=(0,w.zo)(f.l$t)(({$disabled:e})=>e?{height:"100%"}:(0,w.iv)`
    height: 100%;
    overflow: auto;
    position: relative;
    scroll-behavior: smooth;
    outline: none;
  `),n_=function(e){let{footerHeight:t,headerHeight:n,isInspectOpen:i,rootElement:r,setDocumentPanelPortalElement:o}=e,{activeViewId:c,displayed:d,documentId:u,documentType:p,editState:m,inspector:h,value:x,views:g,ready:y,schemaType:b,permissions:j,isPermissionsLoading:v,isDeleting:w,isDeleted:C,timelineStore:_,onChange:k}=tH(),{collapsed:I}=eL(),{collapsed:E}=e8(),T=(0,l.vI)(),{features:S}=tK(),z=(0,a.useRef)(null),[$,M]=(0,a.useState)(null),R=(0,a.useRef)(null),D=x._createdAt?"update":"create",P=(0,a.useMemo)(()=>g.find(e=>e.id===c)||g[0]||{type:"form"},[c,g]),L=S.splitPanes&&z.current||T.element,A=(0,a.useMemo)(()=>I?[n||0,0,t?t+2:2,0]:[0,0,2,0],[I,t,n]),O="form"!==P.type,N=(0,a.useMemo)(()=>"component"===P.type&&P.component&&(0,a.createElement)(P.component,{document:{draft:m?.draft||null,displayed:d||x,historical:d,published:m?.published||null},documentId:u,options:P.options,schemaType:b}),[P,d,u,m?.draft,m?.published,b,x]),U=(0,f.P08)(_,e=>e.lastNonDeletedRevId);(0,a.useEffect)(()=>{$?.scrollTo&&$.scrollTo(0,0)},[u,$]),(0,a.useEffect)(()=>{L&&o(L)},[L,o]);let H=(0,a.useMemo)(()=>i?(0,s.jsx)(nu,{value:d||x}):null,[i,d,x]),V=!!(!E&&h);return(0,s.jsx)(e3,{children:(0,s.jsxs)(l.kC,{height:"fill",children:[(S.resizablePanes||!V)&&(0,s.jsx)(nw,{flex:2,overflow:"hidden",children:(0,s.jsx)(l.Xp,{element:L,__unstable_elements:{documentScrollElement:$},children:(0,s.jsx)(l.NM,{element:$,children:(0,s.jsxs)(f.Ahg,{scrollElement:$,containerElement:R,children:["form"===P.type&&!v&&y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(nx,{granted:!!j?.granted,requiredPermission:D}),!w&&C&&(0,s.jsx)(nh,{revisionId:U}),(0,s.jsx)(ng,{}),(0,s.jsx)(nf,{})]}),(0,s.jsxs)(nC,{$disabled:I||!1,"data-testid":"document-panel-scroller",ref:M,children:[(0,s.jsx)(nv,{hidden:O,margins:A,ref:R},u+(y?"_ready":"_pending")),N]}),H,(0,s.jsx)("div",{"data-testid":"document-panel-portal",ref:z})]})})})}),V&&(0,s.jsx)(l.NM,{element:r,children:(0,s.jsx)(t6,{documentId:u,documentType:b.name,flex:1})})]})})},nk=["left","bottom"],nI={small:0,medium:1,large:2,full:"auto"};function nE(e){let{dialog:t,referenceElement:n}=e;return(0,s.jsx)(l.J2,{content:(0,s.jsx)(nT,{dialog:t}),fallbackPlacements:nk,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:n})}function nT(e){let{dialog:t}=e,{cancelButtonIcon:n,cancelButtonText:i,confirmButtonIcon:r,confirmButtonText:o,message:c,onCancel:d,onConfirm:u,tone:p}=t,{t:m}=(0,f.$G7)(ek),{isTopLayer:h}=(0,l.sJ)(),x=(0,a.useRef)(null),g=(0,a.useCallback)(e=>{"Escape"===e.key&&h&&d()},[h,d]);return(0,l.qh)(g),(0,l.Of)(h&&d,()=>[x.current]),(0,s.jsxs)(l.kC,{direction:"column",ref:x,style:{minWidth:304,maxWidth:400},children:[(0,s.jsx)(l.xu,{flex:1,overflow:"auto",padding:4,children:(0,s.jsx)(l.xv,{children:c})}),(0,s.jsx)(l.xu,{paddingX:4,paddingY:3,style:{borderTop:"1px solid var(--card-border-color)"},children:(0,s.jsxs)(l.rj,{columns:2,gap:2,children:[(0,s.jsx)(l.zx,{"data-testid":"confirm-dialog-cancel-button",icon:n,onClick:d,mode:"ghost",text:i||m("confirm-dialog.cancel-button.fallback-text")}),(0,s.jsx)(l.zx,{"data-testid":"confirm-dialog-confirm-button",icon:r,onClick:u,text:o||m("confirm-dialog.confirm-button.fallback-text"),tone:p})]})})]})}function nS(e){let{dialog:t}=e,n=(0,a.useId)(),i=t.footer&&(0,s.jsx)(l.xu,{paddingX:4,paddingY:3,children:t.footer});return(0,s.jsx)(f.jr5,{zOffset:"fullscreen",children:(0,s.jsx)(l.Vq,{animate:!0,__unstable_hideCloseButton:!1===t.showCloseButton,footer:i,header:t.header,id:n,onClose:t.onClose,onClickOutside:t.onClose,width:void 0===t.width?1:nI[t.width],children:(0,s.jsx)(l.xu,{padding:4,children:t.content})})})}function nz(e){let{dialog:t,referenceElement:n}=e;return(0,s.jsx)(l.J2,{content:(0,s.jsx)(n$,{dialog:t}),fallbackPlacements:nk,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:n})}function n$(e){let{dialog:t}=e,{content:n,onClose:i}=t,{isTopLayer:r}=(0,l.sJ)(),o=(0,a.useRef)(null),c=(0,a.useCallback)(e=>{"Escape"===e.key&&r&&i()},[r,i]);return(0,l.qh)(c),(0,l.Of)(r&&i,()=>[o.current]),(0,s.jsx)("div",{ref:o,children:n})}function nM(e){let{children:t}=e,{element:n,elements:i}=(0,l.vI)(),r=i?.[tW]||n;return(0,s.jsx)(l.Xp,{element:r,children:t})}function nR(e){let{dialog:t,referenceElement:n=null}=e,i=(0,a.useId)();return"confirm"===t.type?(0,s.jsx)(nE,{dialog:t,referenceElement:n}):"popover"===t.type?(0,s.jsx)(nz,{dialog:t,referenceElement:n}):"dialog"!==t.type&&t.type?"custom"===t.type?(0,s.jsx)(nM,{children:t?.component}):(console.warn(`Unsupported modal type ${t.type}`),(0,s.jsx)(o.Vq,{id:i,onClose:t.onClose,onClickOutside:t.onClose,width:1,children:t.content||(0,s.jsxs)(l.xv,{size:1,children:["Unexpected modal type (",(0,s.jsx)("code",{children:t.type}),")"]})})):(0,s.jsx)(nM,{children:(0,s.jsx)(nS,{dialog:t})})}let nD=(0,a.memo)(function({actionStates:e,children:t,referenceElement:n}){let[i,r]=(0,a.useState)(-1),o=(0,a.useMemo)(()=>e[i],[i,e]),l=(0,a.useCallback)(e=>{r(e)},[]),c=(0,a.useMemo)(()=>t({handleAction:l}),[t,l]);return(0,s.jsxs)(s.Fragment,{children:[o&&o.dialog&&(0,s.jsx)(f.jr5,{zOffset:"paneFooter",children:(0,s.jsx)(nR,{dialog:o.dialog,referenceElement:n})}),c]})});function nP(e){let{actionStates:t,disabled:n}=e,i=(0,a.useId)(),[r,c]=(0,a.useState)(null),d=(0,a.useMemo)(()=>({placement:"top-end",portal:!0,preventOverflow:!0}),[]),{t:u}=(0,f.$G7)(ek),p=(0,a.useCallback)(({handleAction:e})=>(0,s.jsx)(o.j2,{id:`${i}-action-menu`,button:(0,s.jsx)(f.lXN,{"aria-label":u("buttons.action-menu-button.aria-label"),disabled:n,"data-testid":"action-menu-button",size:"large",tooltipProps:{content:u("buttons.action-menu-button.tooltip")}}),menu:(0,s.jsx)(l.v2,{padding:1,children:t.map((t,i)=>(0,s.jsx)(nL,{actionState:t,disabled:n,index:i,onAction:e},i))}),popover:d,ref:c}),[t,n,i,d,u]);return(0,s.jsx)(nD,{actionStates:t,referenceElement:r,children:p})}function nL(e){let{actionState:t,disabled:n,index:i,onAction:r}=e,{onHandle:l}=t,c=(0,a.useCallback)(()=>{r(i),l&&l()},[i,r,l]),d=(0,a.useMemo)(()=>t.shortcut?String(t.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1)):void 0,[t.shortcut]);return(0,s.jsx)(o.sN,{"data-testid":`action-${t.label.replace(" ","")}`,disabled:n||!!t.disabled,hotkeys:d,icon:t.icon,onClick:c,text:t.label,tone:t.tone,...t.disabled&&{tooltipProps:{content:t.title}}})}let nA={NOTHING_TO_DELETE:"action.delete.disabled.nothing-to-delete",NOT_READY:"action.delete.disabled.not-ready"},nO=({id:e,type:t,draft:n,onComplete:i})=>{let{setIsDeleting:r}=tH(),{delete:o}=(0,f.d9t)(e,t),[l,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1),{t:m}=(0,f.$G7)(ek),h=(0,a.useCallback)(()=>{p(!1),i()},[i]),x=(0,a.useCallback)(()=>{c(!0),p(!1),r(!0),o.execute(),i()},[o,i,r]),g=(0,a.useCallback)(()=>{p(!0)},[]),[y,b]=(0,f.hHf)({id:e,type:t,permission:"delete"}),j=(0,f.xJ)();return(0,a.useMemo)(()=>b||y?.granted?{tone:"critical",icon:d.XHJ,disabled:l||!!o.disabled||b,title:o.disabled&&m(nA[o.disabled])||"",label:m(l?"action.delete.running.label":"action.delete.label"),shortcut:"Ctrl+Alt+D",onHandle:g,dialog:u&&{type:"custom",component:(0,s.jsx)(eY,{action:"delete",id:n?._id||e,type:t,onCancel:h,onConfirm:x})}}:{tone:"critical",icon:d.XHJ,disabled:!0,label:m("action.delete.label"),title:(0,s.jsx)(f.FMn,{context:"delete-document",currentUser:j})},[j,o.disabled,n?._id,g,h,x,e,u,l,b,y?.granted,m,t])};nO.action="delete",nO.displayName="DeleteAction";let nN={NO_CHANGES:"action.discard-changes.disabled.no-change",NOT_PUBLISHED:"action.discard-changes.disabled.not-published",NOT_READY:"action.discard-changes.disabled.not-ready"},nU=({id:e,type:t,published:n,liveEdit:i,onComplete:r})=>{let{discardChanges:o}=(0,f.d9t)(e,t),[l,c]=(0,a.useState)(!1),[u,p]=(0,f.hHf)({id:e,type:t,permission:"discardDraft"}),m=(0,f.xJ)(),{t:h}=(0,f.$G7)(ek),x=(0,a.useCallback)(()=>{o.execute(),r()},[o,r]),g=(0,a.useCallback)(()=>{c(!0)},[]),y=(0,a.useMemo)(()=>l&&{type:"confirm",tone:"critical",onCancel:r,onConfirm:x,message:h("action.discard-changes.confirm-dialog.confirm-discard-changes")},[x,l,r,h]);return(0,a.useMemo)(()=>!n||i?null:p||u?.granted?{tone:"critical",icon:d.X5P,disabled:!!o.disabled||p,title:o.disabled&&nN[o.disabled]||"",label:h("action.discard-changes.label"),onHandle:g,dialog:y}:{tone:"critical",icon:d.X5P,disabled:!0,label:h("action.discard-changes.label"),title:(0,s.jsx)(f.FMn,{context:"discard-changes",currentUser:m})},[m,y,o.disabled,g,p,i,u?.granted,n,h])};nU.action="discardChanges",nU.displayName="DiscardChangesAction";let nH={NOTHING_TO_DUPLICATE:"action.duplicate.disabled.nothing-to-duplicate",NOT_READY:"action.duplicate.disabled.not-ready"},nV=({id:e,type:t,onComplete:n})=>{let i=(0,f.H__)(),{duplicate:r}=(0,f.d9t)(e,t),{navigateIntent:o}=(0,_.tv)(),[l,c]=(0,a.useState)(!1),[u,p]=(0,f.hHf)({id:e,type:t,permission:"duplicate"}),{t:m}=(0,f.$G7)(ek),h=(0,f.xJ)(),x=(0,a.useCallback)(async()=>{let s=(0,v.Z)();c(!0);let l=(0,M.z)(i.pair.operationEvents(e,t).pipe((0,R.h)(e=>"duplicate"===e.op&&"success"===e.type)));r.execute(s),await l,o("edit",{id:s,type:t}),n()},[i.pair,r,e,o,n,t]);return(0,a.useMemo)(()=>p||u?.granted?{icon:d.TIy,disabled:l||!!r.disabled||p,label:m(l?"action.duplicate.running.label":"action.duplicate.label"),title:r.disabled?m(nH[r.disabled]):"",onHandle:x}:{icon:d.TIy,disabled:!0,label:m("action.duplicate.label"),title:(0,s.jsx)(f.FMn,{context:"duplicate-document",currentUser:h})},[h,r.disabled,x,l,p,u?.granted,m])};nV.action="duplicate",nV.displayName="DuplicateAction";let nB=({id:e,type:t,revision:n,onComplete:i})=>{let{restore:r}=(0,f.d9t)(e,t),o=(0,f.E6V)(e,t),{navigateIntent:s}=(0,_.tv)(),l=(0,a.useRef)(o),[c,u]=(0,a.useState)(!1),{t:p}=(0,f.$G7)(ek),m=(0,a.useCallback)(()=>{r.execute(n),i()},[r,n,i]);(0,a.useEffect)(()=>{o&&o!==l.current&&("success"===o.type&&"restore"===o.op&&s("edit",{id:e,type:t}),l.current=o)},[o,e,s,t]);let h=(0,a.useCallback)(()=>{u(!0)},[]),x=(0,a.useMemo)(()=>c?{type:"confirm",tone:"critical",onCancel:i,onConfirm:m,message:p("action.restore.confirm.message")}:null,[m,c,i,p]),g="@initial"===n,y=void 0===n;return(0,a.useMemo)(()=>y?null:{label:p("action.restore.label"),color:"primary",onHandle:h,title:p(g?"action.restore.disabled.cannot-restore-initial":"action.restore.tooltip"),icon:d.vaD,dialog:x,disabled:g},[x,h,g,y,p])};nB.action="restore",nB.displayName="HistoryRestoreAction";let nF=(0,ec.dS)({name:"Document Published",version:1,description:'User clicked the "Publish" button in the document pane'}),nq={LIVE_EDIT_ENABLED:"action.publish.live-edit.publish-disabled",ALREADY_PUBLISHED:"action.publish.already-published.no-time-ago.tooltip",NO_CHANGES:"action.publish.no-changes.tooltip",NOT_READY:"action.publish.disabled.not-ready"};function nG({publishedAt:e}){let{t}=(0,f.$G7)(ek),n=(0,f.ofl)(e,{useTemporalPhrase:!0});return(0,s.jsx)("span",{children:t("action.publish.already-published.tooltip",{timeSincePublished:n})})}let nW=e=>{var t,n;let{id:i,type:r,liveEdit:o,draft:l,published:c}=e,[u,p]=(0,a.useState)(null),{publish:m}=(0,f.d9t)(i,r),h=(0,f.a3k)(i,r),g=(0,f.nuD)(i,r),{changesOpen:y,onHistoryOpen:b,documentId:j,documentType:v}=tH(),w=(0,f.iav)(j,v),{t:C}=(0,f.$G7)(ek),_=(w?.draft||w?.published||{})._rev,k=h.validation.some(x.YN),[I,E]=(0,a.useState)(!1),T=g.isSyncing,S=h.isValidating,[z,$]=(0,f.hHf)({id:i,type:r,permission:"publish"}),M=(0,f.xJ)(),R=m.disabled?(t=m.disabled,n=(c||{})._updatedAt,("ALREADY_PUBLISHED"===t&&n?(0,s.jsx)(nG,{publishedAt:n}):C(nq[t]))||""):k?C("action.publish.validation-issues.tooltip"):"",D=!!l,P=(0,a.useCallback)(()=>{m.execute(),p("publishing")},[m]);(0,a.useEffect)(()=>{let e=!1===h.isValidating&&h.revision!==_;I&&!T&&e&&(k||P(),E(!1))},[T,P,k,I,h.revision,_,S,h.isValidating]),(0,a.useEffect)(()=>{let e="publishing"===u&&!D;e&&y&&b();let t=e?"published":null,n=setTimeout(()=>{p(t)},e?200:4e3);return()=>clearTimeout(n)},[y,u,D,b]);let L=(0,ea.f1)(),A=(0,a.useCallback)(()=>{L.log(nF,{publishedImmediately:!l?._createdAt,previouslyPublished:!!c}),g.isSyncing||h.isValidating||h.revision!==_?E(!0):P()},[L,l?._createdAt,c,g.isSyncing,h.isValidating,h.revision,_,P]);return(0,a.useMemo)(()=>{if(o)return{tone:"default",icon:d.EI4,label:C("action.publish.live-edit.label"),title:C("action.publish.live-edit.tooltip"),disabled:!0};if(!$&&!z?.granted)return{tone:"default",icon:d.EI4,label:"Publish",title:(0,s.jsx)(f.FMn,{context:"publish-document",currentUser:M}),disabled:!0};let e=!!(I||w?.transactionSyncLock?.enabled||"publishing"===u||"published"===u||k||m.disabled);return{disabled:e||$,tone:"default",label:C("published"===u?"action.publish.published.label":I||"publishing"===u?"action.publish.running.label":"action.publish.draft.label"),icon:d.EI4,title:I?C("action.publish.waiting"):"published"===u||"publishing"===u?null:R,shortcut:e||I?null:"Ctrl+Alt+P",onHandle:A}},[M,w?.transactionSyncLock?.enabled,A,k,$,o,z?.granted,m.disabled,I,u,C,R])};nW.action="publish",nW.displayName="PublishAction";let nK={NOT_PUBLISHED:"action.unpublish.disabled.not-published",NOT_READY:"action.unpublish.disabled.not-ready",LIVE_EDIT_ENABLED:"action.unpublish.disabled.live-edit-enabled"},nX=({id:e,type:t,draft:n,onComplete:i,liveEdit:r})=>{let{unpublish:o}=(0,f.d9t)(e,t),[l,c]=(0,a.useState)(!1),[u,p]=(0,f.hHf)({id:e,type:t,permission:"unpublish"}),m=(0,f.xJ)(),{t:h}=(0,f.$G7)(ek),x=(0,a.useCallback)(()=>{c(!1),i()},[i]),g=(0,a.useCallback)(()=>{c(!1),o.execute(),i()},[i,o]),y=(0,a.useMemo)(()=>l?{type:"dialog",onClose:i,content:(0,s.jsx)(eY,{id:n?._id||e,type:t,action:"unpublish",onCancel:x,onConfirm:g})}:null,[n,e,x,g,l,i,t]);return(0,a.useMemo)(()=>r?null:p||u?.granted?{tone:"critical",icon:d.xEY,disabled:!!o.disabled||p,label:h("action.unpublish.label"),title:o.disabled?h(nK[o.disabled]):"",onHandle:()=>c(!0),dialog:y}:{tone:"critical",icon:d.xEY,label:"Unpublish",title:(0,s.jsx)(f.FMn,{context:"unpublish-document",currentUser:m}),disabled:!0},[m,y,p,r,u?.granted,h,o.disabled])};nX.action="unpublish",nX.displayName="UnpublishAction";let nY=(0,a.memo)(function(e){let{disabled:t,showMenu:n,states:i}=e,{__internal_tasks:r,schemaType:c,openPath:d}=tH(),[u,...p]=i,[m,h]=(0,a.useState)(null),x=f.Lky().beta?.treeArrayEditing?.enabled,g=(0,a.useMemo)(()=>!!x&&(0,f.Ses)(c,d),[x,d,c]),y=(0,a.useMemo)(()=>u&&(u.title||u.shortcut)?(0,s.jsxs)(l.kC,{style:{maxWidth:300},align:"center",gap:3,children:[u.title&&(0,s.jsx)(l.xv,{size:1,children:u.title}),u.shortcut&&(0,s.jsx)(o.SV,{"data-testid":"document-status-bar-hotkeys",fontSize:1,style:{marginTop:-4,marginBottom:-4},keys:String(u.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase())})]}):null,[u]);return(0,s.jsxs)(l.kC,{align:"center",gap:1,children:[r&&r.footerAction,u&&(0,s.jsx)(l.li,{zOffset:200,children:(0,s.jsx)(o.u,{disabled:!y,content:y,placement:"top",children:(0,s.jsx)(l.Kq,{children:(0,s.jsx)(o.zx,{"data-testid":`action-${u.label}`,disabled:t||!!u.disabled||g,icon:u.icon,onClick:u.onHandle,ref:h,size:"large",text:u.label,tone:u.tone||"primary"})})})}),n&&p.length>0&&(0,s.jsx)(nP,{actionStates:p,disabled:t}),u&&u.dialog&&(0,s.jsx)(nR,{dialog:u.dialog,referenceElement:m})]})}),nQ=(0,a.memo)(function(){let{actions:e,connectionState:t,documentId:n,editState:i}=tH(),r=(0,a.useMemo)(()=>(e??[]).filter(e=>!nJ(e)),[e]),o=(0,a.useCallback)(({states:e})=>(0,s.jsx)(nY,{disabled:"connected"!==t,showMenu:r.length>1,states:e},n),[r.length,t,n]);return 0!==r.length&&i?(0,s.jsx)(tP,{actions:r,actionProps:i,group:"default",children:o}):null}),nZ=(0,a.memo)(function(){let{actions:e,connectionState:t,editState:n,timelineStore:i}=tH(),r=f.P08(i,e=>e.revTime)?.id||"",o=(n?.draft||n?.published||{})._rev===r,l=(0,a.useMemo)(()=>({...n||{},revision:r}),[n,r]),c=(0,a.useMemo)(()=>(e??[]).filter(nJ).slice(-1),[e]),d=(0,a.useCallback)(({states:e})=>(0,s.jsx)(nY,{disabled:"connected"!==t||!!o,showMenu:!1,states:e}),[t,o]);return(0,s.jsx)(tP,{actions:c,actionProps:l,group:"default",children:d})});function nJ(e){return e.action===nB.action}let n0={create:d.agZ,delete:d.XHJ,discardDraft:d.Two,initial:d.agZ,editDraft:d.dY8,editLive:d.dY8,publish:d.EI4,unpublish:d.xEY},n1=(0,w.zo)(l.Kq)`
  max-width: 200px;
`,n2=(0,w.zo)(l.kC)`
  max-height: calc(100vh - 198px);
  min-width: 244px;
`,n8=(0,w.zo)(l.xu)(({$visible:e})=>(0,w.iv)`
    opacity: 0;
    pointer-events: none;

    ${e&&(0,w.iv)`
      opacity: 1;
      pointer-events: auto;
    `}
  `),n3={initial:"timeline.operation.created-initial",create:"timeline.operation.created",publish:"timeline.operation.published",editLive:"timeline.operation.edited-live",editDraft:"timeline.operation.edited-draft",unpublish:"timeline.operation.unpublished",discardDraft:"timeline.operation.draft-discarded",delete:"timeline.operation.deleted"},n5=(0,w.zo)(l.kC)(({theme:e})=>{let t=e.sanity.color.base.skeleton?.from;return(0,w.iv)`
    --timeline-hairline-width: 1px;
    position: relative;
    z-index: 2;
    margin: 0;
    padding: 0;

    &::before {
      position: absolute;
      content: '';
      height: 100%;
      width: var(--timeline-hairline-width);
      background: ${t};
      top: 0;
      left: calc((100% - var(--timeline-hairline-width)) / 2);
      z-index: 1;
    }
  `}),n4=(0,w.zo)(l.zx)(({$selected:e,$disabled:t})=>(0,w.iv)`
    position: relative;
    width: 100%;

    /* Line styling */
    &[data-first] ${n5}::before {
      height: 50%;
      top: unset;
      bottom: 0;
    }

    &[data-last] ${n5}::before {
      height: 50%;
    }

    ${e&&(0,w.iv)`
      ${n5}::before {
        background: transparent;
      }
    `}

    ${t&&(0,w.iv)`
      cursor: not-allowed;
    `}
  `),n7=(0,w.zo)(l.xu)`
  background: var(--card-bg-color);
  border-radius: 50px;
  position: relative;
  z-index: 2;
`,n9=(0,w.zo)(l.xu)`
  min-width: 1rem;
  margin-left: ${({theme:e})=>`-${(0,l.hO)(e.sanity.space[1])}`};
`;function n6({maxLength:e,userIds:t}){return(0,s.jsx)(l.Jh,{maxLength:e,children:t.map(e=>(0,s.jsx)(f.YtX,{user:e,withTooltip:!0},e))})}let ie={initial:"primary",create:"primary",publish:"positive",editLive:"caution",editDraft:"caution",unpublish:"critical",discardDraft:"critical",delete:"critical",withinSelection:"primary"};function it({chunk:e,isFirst:t,isLast:n,isLatest:i,isSelected:r,onSelect:o,timestamp:c,type:d}){let{t:u}=(0,f.$G7)("studio"),p=n0[d],m=Array.from(e.authors),h="delete"!==d,x=(0,f.P9l)({dateStyle:"medium",timeStyle:"short"}),g=(0,a.useMemo)(()=>{let e=new Date(c);return x.format(e)},[c,x]),y=(0,a.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),h&&o(e)},[o,e,h]);return(0,s.jsx)(n4,{$selected:r,$disabled:!h,"data-testid":"timeline-item-button","data-chunk-id":e.id,"data-first":!!t||void 0,"data-last":!!n||void 0,"data-ui":"timelineItem",mode:r?"default":"bleed",onClick:y,padding:0,radius:2,tone:r?"primary":ie[e.type],children:(0,s.jsx)(l.xu,{paddingX:2,children:(0,s.jsxs)(l.kC,{align:"stretch",children:[(0,s.jsx)(n5,{align:"center",children:(0,s.jsx)(n7,{padding:2,children:(0,s.jsx)(l.xv,{size:2,children:p&&(0,a.createElement)(p)})})}),(0,s.jsxs)(l.Kq,{space:2,margin:2,children:[i&&(0,s.jsx)(l.kC,{children:(0,s.jsx)(l.Zb,{padding:1,radius:2,shadow:1,tone:r?"primary":ie[e.type],children:(0,s.jsx)(l.xv,{muted:!0,size:0,weight:"medium",children:u("timeline.latest")})})}),(0,s.jsx)(l.xu,{children:(0,s.jsx)(l.xv,{size:1,weight:"medium",children:u(n3[d])||(0,s.jsx)("code",{children:d})})}),(0,s.jsx)(n9,{paddingX:1,children:(0,s.jsx)(l.xv,{as:"time",size:0,muted:!0,dateTime:c,children:g})})]}),(0,s.jsx)(l.kC,{flex:1,justify:"flex-end",align:"center",children:(0,s.jsx)(n6,{maxLength:3,userIds:m})})]})})})}let ii=({chunks:e,disabledBeforeFirstChunk:t,hasMoreChunks:n,lastChunk:i,onLoadMore:r,onSelect:o,firstChunk:c})=>{let[d,u]=(0,a.useState)(!1),{t:p}=(0,f.$G7)("studio"),m=(0,a.useMemo)(()=>e.filter(e=>!t||!c||e.index<c.index),[e,t,c]),h=(0,a.useMemo)(()=>i?.id?m.findIndex(e=>e.id===i.id):-1,[i?.id,m]),x=(0,a.useCallback)((e,{activeIndex:i})=>{let r=0===i,a=m&&i===m.length-1||!1;return(0,s.jsxs)(l.xu,{paddingBottom:a?1:0,paddingTop:r?1:0,paddingX:1,children:[(0,s.jsx)(it,{chunk:e,isFirst:r,isLast:a,isLatest:0===i&&!t,isSelected:i===h,onSelect:o,timestamp:e.endTimestamp,type:e.type}),i===m.length-1&&n&&(0,s.jsx)(f.Bwn,{})]})},[t,m,n,o,h]);return(0,a.useEffect)(()=>u(!0),[]),(0,s.jsxs)(n8,{$visible:!h||d,"data-ui":"timeline",children:[0===m.length&&(0,s.jsxs)(n1,{padding:3,space:3,children:[(0,s.jsx)(l.xv,{size:1,weight:"medium",children:p("timeline.error.no-document-history-title")}),(0,s.jsx)(l.xv,{muted:!0,size:1,children:p("timeline.error.no-document-history-description")})]}),m.length>0&&(0,s.jsx)(n2,{direction:"column",children:(0,s.jsx)(f.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:p("timeline.list.aria-label"),autoFocus:"list",initialIndex:h,initialScrollAlign:"center",itemHeight:40,items:m,onEndReached:r,onEndReachedIndexOffset:20,overscan:5,renderItem:x,wrapAround:!1})})]})};function ir(){let{t:e}=(0,f.$G7)("studio");return(0,s.jsxs)(l.kC,{align:"flex-start",gap:3,padding:4,children:[(0,s.jsx)(f.LPT,{tone:"critical",children:(0,s.jsx)(d.uIy,{})}),(0,s.jsxs)(l.Kq,{space:4,children:[(0,s.jsx)(f.LPT,{size:1,tone:"critical",weight:"medium",children:e("timeline.error.load-document-changes-title")}),(0,s.jsx)(f.LPT,{size:1,tone:"critical",children:e("timeline.error.load-document-changes-description")})]})]})}ii.displayName="Timeline";let io=(0,w.zo)(o.J2)`
  overflow: hidden;
  overflow: clip;
`;function is({chunk:e,mode:t,placement:n}){let{setTimelineRange:i,setTimelineMode:r,timelineError:c,ready:u,timelineStore:p}=tH(),[m,h]=(0,a.useState)(!1),[x,g]=(0,a.useState)(null),y=(0,a.useRef)(null),b=(0,l.pm)(),j=(0,f.P08)(p,e=>e.chunks),v=(0,f.P08)(p,e=>e.isLoading),w=(0,f.P08)(p,e=>e.hasMoreChunks),C=(0,f.P08)(p,e=>e.realRevChunk),_=(0,f.P08)(p,e=>e.sinceTime),{t:k}=(0,f.$G7)("studio"),I=(0,a.useCallback)(()=>{r(t),h(!0)},[t,r]),E=(0,a.useCallback)(()=>{r("closed"),h(!1)},[r]),T=(0,a.useCallback)(e=>{m&&("Escape"===e.key||"Tab"===e.key)&&(E(),x?.focus())},[x,E,m]);(0,l.qh)(T),(0,l.Of)(m&&E,()=>[x,y.current]);let S=(0,a.useCallback)(e=>{try{let[t,n]=p.findRangeForRev(e);r("closed"),i(t,n)}catch(e){b.push({closable:!0,description:e.message,status:"error",title:k("timeline.error.unable-to-load-revision")})}},[r,i,k,p,b]),z=(0,a.useCallback)(e=>{try{let[t,n]=p.findRangeForSince(e);r("closed"),i(t,n)}catch(e){b.push({closable:!0,description:e.message,status:"error",title:k("timeline.error.unable-to-load-revision")})}},[r,i,k,p,b]),$=(0,a.useCallback)(()=>{v||p.loadMore()},[v,p]),M=c?(0,s.jsx)(ir,{}):(0,s.jsxs)(s.Fragment,{children:["rev"===t&&(0,s.jsx)(ii,{chunks:j,firstChunk:C,hasMoreChunks:w,lastChunk:C,onLoadMore:$,onSelect:S}),"since"===t&&(0,s.jsx)(ii,{chunks:j,disabledBeforeFirstChunk:!0,firstChunk:C,hasMoreChunks:w,lastChunk:_,onLoadMore:$,onSelect:z})]}),R={timestamp:{dateStyle:"medium",timeStyle:"short"}},D=e?k(n3[e.type],{context:"timestamp",timestamp:new Date(e?.endTimestamp),formatParams:R}):k("timeline.latest-revision"),P=e?k("timeline.since",{timestamp:new Date(e?.endTimestamp),formatParams:R}):k("timeline.since-version-missing");return(0,s.jsx)(io,{"data-testid":"timeline-menu",constrainSize:!0,content:m&&M,"data-ui":"versionMenu",open:m,placement:n,portal:!0,ref:y,children:(0,s.jsx)(o.zx,{"data-testid":m?"timeline-menu-close-button":"timeline-menu-open-button",disabled:!u,mode:"bleed",iconRight:d.v4q,onClick:m?E:I,ref:g,selected:m,style:{maxWidth:"100%"},text:u?"rev"===t?D:P:k("timeline.loading-history")})})}function il(){let{activeViewId:e,paneKey:t,views:n}=tH(),i=`${t}tabpanel`;return(0,s.jsx)(l.td,{space:1,children:n.map((n,r)=>(0,s.jsx)(ia,{icon:n.icon,id:`${t}tab-${n.id}`,isActive:e===n.id,label:n.title,tabPanelId:i,viewId:0===r?null:n.id??null},n.id))})}function ia(e){let{icon:t,id:n,isActive:i,label:r,tabPanelId:l,viewId:c,...d}=e,{ready:u}=tH(),{setView:p}=eU(),m=(0,a.useCallback)(()=>p(c),[p,c]);return(0,s.jsx)(o.OK,{...d,"aria-controls":l,disabled:!u,icon:t,id:n,label:r,onClick:m,selected:i})}function ic(){let{connectionState:e,schemaType:t,title:n,value:i}=tH(),{error:r,value:o}=(0,f._2T)({enabled:!!i&&"connecting"!==e,schemaType:t,value:i}),{t:l}=(0,f.$G7)(ek);return"connecting"===e?(0,s.jsx)(s.Fragment,{}):n?(0,s.jsx)(s.Fragment,{children:n}):i?r?(0,s.jsx)(s.Fragment,{children:l("panes.document-header-title.error.text",{error:r.message})}):(0,s.jsx)(s.Fragment,{children:o?.title||(0,s.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:l("panes.document-header-title.untitled.text")})}):(0,s.jsx)(s.Fragment,{children:l("panes.document-header-title.new.text",{schemaType:t?.title||t?.name})})}let id=(0,a.memo)((0,a.forwardRef)(function(e,t){let{menuItems:n}=e,{actions:i,editState:r,onMenuAction:c,onPaneClose:u,onPaneSplit:p,menuItemGroups:m,schemaType:h,timelineStore:x,connectionState:g,views:y,unstable_languageFilter:b}=tH(),{features:j}=tK(),{index:v,BackLink:w,hasGroupSiblings:C}=eU(),{actions:_}=(0,f.qGk)(),[k,I]=(0,a.useState)(null),E=(0,a.useMemo)(()=>(i??[]).filter(e=>!nJ(e)),[i]),T=(0,a.useMemo)(()=>tC({actionHandler:c,fieldActions:_,menuItems:n,menuItemGroups:m}),[c,_,m,n]),S=(0,a.useMemo)(()=>T.filter(tv),[T]),z=(0,a.useMemo)(()=>T.filter(tw),[T]),$=y.length>1,M=(0,f.P08)(x,e=>e.revTime),{collapsed:R,isLast:D}=e8(),P=j.splitViews&&p&&y.length>1,L=P&&C,A=j.backButton&&v>0,O=!L&&!A&&!!w,{t:N}=(0,f.$G7)(ek),U=(0,a.useCallback)(({states:e})=>(0,s.jsx)(iu,{contextMenuNodes:z,setReferenceElement:I,referenceElement:k,states:e}),[z,k]);return(0,s.jsx)(o.uE,{children:(0,s.jsx)(tp,{border:!0,ref:t,loading:"connecting"===g,title:(0,s.jsx)(ic,{}),tabs:$&&(0,s.jsx)(il,{}),tabIndex:D&&!R?-1:0,backButton:A&&(0,s.jsx)(o.zx,{as:w,"data-as":"a",icon:d.Y4O,mode:"bleed",tooltipProps:{content:N("pane-header.back-button.text")}}),subActions:(0,s.jsx)(is,{chunk:M,mode:"rev",placement:"bottom-end"}),actions:(0,s.jsxs)(l.kC,{align:"center",gap:1,children:[b.length>0&&(0,s.jsx)(s.Fragment,{children:b.map((e,t)=>(0,a.createElement)(e,{key:`language-filter-${t}`,schemaType:h}))}),S.map(e=>(0,s.jsx)(th,{node:e},e.key)),r&&(0,s.jsx)(tP,{actions:E,actionProps:r,group:"paneActions",children:U}),P&&(0,s.jsx)(o.zx,{"aria-label":N("buttons.split-pane-button.aria-label"),icon:d.iro,mode:"bleed",onClick:p,tooltipProps:{content:N("buttons.split-pane-button.tooltip")}},"split-pane-button"),L&&(0,s.jsx)(o.zx,{icon:d.Two,mode:"bleed",onClick:u,tooltipProps:{content:N("buttons.split-pane-close-button.title")}},"close-view-button"),O&&(0,s.jsx)(o.zx,{icon:d.Two,mode:"bleed",tooltipProps:{content:N("buttons.split-pane-close-group-button.title")},as:w},"close-view-button")]})})})})),iu=(0,a.memo)(function(e){let{setReferenceElement:t,referenceElement:n,contextMenuNodes:i}=e,r=(0,a.useDeferredValue)(e.states);return(0,s.jsx)(ip,{setReferenceElement:t,referenceElement:n,contextMenuNodes:i,states:r})}),ip=(0,a.memo)(function(e){let{states:t,setReferenceElement:n,contextMenuNodes:i,referenceElement:r}=e,o=(0,a.useCallback)(({handleAction:e})=>(0,s.jsx)("div",{ref:n,children:(0,s.jsx)(tn,{nodes:i,actionsNodes:t.length>0?t.map((t,n)=>(0,s.jsx)(nL,{actionState:t,disabled:!!t.disabled,index:n,onAction:e},t.label)):void 0},"context-menu")}),[i,n,t]);return(0,s.jsx)(nD,{actionStates:t,referenceElement:r,children:o})}),im={primary:"primary",success:"positive",warning:"caution",danger:"critical"},ih=(0,a.memo)(function({states:e}){return 0===e.length?null:(0,s.jsx)(l.gF,{space:1,children:e.map((e,t)=>(0,s.jsx)(o.u,{content:e.title,disabled:!e.title,placement:"top",portal:!0,children:(0,s.jsx)(l.Ct,{fontSize:1,mode:"outline",paddingX:2,paddingY:1,radius:4,tone:e.color?im[e.color]:void 0,style:{whiteSpace:"nowrap"},children:e.label})},`${e.label}-${t}`))})}),ix=(0,a.memo)(function(e){let t=(0,a.useDeferredValue)(e.states);return(0,s.jsx)(ih,{states:t})});function ig(){let{badges:e,editState:t}=tH(),n=(0,a.useCallback)(({states:e})=>(0,s.jsx)(ix,{states:e}),[]);return t&&e?(0,s.jsx)(tL,{badges:e,badgeProps:t,children:n}):null}let iy=(0,w.zo)(ed.E.path)`
  transform-origin: center;
`,ib=e=>(0,s.jsx)(ed.E.circle,{fill:"none",r:"8",cx:"12.5",cy:"12.5",strokeWidth:"1.2",...e}),ij=e=>(0,s.jsx)(iy,{fill:"none",d:"M14 17.5619L11.5 20.5L14.5 23.0619M11 7.43811L13.5 4.50001L10.5 1.93811",...e}),iv=e=>(0,s.jsx)(ed.E.path,{d:"M9.5 12.1316L11.7414 14.5L16 10",...e}),iw=(0,w.F4)`
  0% {
    transform: rotate(0);
  }
  100% {
    transform: rotate(360deg);
  }
`,iC=w.zo.g`
  transform-origin: center;

  &[data-rotate] {
    animation: ${iw} 1s ease-in-out infinite;
  }
`,i_={syncing:{scale:1,transition:{duration:0}},saved:{scale:[1,.8,1.2,.9,1.1,.95,1.05,.99,1],transition:{duration:.5,delay:.2}},changes:{transition:{duration:0}}},ik={syncing:{strokeDasharray:"0, 0, 23, 3, 23, 3",strokeDashoffset:10,opacity:1,transition:{duration:0}},saved:{strokeDasharray:"0, 0, 23, 0, 23, 0",strokeDashoffset:10,opacity:1,transition:{duration:.2}},changes:{strokeDasharray:"0, 60, 23, 0, 23, 0",strokeDashoffset:0,opacity:0,transition:{duration:.5}}},iI={syncing:{opacity:1,transition:{duration:0}},saved:{opacity:0,transition:{duration:.2}},changes:{opacity:0}},iE={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:1,transition:{delay:.4,duration:.3}},changes:{pathLength:0,transition:{duration:.2}}};function iT(e){let{status:t}=e;return t?(0,s.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",stroke:"currentColor",strokeWidth:"1.2","data-sanity-icon":"animated-status-icon",children:(0,s.jsxs)(ed.E.g,{variants:i_,initial:t,animate:t,children:[(0,s.jsxs)(iC,{"data-rotate":"changes"===t?void 0:"",children:[(0,s.jsx)(ij,{variants:iI,initial:t,animate:t}),(0,s.jsx)(ib,{variants:ik,initial:t,animate:t})]}),(0,s.jsx)(iv,{variants:iE,initial:t,animate:t})]})}):null}let iS={saved:{i18nKey:"status-bar.document-status-pulse.status.saved.text",tone:"positive"},syncing:{i18nKey:"status-bar.document-status-pulse.status.syncing.text",tone:"default"}},iz=e=>{let{status:t}=e,{t:n}=(0,f.$G7)(ek);if("saved"!==t&&"syncing"!==t)return null;let i=iS[t];return(0,s.jsxs)(l.kC,{align:"center",gap:2,"data-testid":"pane-footer-document-status-pulse",children:[(0,s.jsx)(f.LPT,{size:1,tone:i.tone,children:(0,s.jsx)(iT,{status:t})}),(0,s.jsx)(l.xv,{muted:!0,size:1,children:n(i.i18nKey)})]})};function i$({singleLine:e}){let{documentId:t,documentType:n,editState:i,value:r}=tH(),[c,d]=(0,a.useState)(null),u=(0,f.nuD)(t,n),p=r?._updatedAt;return(0,a.useEffect)(()=>{if("syncing"===c&&!u.isSyncing){let e=setTimeout(()=>d("saved"),1e3);return()=>clearTimeout(e)}if("saved"===c){let e=setTimeout(()=>d(null),3e3);return()=>clearTimeout(e)}},[c,p,u.isSyncing]),(0,a.useLayoutEffect)(()=>{d(null)},[t]),(0,a.useLayoutEffect)(()=>{u.isSyncing&&d("syncing")},[u.isSyncing,p]),c?(0,s.jsx)(iz,{status:c||void 0}):(0,s.jsx)(o.u,{content:(0,s.jsx)(f._mO,{absoluteDate:!0,draft:i?.draft,published:i?.published}),placement:"top",children:(0,s.jsxs)(l.kC,{align:"center",gap:3,children:[(0,s.jsx)(f.aAo,{draft:i?.draft,published:i?.published}),(0,s.jsx)(f._mO,{draft:i?.draft,published:i?.published,singleLine:e})]})})}function iM(e){let{actionsBoxRef:t}=e,{editState:n,timelineStore:i}=tH(),r=(0,f.P08)(i,e=>e.onOlderRevision),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null);!function({element:e,onResize:t}){(0,a.useLayoutEffect)(()=>(e&&f.x$w.observe(e,t),()=>{e&&f.x$w.unobserve(e)}),[e,t])}({element:d,onResize:(0,a.useCallback)(e=>{c(e.contentRect.width<480)},[])});let p=n?.ready&&"boolean"==typeof o;return(0,s.jsx)(l.kC,{direction:"column",ref:u,sizing:"border",children:p&&(0,s.jsxs)(l.kC,{align:"stretch",gap:1,justify:"space-between",paddingY:2,paddingLeft:4,paddingRight:3,children:[(0,s.jsxs)(l.kC,{align:"center",flex:1,gap:o?2:3,wrap:"wrap",paddingRight:3,children:[(0,s.jsxs)(l.kC,{align:"center",children:[(0,s.jsx)(i$,{singleLine:!o}),(0,s.jsx)(np,{size:"large"})]}),(0,s.jsx)(ig,{})]}),(0,s.jsxs)(l.kC,{align:"flex-start",justify:"flex-end",ref:t,style:{flexShrink:0,marginLeft:"auto"},children:[(0,s.jsx)(np,{size:"large"}),r?(0,s.jsx)(nZ,{}):(0,s.jsx)(nQ,{})]})]})})}let iR=(0,a.memo)(function(e){let{actionsBoxElement:t,activeIndex:n,as:i="div",children:r,id:o,onActionStart:l,onKeyDown:c,rootRef:d,states:u,...p}=e,m=u[n],h=(0,a.useCallback)(e=>{let t=u.filter(t=>t.shortcut&&(0,ei.P6)(t.shortcut,e)),n=t[0];if(t.length>1&&console.warn(`Keyboard shortcut conflict: More than one document action matches the shortcut "${n.shortcut}"`),n&&!n.disabled&&n.onHandle){e.preventDefault(),n.onHandle(),l(u.indexOf(n));return}c&&c(e)},[l,c,u]);return(0,a.createElement)(i,{id:o,onKeyDown:h,tabIndex:-1,...p,ref:d},[r,m&&m.dialog&&(0,s.jsx)(f.jr5,{zOffset:"paneFooter",children:(0,s.jsx)(nR,{dialog:m.dialog,referenceElement:t})})])}),iD=(0,a.memo)(e=>{let{actionsBoxElement:t,as:n="div",children:i,...r}=e,{actions:o,editState:l}=tH(),[c,d]=(0,a.useState)(-1),u=(0,a.useCallback)(e=>{d(e)},[]),p=(0,a.useMemo)(()=>l&&{...l,onComplete:()=>{},revision:void 0},[l]),m=(0,a.useCallback)(({states:e})=>(0,s.jsx)(iR,{...r,activeIndex:c,actionsBoxElement:t,as:n,onActionStart:u,states:e,children:i}),[t,c,n,i,u,r]);return p&&o?(0,s.jsx)(tP,{actionProps:p,actions:o,children:m}):null});iD.displayName="Memo(DocumentActionShortcuts)";let iP=e=>(0,f.Uy$)(e)&&"string"==typeof e._id&&"string"==typeof e._type;function iL(e){let{resolveProductionUrl:t}=(0,f.Lky)().document,n=(0,a.useMemo)(()=>new D.X(void 0),[]);(0,a.useEffect)(()=>{n.next(e)},[n,e]);let i=(0,a.useMemo)(()=>n.asObservable().pipe((0,Y.x)(),(0,et.b)(500),(0,Q.w)(e=>iP(e)?(0,P.D)(t({document:e})):(0,S.of)(void 0)),(0,Y.x)(),(0,K.K)(e=>{let t=(0,f.Uy$)(e)&&"string"==typeof e.message?e.message:"Unknown error";throw Error(`An error was thrown while trying to get your preview url: ${t}`)})),[t,n]);return(0,el.m)(i)}function iA(e){let{documentType:t,value:n,currentMinWidth:i,paneKey:r,minWidth:o}=e,{t:a}=(0,f.$G7)();return(0,s.jsx)(tA,{currentMinWidth:i,flex:2.5,minWidth:o,paneKey:r,title:(0,s.jsx)(f.vNl,{t:a,i18nKey:"panes.document-pane.document-unknown-type.title",values:{documentType:t}}),tone:"caution",children:(0,s.jsxs)(l.Kq,{space:4,children:[t&&(0,s.jsx)(l.xv,{as:"p",children:(0,s.jsx)(f.vNl,{t:a,i18nKey:"panes.document-pane.document-unknown-type.text",values:{documentType:t}})}),!t&&(0,s.jsx)(l.xv,{as:"p",children:a("panes.document-pane.document-unknown-type.without-schema.text")}),f.r8Q&&n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.xv,{as:"p",children:"Here is the JSON representation of the document:"}),(0,s.jsx)(l.Zb,{padding:3,overflow:"auto",radius:2,shadow:1,tone:"inherit",children:(0,s.jsx)(l.EK,{language:"json",size:[1,1,2],children:JSON.stringify(n,null,2)})})]})]})})}let iO=[],iN=["fixed","fixed","absolute"],iU=(0,w.zo)(f.jbM)`
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  min-width: 0;
`;function iH(){let{changesOpen:e,documentId:t,documentType:n,fieldActions:i,focusPath:r,inspectOpen:c,inspector:u,inspectors:p,onFocus:m,onHistoryOpen:h,onMenuAction:x,onPathOpen:g,paneKey:y,schemaType:b,value:j}=tH(),{features:v}=tK(),{t:w}=(0,er.$G)(ek),{collapsed:C}=eL(),_=(0,f.Cnp)(),k=iL(j),[I,E]=(0,a.useState)(null),[T,S]=(0,a.useState)(null),[z,$]=(0,a.useState)(null),[M,R]=(0,a.useState)(null),[D,P]=(0,a.useState)(null);(0,f.LxO)({element:I,focusPath:r,value:j});let[L,A]=(0,a.useState)([]),[O,N]=(0,a.useState)([]),U=(0,l.XL)(T),H=(0,l.XL)(z),V=U?.height,B=H?.height,F=600+(u?320:0),q=320+(u?320:0),G=(0,a.useMemo)(()=>p?.find(e=>e.name===u?.name),[p,u?.name]),W=!!j,K=(0,a.useMemo)(()=>(function(e){let t=function({currentInspector:e,hasValue:t,inspectors:n,inspectorMenuItems:i}){return n.map((n,r)=>{let o=i[r];return!o||o.hidden?null:{action:`${tY}${n.name}`,group:o.showAsAction?void 0:"inspectors",icon:o.icon,isDisabled:!t,selected:e?.name===n.name,shortcut:o.hotkeys?.join("+"),showAsAction:o.showAsAction,title:o.title,tone:o.tone}}).filter(Boolean)}(e),n=[function({previewUrl:e,t}){return e?{action:"production-preview",group:"links",title:t("production-preview.menu-item.title"),icon:d.YE8,shortcut:"Ctrl+Alt+O"}:null}(e)].filter(Boolean);return[{action:"copy-document-url",showAsAction:!0,title:e.t("action.copy-document-url.label"),icon:d.xPt},...t,function({hasValue:e,t}){return{action:"inspect",group:"inspectors",title:t("document-inspector.menu-item.title"),icon:d.Pr8,isDisabled:!e,shortcut:"Ctrl+Alt+I"}}(e),...n]})({currentInspector:G,features:v,hasValue:W,inspectorMenuItems:L,inspectors:p,previewUrl:k,t:w}),[G,v,W,L,p,k,w]),X=(0,a.useCallback)(e=>{for(let t of K)if(t.shortcut&&(0,ei.P6)(t.shortcut,e)){e.preventDefault(),e.stopPropagation(),x(t);return}},[x,K]),Y=(0,a.useCallback)(e=>{g(e),m(e)},[g,m]);return b?(0,s.jsxs)(f.iWf,{value:j,children:[p.length>0&&(0,s.jsx)(tJ,{documentId:t,documentType:n,inspectors:p,onMenuItems:A}),i.length>0&&b&&(0,s.jsx)(f.QMc,{actions:i,documentId:t,documentType:n,onActions:N,path:iO,schemaType:b}),(0,s.jsx)(f.kNp,{actions:O,path:iO,children:(0,s.jsxs)(iD,{actionsBoxElement:M,as:e1,currentMinWidth:F,"data-testid":"document-pane",flex:2.5,id:y,minWidth:q,onKeyUp:X,rootRef:E,children:[(0,s.jsx)(id,{ref:$,menuItems:K}),(0,s.jsx)(l.Tu,{position:iN,zOffset:_.paneDialog,children:(0,s.jsx)(l.kC,{direction:"column",flex:1,height:C?void 0:"fill",children:(0,s.jsx)(iU,{"data-testid":"change-connector-root",isReviewChangesOpen:e,onOpenReviewChanges:h,onSetFocus:Y,children:(0,s.jsx)(n_,{footerHeight:V||null,headerHeight:B||null,isInspectOpen:c,rootElement:I,setDocumentPanelPortalElement:P})})})}),(0,s.jsx)(l.Xp,{__unstable_elements:{[tW]:D},children:(0,s.jsx)(l.Tu,{position:iN,zOffset:_.portal,children:(0,s.jsx)(to,{ref:S,children:(0,s.jsx)(o.uE,{children:(0,s.jsx)(iM,{actionsBoxRef:R})})})})}),(0,s.jsx)(t2,{})]})})]}):(0,s.jsx)(iA,{currentMinWidth:F,documentType:n,minWidth:q,paneKey:y,value:j})}function iV(e){return e.document?.components?.unstable_layout}let iB=(0,ec.dS)({name:"DocumentURLCopied",version:1,description:"User copied document URL to clipboard"}),iF=(0,ec.dS)({name:"Create a new draft",version:1,description:"User created a new draft"}),iq=(0,a.memo)(e=>{let{children:t,index:n,pane:i,paneKey:r,onFocusPath:o}=e,d=(0,f.I_y)(),u=(0,f.zEW)(),{setDocumentMeta:p}=(0,f.ooN)(),{__internal_tasks:m,document:{actions:h,badges:x,unstable_fieldActions:g,unstable_languageFilter:y,inspectors:b}}=(0,f.Lky)(),j=(0,f.ap5)(),v=eU(),w=v.setParams,{features:_}=tK(),{push:I}=(0,l.pm)(),{options:E,menuItemGroups:T=tQ,title:S=null,views:z=[]}=i,$=(0,f.BoV)(E),M=$.id,R=(0,f.vsM)(M),D=E.type,P=(0,f.BoV)(v.params)||tX,L=(0,f.BoV)(v.payload),{templateName:A,templateParams:O}=(0,a.useMemo)(()=>(function(e,t){let n=t.panePayload||{},i=t.templateName;t.urlTemplate&&i&&i!==t.urlTemplate&&console.warn(`Conflicting templates: URL says "${t.urlTemplate}", structure node says "${i}". Using "${i}".`);let r=i||t.urlTemplate,o=e.filter(e=>e.schemaType===t.documentType),s={...t.templateParams,..."object"==typeof n&&n||{}},l=r;return r||1!==o.length||(l=o[0].id),{templateName:l,templateParams:s}})(u,{documentType:D,templateName:$.template,templateParams:$.templateParameters,panePayload:L,urlTemplate:P.template}),[D,$,P,L,u]),N=(0,f.t2O)({documentId:R,documentType:D,templateName:A,templateParams:O}),U=(0,f.BoV)(N),{patch:H}=(0,f.d9t)(R,D),V=(0,f.iav)(R,D),{validation:B}=(0,f.a3k)(R,D),F=(0,f.z1O)(R,D),q=d.get(D),G=V?.draft||V?.published||U.value,[W,K]=(0,a.useState)(!1),X=(0,a.useMemo)(()=>h({schemaType:D,documentId:R}),[h,R,D]),Y=(0,a.useMemo)(()=>x({schemaType:D,documentId:R}),[x,R,D]),Q=(0,a.useMemo)(()=>y({schemaType:D,documentId:R}),[R,D,y]),Z=(0,f.BoV)(B),J=(0,f.BoV)(z),[ee,et]=(0,a.useState)(()=>P.path?(0,k.mL)(P.path):f.LZ8),en=(0,a.useRef)([]),ei=P.view||J[0]&&J[0].id||null,[er,eo]=(0,a.useState)("closed"),[es,el]=(0,a.useState)(null),ec=(0,f.Dab)({documentId:R,documentType:D,onError:el,rev:P.rev,since:P.since}),ed=(0,f.P08)(ec,e=>e.onOlderRevision),eh=(0,f.P08)(ec,e=>e.revTime),ef=(0,f.P08)(ec,e=>e.sinceAttributes),ex=(0,f.P08)(ec,e=>e.timelineDisplayed),eg=(0,f.P08)(ec,e=>e.timelineReady),ey=(0,f.P08)(ec,e=>e.isPristine),eb=(0,a.useMemo)(()=>!!eg&&!V?.draft&&!V?.published&&!ey,[V?.draft,V?.published,ey,eg]),ej=iL(G),[ev,ew]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e=j.documentPresence(R).subscribe(e=>{ew(e)});return()=>{e.unsubscribe()}},[R,j]);let eC=(0,a.useMemo)(()=>b({documentId:R,documentType:D}),[R,D,b]),[e_,eI]=(0,a.useState)(()=>P.inspect||null),eE=(0,a.useRef)(P.inspect);(0,a.useEffect)(()=>{eE.current!==P.inspect&&(eE.current=P.inspect,eI(P.inspect||null))},[P.inspect]);let eT=eC?.find(e=>e.name===e_),eS=eC.find(e=>e.name===tZ),ez=eT?.name===tZ,{t:e$}=(0,f.$G7)(ek),eM="on"===P.inspect,eR=ez?ef:V?.published||null,eD=(0,a.useMemo)(()=>q?g({documentId:R,documentType:D,schemaType:q}):[],[R,D,g,q]),eP="connected"===F&&V.ready&&(eg||!!es),eL=(0,a.useMemo)(()=>ed?ex||{_id:G._id,_type:G._type}:G,[ed,ex,G]),eA=(0,a.useCallback)((e,t)=>{w({...P,since:e,rev:t||void 0})},[P,w]),eO=(0,a.useCallback)(e=>{th.current||(et(f.LZ8),en.current!==f.LZ8&&(en.current=f.LZ8,o?.(f.LZ8)))},[o,et]),eN=(0,a.useRef)(()=>{throw Error("Nope")});eN.current=e=>{V.draft||V.published||eX.log(iF),H.execute((0,f.GWp)(e.patches),U.value)};let eH=(0,a.useCallback)(e=>eN.current(e),[]),eV=(0,a.useCallback)(e=>{let t=e&&eC.find(t=>t.name===e);if(e&&!t){console.warn(`No inspector named "${e}"`);return}if(eT){if(t){let e=t.onClose?.({params:P})??{params:P};eI(null),eE.current=void 0,w({...e.params,inspect:void 0});return}if(eT){let e=eT.onClose?.({params:P})??{params:P};eI(null),eE.current=void 0,w({...e.params,inspect:void 0})}}},[eT,eC,P,w]),eB=(0,a.useCallback)((e,t)=>{let n=eC.find(t=>t.name===e);if(!n){console.warn(`No inspector named "${e}"`);return}if(eT?.name===n.name){w({...P,...t,inspect:n.name});return}let i=P;eT&&(i=(n.onClose?.({params:i})??{params:i}).params);let r=n.onOpen?.({params:i})??{params:i};eI(n.name),eE.current=n.name,w({...r.params,...t,inspect:n.name})},[eT,eC,P,w]),eF=(0,a.useCallback)(()=>{eS&&eV(eS.name)},[eV,eS]),eq=(0,a.useCallback)(()=>{_.reviewChanges&&eS&&eB(eS.name)},[_.reviewChanges,eB,eS]),eG=(0,a.useCallback)(()=>v.closeCurrent(),[v]),eW=(0,a.useCallback)(()=>v.duplicateCurrent(),[v]),eK=(0,a.useCallback)((e=!eM)=>{w(e?{...P,inspect:"on"}:C(P,"inspect"))},[eM,P,w]),eX=(0,ea.f1)(),eY=(0,a.useCallback)(e=>{if("production-preview"===e.action&&ej)return window.open(ej),!0;if("copy-document-url"===e.action&&navigator)return eX.log(iB),navigator.clipboard.writeText(window.location.toString()),I({id:"copy-document-url",status:"info",title:e$("panes.document-operation-results.operation-success_copy-url")}),!0;if("inspect"===e.action)return eK(!0),!0;if("reviewChanges"===e.action)return eq(),!0;if("string"==typeof e.action&&e.action.startsWith(tY)){let t=e.action.slice(tY.length),n=eC.find(e=>e.name===t);if(n)return n.name===e_?eV(n.name):eB(n.name),!0}return!1},[e$,eV,eq,e_,eC,eB,ej,eK,I,eX]),eQ=(0,a.useCallback)(()=>eK(!1),[eK]),[eZ,eJ]=(0,a.useState)([]),[e0,e1]=(0,a.useState)(),[e2,e8]=(0,a.useState)(),[e3,e5]=(0,a.useState)(),e4=(0,a.useCallback)((e,t)=>{e8(n=>(0,f.pt$)(n,e,t))},[]),e7=(0,a.useCallback)((e,t)=>{e5(n=>(0,f.pt$)(n,e,t))},[]),e9=(0,a.useCallback)((e,t)=>e1(n=>(0,f.pt$)(n,e,t)),[]),e6=G._createdAt?"update":"create",te=!!q?.liveEdit,tt=G._id?G._id:"dummy-id",tn=(0,a.useMemo)(()=>({...G,_id:te?(0,f.vsM)(tt):(0,f.qyu)(tt)}),[te,G,tt]),[ti,tr]=(0,f.vSY)({document:tn,permission:e6}),to=!G?._id,ts=(0,a.useMemo)(()=>{let e=!tr&&!ti?.granted,t=!(0,eu.jA)(q,"update"),n=to&&!(0,eu.jA)(q,"create"),i="reconnecting"===F,r=V.transactionSyncLock?.enabled;return!eP||null!==eh||e||t||n||i||r||W||eb},[F,V.transactionSyncLock,to,eb,W,tr,ti?.granted,eP,eh,q]),tl=(0,f.clL)(q,{value:eL,readOnly:ts,comparisonValue:eR,focusPath:ee,openPath:eZ,collapsedPaths:e2,presence:ev,validation:Z,collapsedFieldSets:e3,fieldGroupState:e0,changesOpen:ez});(0,a.useEffect)(()=>{p({documentId:R,documentType:D,schemaType:q,onChange:eH})},[R,D,q,eH,p]);let ta=(0,a.useRef)(tl);ta.current=tl;let tc=(0,a.useCallback)(e=>{(0,f.C8M)(ta.current,e).forEach(e=>{"expandPath"===e.type&&e8(t=>(0,f.pt$)(t,e.path,!1)),"expandFieldSet"===e.type&&e5(t=>(0,f.pt$)(t,e.path,!1)),"setSelectedGroup"===e.type&&e1(t=>(0,f.pt$)(t,e.path,e.groupName))}),eJ(e)},[ta]),td=(0,a.useCallback)((e,t)=>{j.setLocation([{type:"document",documentId:R,path:e,lastActiveAt:new Date().toISOString(),selection:t?.selection}])},[R,j]),tu=(0,a.useMemo)(()=>ep(td,1e3,{leading:!0,trailing:!0}),[td]),tp=(0,a.useCallback)((e,t)=>{et(e),em(en.current,e)||(tc(e.slice(0,-1)),en.current=e,o?.(e)),tu(e,t)},[o,tc,tu]),tm=(0,a.useMemo)(()=>({actions:X,activeViewId:ei,badges:Y,changesOpen:ez,closeInspector:eV,collapsedFieldSets:e3,collapsedPaths:e2,compareValue:eR,connectionState:F,displayed:eL,documentId:R,documentIdRaw:M,documentType:D,editState:V,fieldActions:eD,focusPath:ee,inspector:eT||null,inspectors:eC,__internal_tasks:m,onBlur:eO,onChange:eH,onFocus:tp,onPathOpen:tc,onHistoryClose:eF,onHistoryOpen:eq,onInspectClose:eQ,onMenuAction:eY,onPaneClose:eG,onPaneSplit:eW,onSetActiveFieldGroup:e9,onSetCollapsedPath:e4,onSetCollapsedFieldSet:e7,openInspector:eB,openPath:eZ,index:n,inspectOpen:eM,validation:Z,menuItemGroups:T||[],paneKey:r,previewUrl:ej,ready:eP,schemaType:q,isPermissionsLoading:tr,permissions:ti,setTimelineMode:eo,setTimelineRange:eA,setIsDeleting:K,isDeleting:W,isDeleted:eb,timelineError:es,timelineMode:er,timelineStore:ec,title:S,value:G,views:J,formState:tl,unstable_languageFilter:Q}),[m,X,ei,Y,ez,eV,e3,e2,eR,F,eT,eL,R,M,D,V,eD,ee,tl,eO,eH,tp,eF,eq,eQ,eY,e7,e4,eG,eW,e9,n,eM,eC,eb,W,tr,Q,T,eB,eZ,r,ti,ej,eP,q,tc,eA,es,er,ec,S,Z,G,J]);(0,a.useEffect)(()=>{"reconnecting"===F&&I({id:"sanity/structure/reconnecting",status:"warning",title:e$("panes.document-pane-provider.reconnecting.title")})},[F,I,e$]);let th=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{if(eP&&P.path){let{path:e,...t}=P,n=(0,k.vW)(ta.current?.value,(0,k.mL)(e));th.current=!0,em(en.current,n)||(et(n),tc(n),en.current=n,o?.(n));let i=setTimeout(()=>{th.current=!1},0);return v.setParams(t),()=>clearTimeout(i)}},[P,R,o,tc,eP,v]),(0,s.jsx)(c.cO.Provider,{value:tm,children:t})});iq.displayName="Memo(DocumentPaneProvider)";let iG=(0,a.memo)(function(e){let{name:t}=(0,f.Lky)();return(0,s.jsx)(f.cWh,{name:e.pane.source||t,children:(0,s.jsx)(f.Or8,{children:(0,s.jsx)(iW,{...e})})})});function iW(e){let{pane:t,paneKey:n}=e,{resolveNewDocumentOptions:i}=(0,f.Lky)().document,r=eU(),o=function(e,t={}){let n=(0,f.zEW)();return(0,a.useMemo)(()=>{if(e.type&&"*"!==e.type)return e;let i=e.template||t.template,r=(i?n.find(e=>e.id===i):void 0)?.schemaType;return r?{...e,type:r}:e},[e,t.template,n])}(t.options,r.params),{documentType:c,isLoaded:d}=(0,f.Hdz)(o.id,o.type),u=(0,f.uwK)({pick:iV,defaultComponent:iH}),p=(0,a.useMemo)(()=>i({type:"document",documentId:o.id,schemaType:o.type}),[o.id,o.type,i]),[m,h]=(0,f.UMU)({templateItems:p}),x=d&&!h,g=(0,a.useMemo)(()=>x&&c&&o.type!==c?{...e,pane:{...e.pane,options:{...o,type:c}}}:e,[e,c,x,o]),{ReferenceChildLink:y,handleEditReference:b,groupIndex:j,routerPanesState:v}=r,w=v[j+1]?.[0].params||{},C=v.length,{parentRefPath:_}=w,I=(0,a.useMemo)(()=>_?{path:(0,k.mL)(_),state:j>=C-1?"none":j>=C-2?"selected":"pressed"}:{path:[],state:"none"},[_,j,C]),{t:E}=(0,f.$G7)(ek);return"*"!==o.type||x?c?(0,s.jsx)(iq,{...g,children:(0,s.jsx)(f.euX,{EditReferenceLinkComponent:y,onEditReference:b,initialValueTemplateItems:m,activePath:I,children:(0,s.jsx)(tV,{documentId:o.id,documentType:o.type,children:(0,s.jsx)(u,{documentId:o.id,documentType:o.type})})})},`${c}-${o.id}`):(0,s.jsx)(tA,{flex:2.5,minWidth:320,paneKey:n,title:E("panes.document-pane.document-not-found.title"),children:(0,s.jsx)(l.Kq,{space:4,children:(0,s.jsx)(l.xv,{as:"p",children:(0,s.jsx)(f.vNl,{t:E,i18nKey:"panes.document-pane.document-not-found.text",values:{id:o.id},components:{Code:({children:e})=>(0,s.jsx)("code",{children:e})}})})})}):(0,s.jsx)(tU,{flex:2.5,minWidth:320,paneKey:n,title:E("panes.document-pane.document-not-found.loading")})}let iK={by:[{field:"_updatedAt",direction:"desc"}]},iX={},iY=(0,w.zo)(l.xu)`
  position: relative;
`,iQ=(0,w.zo)(l.xu)`
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
`,iZ=[...Array(30).keys()];function iJ(e){let{layout:t}=e;return(0,s.jsx)(l.Kq,{paddingX:3,paddingY:2,paddingTop:0,space:1,children:iZ.map(e=>(0,s.jsx)(f.ogX,{isPlaceholder:!0,layout:t},e))})}function i0(e){let{childItemId:t,error:n,filterIsSimpleTypeConstraint:i,hasMaxItems:r,hasSearchQuery:c,isActive:u,isLazyLoading:p,isLoading:m,items:h,layout:x,loadingVariant:g,onListChange:y,onRetry:b,paneTitle:j,searchInputElement:v,showIcons:w}=e,C=(0,f.I_y)(),{collapsed:_}=eL(),{collapsed:k,index:I}=e8(),[E,T]=(0,a.useState)(!1),{t:S}=(0,f.$G7)(ek),z=(0,a.useCallback)(()=>{m||p||!E||y()},[p,m,y,E]);(0,a.useEffect)(()=>{if(k)return;let e=setTimeout(()=>{T(!0)},0);return()=>{clearTimeout(e)}},[k,h]);let $=(0,a.useCallback)((e,{activeIndex:n})=>{let i=(0,f.vsM)(e._id),o=t===i,a=!u&&o,c=u&&o,d=n===h.length-1,m=d&&p,g=d&&r;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tD,{icon:!1!==w&&void 0,id:i,layout:x,marginBottom:1,pressed:a,schemaType:C.get(e._type),selected:c,value:e}),m&&(0,s.jsx)(f.Bwn,{}),g&&(0,s.jsx)(l.xu,{marginY:1,paddingX:3,paddingY:4,children:(0,s.jsx)(l.xv,{align:"center",muted:!0,size:1,children:S("panes.document-list-pane.max-items.text",{limit:2e3})})})]})},[t,u,h.length,x,C,w,r,p,S]),M=(0,a.useMemo)(()=>c?(0,s.jsx)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,s.jsx)(l.W2,{width:1,children:(0,s.jsx)(l.xu,{paddingX:4,paddingY:5,children:(0,s.jsx)(l.xv,{align:"center",muted:!0,children:S("panes.document-list-pane.no-documents.text")})})})}):(0,s.jsx)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,s.jsx)(l.W2,{width:1,children:(0,s.jsx)(l.xu,{paddingX:4,paddingY:5,children:(0,s.jsx)(l.xv,{align:"center",muted:!0,children:S(i?"panes.document-list-pane.no-documents-of-type.text":"panes.document-list-pane.no-matching-documents.text")})})})}),[i,c,S]),R=(0,a.useMemo)(()=>{if(!E)return null;if(n)return(0,s.jsx)(l.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:(0,s.jsx)(l.W2,{width:1,children:(0,s.jsxs)(l.Kq,{paddingX:4,paddingY:5,space:4,children:[(0,s.jsx)(l.X6,{as:"h3",children:S("panes.document-list-pane.error.title")}),(0,s.jsx)(l.xv,{as:"p",children:(0,s.jsx)(f.vNl,{t:S,i18nKey:"panes.document-list-pane.error.text",values:{error:n.message},components:{Code:({children:e})=>(0,s.jsx)("code",{children:e})}})}),b&&(0,s.jsx)(l.xu,{children:(0,s.jsx)(o.zx,{icon:d.bnu,onClick:b,text:S("panes.document-list-pane.error.retry-button.text"),tone:"primary"})})]})})});if(!m&&0===h.length)return M;if("initial"===g&&m)return(0,s.jsx)(eQ,{ms:300,children:(0,s.jsx)(iJ,{layout:x})});if("spinner"===g&&m)return null;let e=`${I}-${k}`;return(0,s.jsx)(iY,{overflow:"hidden",height:"fill",children:(0,s.jsx)(iQ,{children:(0,s.jsx)(f.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:j,canReceiveFocus:!0,inputElement:v,itemHeight:51,items:h,onEndReached:z,onlyShowSelectionWhenActive:!0,overscan:10,paddingBottom:1,paddingX:3,renderItem:$,wrapAround:!1},e)})})},[k,n,z,I,m,h,x,g,b,$,v,E]);return(0,s.jsx)(e3,{"data-testid":"document-list-pane",overflow:_||"initial"===g?"hidden":"auto",children:R})}function i1(e,t={}){try{let n=function e(t){switch(t.type){case"OpCall":{let{left:e,right:n}=t;switch(t.op){case"==":return"AccessAttribute"!==e.type||"_type"!==e.name||e.base?"AccessAttribute"!==n.type||"_type"!==n.name||n.base?null:"Value"!==e.type||"string"!=typeof e.value?null:new Set([e.value]):"Value"!==n.type||"string"!=typeof n.value?null:new Set([n.value]);case"in":{if("AccessAttribute"!==e.type||"_type"!==e.name||e.base||"Array"!==n.type)return null;let t=new Set;for(let e of n.elements){if(e.isSplat||"Value"!==e.value.type||"string"!=typeof e.value.value)return null;t.add(e.value.value)}return t.size?t:null}default:return null}}case"Group":return e(t.base);case"Or":{let n=e(t.left);if(!n)return null;let i=e(t.right);return i?new Set([...n,...i]):null}case"And":{let n=e(t.left),i=e(t.right);return n||i?new Set([...n||[],...i||[]]):null}default:return null}}((0,ev.Qc)(e,{params:t}));return n?Array.from(n).sort():null}catch{return null}}let i2=["_id","_type","_createdAt","_updatedAt","_rev"];function i8(e,t,n=!1){return t.map(t=>(function e(t,n,i=!1){let[r,...o]=n;if(!("fields"in t))return"";let s=t.fields.find(e=>e.name===r);if(!s){if(!i2.includes(r)){let e=`The current ordering config targeted the nonexistent field "${r}" on schema type "${t.name}". It should be one of ${t.fields.map(e=>e.name).join(", ")}`;if(i)throw Error(e);console.warn(e)}return""}if("to"in s.type&&"reference"===s.type.name){let t=s.type.to;return`${r}->{${t.map(t=>e(t,o)).join(",")}}`}let l=o.length>0&&e(s.type,o),a=l?`{${l}}`:"";return o.length>0?`${r}${a}`:r})(e,t.field.split("."),n)).join(", ")}let i3=[],i5={error:null,onRetry:void 0,result:null},i4={result:null,error:null},i7=(0,w.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,i9=(0,w.zo)(d.L4p)`
  animation: ${i7} 500ms linear infinite;
`,i6=(0,a.memo)(function(e){let{childItemId:t,isActive:n,pane:i,paneKey:r,sortOrder:o,layout:c}=e,u=(0,f.I_y)(),{displayOptions:p,options:m}=i,{apiVersion:h,filter:g}=m,y=rS(m.params||iX),b=(0,a.useMemo)(()=>{let e=i1(g,y);return e?.length===1?e[0]:null},[g,y]),j=p?.showIcons!==!1,{t:v}=(0,f.$G7)(ek),{title:w}=(0,f.v0Z)(i),[C,_]=(0,a.useState)(""),[T,M]=(0,a.useState)(""),[R,D]=(0,a.useState)(null),P=(0,a.useRef)(!1),Y=b&&o?function(e,t){let n=e.by.map(e=>{if(e.mapWith)return e;let n=function(e,t){let n=k.mL(t),i=e;for(let e of n){if(!i)return;if("string"==typeof e){i=function(e,t){if(!("fields"in e))return;let n=e.fields.find(e=>e.name===t);return n?n.type:void 0}(i,e);continue}if(!((0,x.Fd)(e)||(0,x.dw)(e))||"array"!==i.jsonType)return;let[t,n]=i.of||[];if(n||!t)return;if(!(0,x.dD)(t)){i=t;continue}let[r,o]=t.to||[];if(o||!r)return;i=r}return i}(t,e.field);return n?!function(e,t){let n=e.type;for(;n;){if(n.name===t||!n.type&&n.jsonType===t)return!0;n=n.type}return!1}(n,"datetime")?"string"===n.jsonType?{...e,mapWith:"lower"}:e:{...e,mapWith:"dateTime"}:e});return n.every((t,n)=>t===e.by[n])?e:{...e,by:n}}(o,u.get(b)):o,Q=(0,f.BoV)(Y),{error:Z,hasMaxItems:J,isLazyLoading:ee,isLoading:et,isSearchReady:ei,items:er,onListChange:eo,onRetry:es}=function(e){let{filter:t,params:n,sortOrder:i,searchQuery:r,apiVersion:o}=e,s=(0,f.m85)({...f.Dr7,apiVersion:o||f.Dr7.apiVersion}),{enableLegacySearch:l=!1}=(0,f.cFj)().search,c=(0,f.I_y)(),d=(0,f.NFh)(),[u,p]=(0,a.useState)(i5),{onRetry:m,error:h,result:x}=u,g=x?.documents,y=(0,a.useMemo)(()=>g?(0,f.RgL)(g).map(e=>({...e.draft||e.published,hasPublished:!!e.published,hasDraft:!!e.draft})):i3,[g]),[b,j]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[C,_]=(0,a.useState)(!1),k=(0,a.useMemo)(()=>i1(t,n),[t,n]),T=null===x&&!h,M=g?.length===2e3,R=(0,a.useCallback)(()=>{T||v||C||_(!0)},[T,v,C]),D=(0,a.useCallback)(e=>{if(e.error){p(e);return}let t=e.result?.documents?.length||0;if(!e.error&&e?.result===null&&C){j(!0);return}if(t<100&&0!==t&&!C&&w(!0),e?.result===null){p(t=>({...t.error?e:t}));return}j(!1),p(e)},[C]),P=(0,a.useMemo)(()=>{let e=new q.x,o=()=>e.next();return(function(e){let{client:t,schema:n,sort:i,limit:r,params:o,filter:s,searchQuery:l,staticTypeNames:a,maxFieldDepth:c,enableLegacySearch:d}=e,u=i.by,p=i?.extendedProjection,m=(0,L.P)(()=>t.listen(`*[${s}]`,o,{events:["welcome","mutation","reconnect"],includeResult:!1,visibility:"query"})).pipe((0,A.z)((e,t)=>0===t&&"welcome"!==e.type?(0,O._)(()=>Error("reconnect"===e.type?"Could not establish EventSource connection":`Received unexpected type of first event "${e.type}"`)):(0,S.of)(e)),(0,N.B)()),[h,x]=(0,U.u)(m,e=>"welcome"===e.type);return(0,z.T)(h.pipe((0,H.q)(1)),x.pipe((0,V.p)(1e3,B.z,{leading:!0,trailing:!0}))).pipe((0,ew.q)(e=>(a?(0,S.of)(a):t.observable.fetch(`array::unique(*[${s}][]._type)`,o)).pipe((0,A.z)(m=>{let h=(0,f.wBu)(n,a||[]).filter(e=>!!m.includes(e.name)&&(i8(e,i.by,!0),!0)),x=(0,f.mju)(h,t,{filter:s,params:o,enableLegacySearch:d,maxDepth:c}),g=()=>x({query:l||"",types:h},{__unstable_extendedProjection:p,comments:[`findability-source: ${l?"list-query":"list"}`],limit:r,skipSortByScore:!0,sort:u}).pipe((0,F.U)(e=>e.hits.map(({hit:e})=>e)));return"mutation"===e.type&&"query"!==e.visibility?(0,E.H)(1200).pipe((0,A.z)(g)):g()}))))})({client:s,filter:t,limit:C?2e3:100,params:n,schema:c,searchQuery:r||"",sort:i||iK,staticTypeNames:k,maxFieldDepth:d,enableLegacySearch:l}).pipe((0,F.U)(e=>({result:{documents:e},error:null})),(0,X.O)(i4),(0,K.K)(e=>e instanceof ProgressEvent?(0,O._)(()=>Error("Request error")):(0,O._)(()=>e)),(0,K.K)((t,n)=>(0,$.z)((0,S.of)({result:null,error:t}),(0,z.T)((0,I.R)(window,"online"),e).pipe((0,H.q)(1),(0,A.z)(()=>n)))),(0,en.R)((e,t)=>({...e,...t,onRetry:o})))},[C,i,s,t,n,c,r,k,d,l]);(0,a.useEffect)(()=>{let e=P.subscribe(D);return()=>{e.unsubscribe()}},[D,P]);let G=(0,a.useCallback)(()=>{w(!1),j(!1),p(i5),_(!1)},[]);return(0,a.useEffect)(()=>{G()},[G,t,n,i,r]),{error:h,hasMaxItems:M,isLazyLoading:b,isLoading:T,isSearchReady:!h,items:y,onListChange:R,onRetry:m}}({apiVersion:h,filter:g,params:y,searchQuery:C?.trim(),sortOrder:Q}),ea=(0,el.H)(e=>e.pipe((0,F.U)(e=>e.target.value),(0,G.b)(M),(0,W.D)(e=>""===e?(0,S.of)(""):(0,E.H)(300)),(0,G.b)(_))),ec=(0,a.useCallback)(()=>{_(""),M("")},[]),ed=(0,a.useCallback)(e=>{"Escape"===e.key&&ec()},[ec]);(0,a.useEffect)(()=>(!1!==P.current||et||(P.current=!0),()=>{P.current=!1}),[et]),(0,a.useEffect)(()=>{ec(),P.current=!1},[r,ec]);let eu=(0,a.useMemo)(()=>et&&0===er.length&&P.current?"spinner":"initial",[et,er.length]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.xu,{paddingX:3,paddingBottom:3,children:(0,s.jsx)(l.oi,{"aria-label":v("panes.document-list-pane.search-input.aria-label"),autoComplete:"off",border:!1,clearButton:!!C,disabled:!ei,fontSize:[2,2,1],icon:"spinner"===eu?i9:d.W1M,onChange:ea,onClear:ec,onKeyDown:ed,padding:2,placeholder:v("panes.document-list-pane.search-input.placeholder"),radius:2,ref:D,spellCheck:!1,value:T})}),(0,s.jsx)(i0,{childItemId:t,error:Z,filterIsSimpleTypeConstraint:!!b,hasMaxItems:J,hasSearchQuery:!!C,isActive:n,isLazyLoading:ee,isLoading:et,items:er,layout:c,loadingVariant:eu,onListChange:eo,onRetry:es,paneTitle:w,searchInputElement:R,showIcons:j},r)]})}),re=(0,a.memo)(({contentAfter:e,index:t,initialValueTemplates:n=[],menuItemGroups:i=[],menuItems:r=[],setLayout:l,setSortOrder:c,title:u})=>{let{features:p}=tK(),{collapsed:m,isLast:h}=e8(),f=(0,a.useMemo)(()=>({setLayout:({layout:e})=>{l(e)},setSortOrder:e=>{c(e)}}),[l,c]);return(0,s.jsx)(o.uE,{children:(0,s.jsx)(tp,{actions:(0,s.jsx)(t$,{initialValueTemplateItems:n,actionHandlers:f,menuItemGroups:i,menuItems:r}),backButton:p.backButton&&t>0&&(0,s.jsx)(o.zx,{as:eP,"data-as":"a",icon:d.Y4O,mode:"bleed",tooltipProps:{content:"Back"}}),contentAfter:e,tabIndex:h&&!m?-1:0,title:u})})});function rt(e){let{row:t,table:n}=e,{selectedAnchor:i,setSelectedAnchor:r}=n.options.meta||{},o=(0,a.useCallback)(e=>{if(e.shiftKey&&null!=i){let e=t.index,r=e<i?e:i,o=e<i?i:e,s=n.getRowModel().flatRows.slice(r,o+1).map(({id:e})=>e),l=n.getSelectedRowModel().rows.map(({id:e})=>e);n.setRowSelection(()=>[...s,...l].reduce((e,t)=>({...e,[t]:!0}),{}))}else r&&(r(t.getIsSelected()?null:t.index),t.toggleSelected())},[i,t,r,n]);return(0,s.jsx)(l.XZ,{style:{paddingLeft:4},checked:e.row.getIsSelected(),disabled:!e.row.getCanSelect(),onChange:()=>null,onClick:o})}re.displayName="Memo(PaneHeader)";let rn=()=>{let e=(0,a.useContext)(c.Q2);if(void 0===e)throw Error("useDocumentSheetListContext must be used within an DocumentSheetListProvider");return e};function ri({children:e,table:t}){let[n,i]=(0,a.useState)(null),[r,o]=(0,a.useState)([]),l=(0,a.useCallback)((e=null)=>{n?.state==="focused"&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),i(e),o([])},[n]),d=(0,a.useCallback)(()=>l(),[l]),u=(0,a.useCallback)(e=>{if(!n)return;let i=t.getVisibleLeafColumns(),r=i.findIndex(e=>e.id===n.colId)+("left"===e?-1:1);r<0||r>=i.length||l({colId:i[r].id,rowIndex:n.rowIndex,state:"selected"})},[l,n,t]),p=(0,a.useCallback)(e=>{n&&o(t=>{let{rowIndex:i}=n,r=t=>t+("down"===e?1:-1);if(!t.length){let e=r(i);return e<0?[]:[e]}let o=r(t[t.length-1]);return o<0?t:o===i?[]:t.includes(o)?t.slice(0,-1):[...t,o]})},[n]),m=(0,a.useCallback)((e,t)=>{l({colId:e,rowIndex:t,state:"selected"})},[l]),h=(0,a.useCallback)(()=>{n&&(r.length?o([]):l("selected"===n.state?null:{...n,state:"selected"}))},[l,n,r.length]),f=(0,a.useCallback)((e,t)=>{if(!n)return;let i="ArrowDown"===t?"down":"up",r="down"===i?1:-1;if(e)p(i);else{let e=n.rowIndex+r;if(e<0)return;m(n.colId,e)}},[p,n,m]),x=(0,a.useCallback)(e=>{if(!n)return;let{key:t,shiftKey:i}=e;switch(t){case"Shift":break;case"Escape":h();break;case"ArrowDown":case"ArrowUp":e.preventDefault(),f(i,t);break;case"ArrowLeft":case"ArrowRight":"selected"===n.state&&(e.preventDefault(),u("ArrowLeft"===t?"left":"right"))}},[n,h,f,u]),g=(0,a.useCallback)(e=>{n&&(document.getElementById(`cell-${n.colId}-${n.rowIndex}`)?.contains(e.target)||d())},[d,n]);(0,a.useEffect)(()=>(n&&(document.addEventListener("keydown",x),document.addEventListener("click",g)),()=>{n&&(document.removeEventListener("keydown",x),document.removeEventListener("click",g))}),[g,x,n]);let y=(0,a.useCallback)(()=>i(e=>e?{...e,state:"focused"}:null),[]),b=(0,a.useCallback)((e,t)=>n?.colId!==e?null:n.rowIndex===t?"focused"===n.state?"focused":"selectedAnchor":r.includes(t)?"selectedRange":null,[n,r]),j=(0,a.useCallback)(()=>{n&&l({colId:n.colId,rowIndex:n.rowIndex+1,state:"selected"})},[l,n]),v=(0,a.useMemo)(()=>({focusAnchorCell:y,resetFocusSelection:d,setSelectedAnchorCell:m,getStateByCellId:b,submitFocusedCell:j}),[y,d,m,b,j]);return(0,s.jsx)(c.Q2.Provider,{value:v,children:e})}let rr=w.zo.td`
  display: flex;
  overflow: hidden;
  box-sizing: border-box;
  width: ${({width:e})=>e}px;
  border-top: 1px solid var(--card-border-color);
  background-color: var(--card-bg-color);
`,ro=(0,w.zo)(rr)`
  position: sticky;
  z-index: 2;
`;function rs(e){let{getValue:t,column:n,row:i,fieldType:r}=e,o=`cell-${n.id}-${i.index}`,[c,d]=(0,a.useState)(t()),[u,p]=(0,a.useState)(!1),m=(0,a.useRef)(null),{focusAnchorCell:h,resetFocusSelection:f,setSelectedAnchorCell:x,getStateByCellId:g,submitFocusedCell:y}=rn(),b=g(n.id,i.index),j=(0,a.useCallback)(()=>{x(n.id,i.index),h()},[n.id,h,i.index,x]),{patchDocument:v}=e.table.options.meta||{},w=()=>{m.current?.focus(),m.current instanceof HTMLInputElement&&m.current.select()},C=(0,a.useCallback)(e=>{let{key:t}=e;"Enter"===t&&("selectedAnchor"===b&&w(),"focused"===b&&y())},[b,y]),_=(0,a.useCallback)(e=>{let t=e.clipboardData?.getData("Text");("string"==typeof t||"number"==typeof t)&&(d(t),v?.(i.id,n.id,t))},[n.id,v,i.id]),k=(0,a.useCallback)(()=>{navigator.clipboard.writeText(c.toString())},[c]);(0,a.useEffect)(()=>(("selectedAnchor"===b||"focused"===b)&&document.addEventListener("keydown",C),("selectedAnchor"===b||"selectedRange"===b)&&document.addEventListener("paste",_),"selectedAnchor"===b&&document.addEventListener("copy",k),()=>{("selectedAnchor"===b||"focused"===b)&&document.removeEventListener("keydown",C),("selectedAnchor"===b||"selectedRange"===b)&&document.removeEventListener("paste",_),"selectedAnchor"===b&&document.removeEventListener("copy",k)}),[o,b,n.id,g,k,C,_,i.index]);let I=()=>"focused"===b?"2px solid blue":"selectedRange"===b?"1px solid green":"selectedAnchor"===b?"1px solid blue":"1px solid transparent",E={onFocus:j,onBlur:()=>{u&&(v?.(i.id,n.id,c),p(!1)),f()},onMouseDown:e=>{2===e.detail?w():(e.preventDefault(),x(n.id,i.index))},"aria-selected":!!b,"data-testid":o,id:o,ref:e=>m.current=e};return"boolean"===r.name?(0,s.jsxs)(l.Ph,{...E,onChange:()=>null,radius:0,style:{boxShadow:"none",border:I(),padding:0},value:JSON.stringify(c),children:[(0,s.jsx)("option",{value:"True",children:"True"}),(0,s.jsx)("option",{value:"False",children:"False"})]}):(0,s.jsx)(l.oi,{...E,size:0,radius:0,border:!1,style:{border:I(),padding:"22px 16px"},value:"string"==typeof c||"number"==typeof c?c:JSON.stringify(c),onChange:e=>{p(!0),d(e.target.value)}})}function rl(e){let t=e.column.getIsPinned(),n=t&&e.column.getIsLastColumn("left")?2:1;return(0,s.jsx)(t?ro:rr,{style:{left:e.column.getStart("left")??void 0,borderRight:`${n}px solid var(--card-border-color)`},width:e.column.getSize(),children:(0,eC.ie)(e.column.columnDef.cell,e.getContext?.())},e.row.original._id+e.id)}let ra=e=>{let{documentPreviewStore:t,row:n,schemaType:i}=e,r=(0,a.useMemo)(()=>(0,f.eLL)(t,i,n.original._id,"Document title"),[t,n.original._id,i]),{draft:o,published:c,isLoading:d}=(0,el.m)(r,{draft:null,isLoading:!0,published:null});if(d)return(0,s.jsx)(l.xv,{size:1,muted:!0,children:"Loading..."});let u=o?.title??c?.title??"Untitled";return(0,s.jsxs)(l.kC,{align:"center",gap:3,children:[(0,s.jsx)(f.aAo,{draft:o,published:c}),(0,s.jsx)(l.xv,{size:1,children:u})]})},rc=(0,e_.Cl)(),rd=["string","number","boolean"],ru=(e,t)=>e.fields.reduce((e,n)=>{let{type:i,name:r}=n;return rd.includes(i.name)?[...e,rc.accessor(t?`${t}.${n.name}`:n.name,{id:t?`${t}_${n.name}`:n.name,header:n.type.title,enableHiding:!0,cell:e=>(0,s.jsx)(rs,{...e,fieldType:i})})]:"object"===i.name&&(0,x.m$)(i)&&!t?[...e,rc.group({header:r,columns:ru(i,n.name)})]:e},[]),rp=e=>e.flatMap(e=>"accessorKey"in e?e:"columns"in e&&e.columns?rp(e.columns):[]);function rm({table:e}){let{t}=(0,f.$G7)(),n=e.getVisibleLeafColumns().filter(e=>e.getCanHide()).length>=5,i=(0,a.useCallback)(()=>{e.resetColumnVisibility()},[e]),r=e=>()=>{e.toggleVisibility()},c=t=>{let i=t.getIsVisible(),r=1===e.getVisibleLeafColumns().filter(e=>e.getCanHide()).length;return n&&!i||r&&i};return(0,s.jsx)(o.j2,{button:(0,s.jsx)(o.zx,{mode:"bleed",text:t("sheet-list.edit-columns")}),id:"columns-control",menu:(0,s.jsx)(l.v2,{padding:3,paddingTop:4,style:{width:240},children:(0,s.jsxs)(l.kC,{direction:"column",height:"fill",gap:3,children:[(0,s.jsx)(l.xv,{weight:"semibold",size:1,children:t("sheet-list.select-fields")}),(0,s.jsx)(l.kC,{style:{flex:"1 1 auto",maxHeight:320,overflowY:"scroll"},children:(0,s.jsx)(l.Kq,{children:e.getAllLeafColumns().filter(e=>e.getCanHide()).map(e=>(0,s.jsxs)(l.kC,{marginY:2,align:"center",children:[(0,s.jsx)(l.XZ,{readOnly:c(e),checked:e.getIsVisible(),onChange:r(e),id:`col-visibility-${e.id}`,style:{display:"block"}}),(0,s.jsx)(l.xu,{flex:1,paddingLeft:3,children:(0,s.jsx)(l.xv,{size:1,children:(0,s.jsx)("label",{htmlFor:`col-visibility-${e.id}`,children:e.columnDef.header?.toString()})})})]},e.id))})}),(0,s.jsx)(o.zx,{width:"fill",mode:"ghost",text:t("sheet-list.reset-columns"),onClick:i})]})}),placement:"bottom",popover:{portal:!0}})}let rh=(0,w.zo)(l.kC)`
  flex-shrink: 0;
`;function rf(){let{state:{filtersVisible:e}}=(0,f.XNc)();return(0,s.jsxs)(rh,{children:[(0,s.jsx)(f.s8v,{}),e&&(0,s.jsx)(f.x$p,{showTypeFilter:!1})]})}let rx=w.zo.th`
  margin: 16px;
  z-index: 1;
  padding: 22px 0px;
  border-top: 1px solid var(--card-border-color);
  background-color: var(--card-badge-default-bg-color);
  box-sizing: border-box;
  text-align: left;
  width: ${({width:e})=>e}px;
  max-width: ${({width:e})=>e}px;
`,rg=(0,w.zo)(rx)`
  position: sticky;
  z-index: 2;
`,ry=w.zo.div`
  visibility: hidden;

  ${rx}:hover & {
    visibility: visible;
  }
`;function rb(e){let{header:t,headerGroup:n}=e,{t:i}=(0,f.$G7)(),r=t.column.getIsPinned(),a=n.depth>0&&!t.column.parent?null:(0,s.jsx)(l.xv,{size:1,weight:"semibold",textOverflow:"ellipsis",children:(0,eC.ie)(t.column.columnDef.header,t.getContext())}),c=t.column.getCanHide()&&(0===n.depth?!t.column.columns.length:t.column.parent),u=r&&t.column.getIsLastColumn("left")?2:1;return(0,s.jsx)(r?rg:rx,{style:{left:t.column.getStart("left")??void 0,borderRight:`${u}px solid var(--card-border-color)`},"data-testid":`header-${t.id}`,width:t.getSize(),children:(0,s.jsxs)(l.kC,{justify:"space-between",marginX:2,align:"baseline",children:[(0,s.jsx)(o.u,{delay:500,content:a,children:(0,s.jsx)(l.xu,{style:{boxSizing:"border-box"},marginLeft:3,marginRight:3,children:a})}),c&&(0,s.jsx)(ry,{children:(0,s.jsx)(o.j2,{button:(0,s.jsx)(o.zx,{tooltipProps:{content:"Open field menu"},mode:"bleed",icon:d.xXb,"data-testid":"field-menu-button"}),id:"field menu",popover:{placement:"bottom-end"},menu:(0,s.jsx)(l.v2,{children:(0,s.jsx)(o.sN,{text:i("sheet-list.hide-field"),icon:d.Two,onClick:()=>t.column.toggleVisibility()})})})})]})},t.id)}function rj({table:e}){return(0,s.jsx)(o.uE,{children:(0,s.jsxs)(l.kC,{gap:3,align:"center",children:[(0,s.jsx)(o.zx,{onClick:()=>e.setPageIndex(0),disabled:!e.getCanPreviousPage(),icon:d.TwJ,tooltipProps:{content:"Go to first page"}}),(0,s.jsx)(o.zx,{onClick:()=>e.previousPage(),disabled:!e.getCanPreviousPage(),icon:d.wyc,tooltipProps:{content:"Go to previous page"}}),(0,s.jsxs)(l.xv,{style:{whiteSpace:"nowrap"},children:[e.getState().pagination.pageIndex+1," of ",e.getPageCount()]}),(0,s.jsx)(o.zx,{onClick:()=>e.nextPage(),disabled:!e.getCanNextPage(),icon:d.XCv,tooltipProps:{content:"Go to next page"}}),(0,s.jsx)(o.zx,{onClick:()=>e.setPageIndex(e.getPageCount()-1),disabled:!e.getCanNextPage(),icon:d.hZl,tooltipProps:{content:"Go to last page"}}),(0,s.jsx)("select",{value:e.getState().pagination.pageSize,onChange:t=>{e.setPageSize(Number(t.target.value))},children:[25,50,100].map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})})}function rv(e,t){switch(t.type){case"DOCUMENTS_SET":{let n=t.documents.reduce((e,t)=>({...e,[t._id]:t}),{});return{...e,documents:n}}case"DOCUMENT_RECEIVED":{let n=t.payload;return{...e,documents:{...e.documents,[n._id]:n}}}case"DOCUMENT_DELETED":{let{[t.id]:n,...i}=e.documents;return{...e,documents:i}}case"DOCUMENT_UPDATED":{let n=t.payload,i=n._id,r={...e.documents[i],...n};return{...e,documents:{...e.documents,[i]:r}}}default:return e}}let rw={events:["welcome","mutation","reconnect"],includeResult:!0,visibility:"query"},rC=(0,w.zo)(l.kC)`
  height: 100%;
`,r_=w.zo.div`
  overflow: auto; //our scrollable table container
  position: relative; //needed for sticky header
`,rk=w.zo.table`
  border-collapse: separate;
  border-spacing: 0;
  font-family: arial, sans-serif;
  white-space: nowrap;
  width: 100%;
  border: 1px solid lightgray;

  thead {
    display: grid;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  tr {
    padding: 0;
  }
  tr:last-child {
    border-bottom: none;
  }
`;function rI({documentSchemaType:e}){let{dispatch:t,state:n}=(0,f.XNc)(),{columns:i,initialColumnsVisibility:r}=function(e){let t=(0,f.rq_)(),n=(0,a.useMemo)(()=>e?[rc.display({id:"selected",enableHiding:!1,header:e=>(0,s.jsxs)(l.xu,{children:[(0,s.jsx)(l.XZ,{style:{paddingLeft:4},indeterminate:e.table.getIsSomeRowsSelected(),onChange:e.table.getToggleAllPageRowsSelectedHandler()}),e.table.getSelectedRowModel().rows.length," selected"]}),cell:rt}),rc.accessor("Preview",{enableHiding:!1,id:"Preview",cell:n=>(0,s.jsx)(ra,{...n,documentPreviewStore:t,schemaType:e})}),...ru(e)]:[],[t,e]),[i]=(0,a.useMemo)(()=>rp(n).reduce(([e,t],n)=>{if(!n.id)throw Error("Column must have an id");let i=n.id;return n.enableHiding?5===t?[{...e,[i]:!1},t]:[{...e,[i]:!0},t+1]:[{...e,[i]:!0},t]},[{},0]),[n]);return{columns:n,initialColumnsVisibility:i}}(e),{data:o}=function({typeName:e}){let{state:t}=(0,f.XNc)(),n=(0,a.useMemo)(()=>{let e=new Map;return t.result.hits.forEach(t=>e.set((0,f.vsM)(t.hit._id),t.hit)),e},[t.result.hits]),{data:i,isLoading:r}=function({filter:e,params:t,apiVersion:n}){let i=`*[${e}][0...2000]`,r=(0,f.m85)({...f.Dr7,apiVersion:n||f.Dr7.apiVersion}),[o,s]=(0,a.useReducer)(rv,{documents:{}}),[l,c]=(0,a.useState)(null!==r),[d,u]=(0,a.useState)(null),p=(0,a.useCallback)(async()=>{if(!r){c(!1);return}try{let e=await r.fetch(i,t);s({type:"DOCUMENTS_SET",documents:e}),c(!1)}catch(e){u(e)}},[r,t,i]),m=(0,a.useCallback)(async e=>{if("welcome"===e.type&&(c(!0),await p(),c(!1)),"reconnect"===e.type&&c(!0),"mutation"===e.type){if("appear"===e.transition){let t=e.result;t&&s({type:"DOCUMENT_RECEIVED",payload:t})}if("disappear"===e.transition&&s({type:"DOCUMENT_DELETED",id:e.documentId}),"update"===e.transition){let t=e.result;t&&s({type:"DOCUMENT_UPDATED",payload:t})}}},[p]),h=(0,a.useMemo)(()=>r?r.observable.listen(i,t,rw).pipe((0,K.K)(e=>(u(e),(0,S.of)(e)))):(0,S.of)(),[r,t,i]);return(0,a.useEffect)(()=>{let e=h.subscribe(m);return()=>{e?.unsubscribe()}},[m,h]),{data:(0,a.useMemo)(()=>Object.values(Object.keys(o.documents).reduce((e,t)=>{let n=o.documents[t],i=n._id===(0,f.qyu)(n._id),r=i?n._id:(0,f.qyu)(n._id);return e[r]&&!i||(e[r]=n),e},{})),[o.documents]),isLoading:l,error:d}}({filter:`_type == "${e}"`});return{data:(0,a.useMemo)(()=>i.filter(e=>n.has((0,f.vsM)(e._id))),[i,n]),isLoading:r}}({typeName:e.name}),[c,d]=(0,a.useState)(null),u=n.result.hits.length,p=(0,eC.b7)({data:o,columns:i,getCoreRowModel:(0,e_.sC)(),getFilteredRowModel:(0,e_.vL)(),getPaginationRowModel:(0,e_.G_)(),autoResetPageIndex:!1,initialState:{columnPinning:{left:["selected","Preview"]},pagination:{pageSize:25},columnVisibility:r},getRowId:e=>e._id,meta:{selectedAnchor:c,setSelectedAnchor:d,patchDocument:(e,t,n)=>null}}),{rows:m}=p.getRowModel();(0,a.useEffect)(()=>(t({type:"TERMS_TYPE_ADD",schemaType:e}),()=>{t({type:"TERMS_TYPE_REMOVE",schemaType:e})}),[e,t]);let h=(0,a.useCallback)(e=>(0,s.jsx)(l.xu,{as:"tr",paddingY:2,style:{display:"flex",width:"100%"},children:e.getVisibleCells().map(t=>(0,a.createElement)(rl,{...t,key:e.original._id+t.id}))},e.original._id+e.id),[]),x=`Total: ${u} rows, showing ${m.length} rows`;return(0,s.jsxs)(rC,{direction:"column",paddingX:3,"data-testid":"document-sheet-list-pane",children:[(0,s.jsxs)(l.kC,{direction:"row",align:"center",paddingY:3,paddingX:1,justify:"space-between",children:[(0,s.jsxs)(l.kC,{direction:"row",align:"center",children:[(0,s.jsx)(rf,{}),(0,s.jsx)(l.xv,{size:0,muted:!0,children:x})]}),(0,s.jsx)(rm,{table:p})]}),(0,s.jsx)(r_,{children:(0,s.jsx)(ri,{table:p,children:(0,s.jsxs)(rk,{children:[(0,s.jsx)("thead",{children:p.getHeaderGroups().map(e=>(0,s.jsx)(l.xu,{as:"tr",children:e.headers.map(t=>(0,s.jsx)(rb,{header:t,headerGroup:e},t.id))},e.id))}),(0,s.jsx)("tbody",{children:p.getRowModel().rows.map(h)})]})})}),(0,s.jsx)(l.kC,{justify:"flex-end",padding:3,gap:4,paddingY:5,children:(0,s.jsx)(rj,{table:p})})]})}function rE(e){let t=(0,f.I_y)(),n=e.pane.schemaTypeName,i=t.get(n);if(!i||!(0,x.em)(i))throw Error(`Schema type "${n}" not found or not a document schema`);return(0,s.jsx)(f.X$R,{children:(0,s.jsx)(rI,{...e,documentSchemaType:i})})}let rT=e=>{let{menuItems:t,sortOrderRaw:n,layout:i}=e;return t?.map(e=>e.params?.layout?{...e,selected:i===e.params?.layout}:e?.params?.by?{...e,selected:eh(n?.by,e?.params?.by||f.LZ8)}:{...e,selected:!1})};function rS(e){let t=(0,a.useRef)(e);return ef(t.current,e)||(t.current=e),t.current}let rz=(0,a.memo)(function(e){let{index:t,isSelected:n,pane:i,paneKey:r}=e,{name:o}=(0,f.Lky)(),{defaultLayout:l="default",initialValueTemplates:c=f.LZ8,menuItemGroups:d,menuItems:u,options:p}=i,{defaultOrdering:m=f.LZ8,filter:h}=p,x=rS(p.params||iX),g=i.source,y=(0,a.useMemo)(()=>{let e=i1(h,x);return e?.length===1?e[0]:null},[h,x]),[b,j]=ne("layout",y??i.id,l),{title:v}=(0,f.v0Z)(i),w=(0,a.useMemo)(()=>m?.length>0?{by:m}:iK,[m]),[C,_]=ne("sort-order",y??i.id,w),k=(0,a.useMemo)(()=>rT({menuItems:u,sortOrderRaw:C,layout:b}),[b,u,C]),I="sheetList"===b,E=I?(0,a.createElement)(rE,{...e,key:e.pane.id}):(0,s.jsx)(i6,{...e,sortOrder:C,layout:b});return(0,s.jsx)(f.cWh,{name:g||o,children:(0,s.jsxs)(e1,{"data-ui":"DocumentListPane",id:r,minWidth:320,...I?{}:{currentMaxWidth:350,maxWidth:640},selected:n,children:[tF,(0,s.jsx)(re,{index:t,initialValueTemplates:c,menuItemGroups:d,menuItems:k,setLayout:j,setSortOrder:_,title:v}),E]})})});class r$ extends Error{path;helpId;constructor(e,t,n,i){super(e),this.name="SerializeError";let r=typeof n>"u"?"<unknown>":`${n}`;this.path=(t||[]).concat(i?`${r} (${i})`:r)}withHelpUrl(e){return this.helpId=e,this}}var rM=((r=rM||{}).ID_REQUIRED="structure-node-id-required",r.TITLE_REQUIRED="structure-title-required",r.FILTER_REQUIRED="structure-filter-required",r.INVALID_LIST_ITEM="structure-invalid-list-item",r.COMPONENT_REQUIRED="structure-view-component-required",r.DOCUMENT_ID_REQUIRED="structure-document-id-required",r.DOCUMENT_TYPE_REQUIRED="structure-document-type-required",r.SCHEMA_TYPE_REQUIRED="structure-schema-type-required",r.SCHEMA_TYPE_NOT_FOUND="structure-schema-type-not-found",r.LIST_ITEMS_MUST_BE_ARRAY="structure-list-items-must-be-array",r.QUERY_PROVIDED_FOR_FILTER="structure-query-provided-for-filter",r.ACTION_OR_INTENT_REQUIRED="structure-action-or-intent-required",r.LIST_ITEM_IDS_MUST_BE_UNIQUE="structure-list-item-ids-must-be-unique",r.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE="structure-action-and-intent-mutually-exclusive",r.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER="structure-api-version-required-for-custom-filter",r);let rR={title:"Last edited",i18n:{title:{key:"menu-items.sort-by.last-edited",ns:ek}},name:"lastEditedDesc",by:[{field:"_updatedAt",direction:"desc"}]},rD=[rR,{title:"Created",i18n:{title:{key:"menu-items.sort-by.created",ns:ek}},name:"lastCreatedDesc",by:[{field:"_createdAt",direction:"desc"}]}];function rP(e,t,n){return e instanceof rL?e.serialize({path:n,index:t}):e}class rL{constructor(e,t){this._context=e,this.spec=t||{}}spec;action(e){return this.clone({action:e})}getAction(){return this.spec.action}intent(e){return this.clone({intent:e})}getIntent(){return this.spec.intent}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}group(e){return this.clone({group:e})}getGroup(){return this.spec.group}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}params(e){return this.clone({params:e})}getParams(){return this.spec.params}showAsAction(e=!0){return this.clone({showAsAction:!!e})}getShowAsAction(){return this.spec.showAsAction}serialize(e={path:[]}){let{title:t,action:n,intent:i}=this.spec;if(!t){let t="string"==typeof n?`action: "${n}"`:void 0;throw new r$("`title` is required for menu item",e.path,e.index,t).withHelpUrl(rM.TITLE_REQUIRED)}if(!n&&!i)throw new r$(`\`action\` or \`intent\` required for menu item with title ${this.spec.title}`,e.path,e.index,`"${t}"`).withHelpUrl(rM.ACTION_OR_INTENT_REQUIRED);if(i&&n)throw new r$("cannot set both `action` AND `intent`",e.path,e.index,`"${t}"`).withHelpUrl(rM.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE);return{...this.spec,title:t}}clone(e){let t=new rL(this._context);return t.spec={...this.spec,...e||{}},t}}function rA(e,{by:t,title:n,i18n:i},r){let o=new rL(e).group("sorting").title(e.i18n.t("default-menu-item.fallback-title",{ns:"studio",replace:{title:n}})).icon(d.fzI).action("setSortOrder").params({by:t,extendedProjection:r});return i&&(o=o.i18n(i)),o}function rO(e,t){let{schema:n}=e,i="string"==typeof t?n.get(t):t;return i&&"orderings"in i?(i.orderings?i.orderings.concat(rD):rD).map(t=>rA(e,t,i8(i,t.by))):[]}function rN(e,t,n){return e instanceof rU?e.serialize({path:n,index:t}):e}class rU{constructor(e,t){this._context=e,this._id=t?t.id:"",this._title=t?t.title:"",this._i18n=t?t.i18n:void 0}_id;_title;_i18n;id(e){return new rU(this._context,{id:e,title:this._title,i18n:this._i18n})}getId(){return this._id}title(e){return new rU(this._context,{title:e,id:this._id,i18n:this._i18n})}getTitle(){return this._title}i18n(e){return new rU(this._context,{i18n:e,id:this._id,title:this._title})}getI18n(){return this._i18n}serialize(e={path:[]}){let{_id:t,_title:n,_i18n:i}=this;if(!t)throw new r$("`id` is required for a menu item group",e.path,e.index,n).withHelpUrl(rM.ID_REQUIRED);if(!n)throw new r$("`title` is required for a menu item group",e.path,t).withHelpUrl(rM.TITLE_REQUIRED);return{id:t,title:n,i18n:i}}}let rH=/([^A-Za-z0-9-_.])/;function rV(e,t,n){if("string"!=typeof e)throw new r$(`Structure node id must be of type string, got ${typeof e}`,t,n);let[i]=e.match(rH)||[];if(i)throw new r$(`Structure node id cannot contain character "${i}"`,t,n);if(e.startsWith("__edit__"))throw new r$("Structure node id cannot start with __edit__",t,n);return e}function rB(e,t){if(t)return t;let n=u(e);return rH.test(n)?u(p(e)):n}class rF{spec;constructor(e){this.spec={options:{},...e||{}}}id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:rB(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}child(e){return this.clone({child:e})}getChild(){return this.spec.child}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}canHandleIntent(e){return this.clone({canHandleIntent:e})}serialize(e={path:[]}){let{id:t,title:n,child:i,options:r,component:o}=this.spec;if(!t)throw new r$("`id` is required for `component` structure item",e.path,e.index).withHelpUrl(rM.ID_REQUIRED);if(!o)throw new r$("`component` is required for `component` structure item",e.path,e.index).withHelpUrl(rM.ID_REQUIRED);return{id:rV(t,e.path,e.index),title:n,type:"component",child:i,component:o,canHandleIntent:this.spec.canHandleIntent,options:r||{},menuItems:(this.spec.menuItems||[]).map((t,n)=>rP(t,n,e.path)),menuItemGroups:(this.spec.menuItemGroups||[]).map((t,n)=>rN(t,n,e.path))}}clone(e){let t=new rF;return t.spec={...this.spec,...e||{}},t}}async function rq(e,t){let n=(0,f.vsM)(t),i=(0,f.qyu)(t);return(await e(f.Dr7).fetch("*[_id in [$documentId, $draftId]]._type",{documentId:n,draftId:i},{tag:"structure.resolve-type"}))[0]}class rG{spec={};id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:this.spec.id||y(e)})}getTitle(){return this.spec.title}icon(e){return this.clone({icon:e})}getIcon(){return this.spec.icon}serialize(e={path:[]}){let{id:t,title:n,icon:i}=this.spec;if(!t)throw new r$("`id` is required for view item",e.path,e.index).withHelpUrl(rM.ID_REQUIRED);if(!n)throw new r$("`title` is required for view item",e.path,e.index).withHelpUrl(rM.TITLE_REQUIRED);return{id:rV(t,e.path,e.index),title:n,icon:i}}}function rW(e,t,n){return"function"==typeof e.serialize?e.serialize({path:n,index:t}):e}let rK=e=>(0,f.Uy$)(e)&&"component"===e.type;class rX extends rG{spec;constructor(e){let t=rK(e)?{...e}:{options:{}};super(),this.spec=t;let n="function"==typeof e?e:this.spec.component;n&&(this.spec=this.component(n).spec)}component(e){return this.clone({component:e})}getComponent(){return this.spec.component}options(e){return this.clone({options:e})}getOptions(){return this.spec.options||{}}serialize(e={path:[]}){let t=super.serialize(e),n=this.spec.component;if("function"!=typeof n)throw new r$("`component` is required and must be a function for `component()` view item",e.path,e.index).withHelpUrl(rM.COMPONENT_REQUIRED);return{...t,component:n,options:this.spec.options||{},type:"component"}}clone(e){let t=new rX;return t.spec={...this.spec,...e||{}},t}}class rY extends rG{spec;constructor(e){super(),this.spec={id:"editor",title:"Editor",...e||{}}}serialize(e={path:[]}){return{...super.serialize(e),type:"form"}}clone(e){let t=new rY;return t.spec={...this.spec,...e||{}},t}}let rQ=e=>new rY(e),rZ=e=>new rX(e);var rJ=Object.freeze({__proto__:null,ComponentViewBuilder:rX,FormViewBuilder:rY,GenericViewBuilder:rG,component:rZ,form:rQ,maybeSerializeView:rW});let r0=({resolveDocumentNode:e,getClient:t})=>async(n,{params:i,path:r})=>{let o=i.type,s=r.slice(0,r.length-1),l=r[r.length-1];if(o||(o=await rq(t,n)),!o)throw new r$("Failed to resolve document, and no type provided in parameters.",s,l);return e({documentId:n,schemaType:o})};class r1{constructor(e,t){this._context=e,this.spec=t||{}}spec;id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:rB(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}child(e){return this.clone({child:e})}getChild(){return this.spec.child}documentId(e){let t=this.spec.id||e;return this.clone({id:t,options:{...this.spec.options||{},id:e}})}getDocumentId(){return this.spec.options?.id}schemaType(e){return this.clone({options:{...this.spec.options||{},type:"string"==typeof e?e:e.name}})}getSchemaType(){return this.spec.options?.type}initialValueTemplate(e,t){return this.clone({options:{...this.spec.options||{},template:e,templateParameters:t}})}getInitialValueTemplate(){return this.spec.options?.template}getInitialValueTemplateParameters(){return this.spec.options?.templateParameters}views(e){return this.clone({views:e})}getViews(){return this.spec.views||[]}serialize({path:e=[],index:t,hint:n}={path:[]}){let i=e[t||e.length-1],r=this.spec.id||i&&`${i}`||"",o={id:r,type:void 0,template:void 0,templateParameters:void 0,...this.spec.options};if("string"!=typeof r||!r)throw new r$("`id` is required for document nodes",e,t,n).withHelpUrl(rM.ID_REQUIRED);if(!o||!o.id)throw new r$("document id (`id`) is required for document nodes",e,r,n).withHelpUrl(rM.DOCUMENT_ID_REQUIRED);if(!o||!o.type)throw new r$("document type (`schemaType`) is required for document nodes",e,r,n);let s=(this.spec.views&&this.spec.views.length>0?this.spec.views:[rQ()]).map((t,n)=>rW(t,n,e)),l=s.map(e=>e.id),a=g(l.filter((e,t)=>l.includes(e,t+1)));if(a.length>0)throw new r$(`document node has views with duplicate IDs: ${a.join(",  ")}`,e,r,n);return{...this.spec,child:this.spec.child||r0(this._context),id:rV(r,e,t),type:"document",options:function(e){let t={id:e.id||"",type:e.type||"*"};return e.template&&(t.template=e.template),e.templateParameters&&(t.templateParameters=e.templateParameters),t}(o),views:s}}clone(e={}){let t=new r1(this._context),n={...this.spec.options||{},...e.options||{}};return t.spec={...this.spec,...e,options:n},t}}function r2(e,t){let n=t?.type?e.resolveDocumentNode({schemaType:t.type}):new r1(e);if(!t)return n;let{id:i,type:r,template:o,templateParameters:s}=t.options;return n=n.id(t.id).documentId(i),r&&(n=n.schemaType(r)),o&&(n=n.initialValueTemplate(o,s)),t.child&&(n=n.child(t.child)),n}function r8({resolveDocumentNode:e,templates:t},n,i){let r=t.find(e=>e.id===n);if(!r)throw Error(`Template with ID "${n}" not defined`);return e({schemaType:r.schemaType}).initialValueTemplate(n,i)}class r3{constructor(e,t){this._context=e,this.spec=t||{}}spec;id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e})}getTitle(){return this.spec.title}description(e){return this.clone({description:e})}getDescription(){return this.spec.description}templateId(e){let t=this.spec.id||e;return this.clone({id:t,templateId:e})}getTemplateId(){return this.spec.templateId}parameters(e){return this.clone({parameters:e})}getParameters(){return this.spec.parameters}serialize({path:e=[],index:t,hint:n}={path:[]}){let{spec:i,_context:r}=this,{templates:o}=r;if("string"!=typeof i.id||!i.id)throw new r$("`id` is required for initial value template item nodes",e,t,n).withHelpUrl(rM.ID_REQUIRED);if(!i.templateId)throw new r$("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(rM.ID_REQUIRED);let s=o.find(e=>e.id===i.templateId);if(!s)throw new r$("template id (`templateId`) is required for initial value template item nodes",e,i.id,n).withHelpUrl(rM.ID_REQUIRED);return{id:i.id,templateId:i.id,schemaType:s.schemaType,type:"initialValueTemplateItem",description:i.description||s.description,title:i.title||s.title,subtitle:i.subtitle,icon:i.icon||s.icon,initialDocumentId:i.initialDocumentId,parameters:i.parameters}}clone(e={}){let t=new r3(this._context);return t.spec={...this.spec,...e},t}}function r5(e){let{schema:t,getStructureBuilder:n,templates:i}=e,r=t.getTypeNames();return i.filter(e=>!e.parameters?.length).sort((e,t)=>r.indexOf(e.schemaType)-r.indexOf(t.schemaType)).map(e=>n().initialValueTemplateItem(e.id))}function r4(e,t,n){return e instanceof r3?e.serialize({path:n,index:t}):e}function r7(e,t){let{schema:n,templates:i}=e;return t.map(t=>{let r=i.find(e=>e.id===t.templateId),o=t.title||r?.title||"Create",s={};r&&r.schemaType&&(s.type=r.schemaType),t.templateId&&(s.template=t.templateId);let l=t.parameters?[s,t.parameters]:s,a=r&&n.get(r.schemaType),c=t.i18n||r?.i18n,u=new rL(e).title(o).icon(r&&r.icon||a?.icon||d.dtP).intent({type:"create",params:l});return c&&(u=u.i18n(c)),u.serialize()})}let r9=Symbol("Document type list canHandleIntent"),r6=(e,t,{pane:n})=>{let i="create"===e,r=n.options?.filter||"",o=n.options?.params||{},s=n.schemaTypeName?[n.schemaTypeName]:ol(r,o),l=n.initialValueTemplates||[];return i&&t.template?l.some(e=>e.templateId===t.template):"edit"===e&&t.id&&s.includes(t.type)||i&&s.includes(t.type)};r6.identity=r9;let oe=["default","card","media","detail","block"];function ot(){}let on=(e,t,{pane:n,index:i})=>i<=1&&r6(e,t,{pane:n,index:i});class oi{initialValueTemplatesSpecified=!1;spec={};id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:rB(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}defaultLayout(e){return this.clone({defaultLayout:e})}getDefaultLayout(){return this.spec.defaultLayout}menuItems(e){return this.clone({menuItems:e})}getMenuItems(){return this.spec.menuItems}menuItemGroups(e){return this.clone({menuItemGroups:e})}getMenuItemGroups(){return this.spec.menuItemGroups}child(e){return this.clone({child:e})}getChild(){return this.spec.child}canHandleIntent(e){return this.clone({canHandleIntent:e})}getCanHandleIntent(){return this.spec.canHandleIntent}showIcons(e=!0){return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcons:e}})}getShowIcons(){return this.spec.displayOptions?this.spec.displayOptions.showIcons:void 0}initialValueTemplates(e){return this.initialValueTemplatesSpecified=!0,this.clone({initialValueTemplates:Array.isArray(e)?e:[e]})}getInitialValueTemplates(){return this.spec.initialValueTemplates}serialize(e={path:[]}){let t=this.spec.id||"",n=e.path,i=this.spec.defaultLayout;if(i&&!oe.includes(i))throw new r$(`\`layout\` must be one of ${oe.map(e=>`"${e}"`).join(", ")}`,n,t||e.index,this.spec.title);let r=(this.spec.initialValueTemplates||[]).map((e,t)=>r4(e,t,n));return{id:rV(t,e.path,t||e.index),title:this.spec.title,i18n:this.spec.i18n,type:"genericList",defaultLayout:i,child:this.spec.child||ot,canHandleIntent:this.spec.canHandleIntent||on,displayOptions:this.spec.displayOptions,initialValueTemplates:r,menuItems:(this.spec.menuItems||[]).map((e,t)=>rP(e,t,n)),menuItemGroups:(this.spec.menuItemGroups||[]).map((e,t)=>rN(e,t,n))}}}let or=(e,t)=>{let n=e.options?.filter.trim()||"";if(["*","{"].includes(n[0]))throw new r$(`\`filter\` cannot start with \`${n[0]}\` - looks like you are providing a query, not a filter`,t.path,e.id,e.title).withHelpUrl(rM.QUERY_PROVIDED_FOR_FILTER);return n},oo=e=>(t,n)=>{let i=n.parent,r=n.params?.template?e.templates.find(e=>e.id===n.params.template):void 0;return Promise.resolve(r?r.schemaType:i.schemaTypeName||rq(e.getClient,t)).then(n=>n?e.resolveDocumentNode({schemaType:n,documentId:t}):new r1(e).id("editor").documentId(t).schemaType(""))};class os extends oi{constructor(e,t){super(),this._context=e,this.spec=t||{},this.initialValueTemplatesSpecified=!!t?.initialValueTemplates}spec;apiVersion(e){return this.clone({options:{...this.spec.options||{filter:""},apiVersion:e}})}getApiVersion(){return this.spec.options?.apiVersion}filter(e){return this.clone({options:{...this.spec.options||{},filter:e}})}getFilter(){return this.spec.options?.filter}schemaType(e){let t="string"==typeof e?e:e.name;return this.clone({schemaTypeName:t})}getSchemaType(){return this.spec.schemaTypeName}params(e){return this.clone({options:{...this.spec.options||{filter:""},params:e}})}getParams(){return this.spec.options?.params}defaultOrdering(e){if(!Array.isArray(e))throw Error("`defaultOrdering` must be an array of order clauses");return this.clone({options:{...this.spec.options||{filter:""},defaultOrdering:e}})}getDefaultOrdering(){return this.spec.options?.defaultOrdering}serialize(e={path:[]}){if("string"!=typeof this.spec.id||!this.spec.id)throw new r$("`id` is required for document lists",e.path,e.index,this.spec.title).withHelpUrl(rM.ID_REQUIRED);if(!this.spec.options||!this.spec.options.filter)throw new r$("`filter` is required for document lists",e.path,this.spec.id,this.spec.title).withHelpUrl(rM.FILTER_REQUIRED);return this.spec.options?.filter!=="_type == $type"&&this.spec.options.filter&&!this.spec.options.apiVersion&&console.warn(`No apiVersion specified for document type list with custom filter: \`${this.spec.options.filter}\`. This will be required in the future. See %s for more info.`,(0,o.h0)(rM.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER)),{...super.serialize(e),type:"documentList",schemaTypeName:this.spec.schemaTypeName,child:this.spec.child||oo(this._context),options:{...this.spec.options,apiVersion:this.spec.options.apiVersion||f.Dr7.apiVersion,filter:or(this.spec,e)}}}clone(e){let t=new os(this._context);return t.spec={...this.spec,...e||{}},this.initialValueTemplatesSpecified||(t.spec.initialValueTemplates=function(e,t){let{document:n}=e,{schemaTypeName:i,options:r}=t,{filter:o,params:s}=r||{filter:"",params:{}},l=i?[i]:Array.from(new Set(ol(o,s)));if(0!==l.length)return l.flatMap(e=>n.resolveNewDocumentOptions({type:"structure",schemaType:e})).map(e=>({...e,icon:d.dtP}))}(this._context,t.spec)),t.spec.schemaTypeName||(t.spec.schemaTypeName=function(e){let{options:t}=e,{filter:n,params:i}=t||{filter:"",params:{}},r=ol(n,i);return 1===r.length?r[0]:void 0}(t.spec)),t}getSpec(){return this.spec}}function ol(e,t={}){let n=function(e,t={}){let n;let i=/\b_type\s*==\s*(['"].*?['"]|\$.*?(?:\s|$))|\B(['"].*?['"]|\$.*?(?:\s|$))\s*==\s*_type/g,r=[];for(;null!==(n=i.exec(e));)r.push(n[1]||n[2]);return r.map(e=>(("$"===e[0]?t[e.slice(1)]:e)||"").trim().replace(/^["']|["']$/g,"")).filter(Boolean)}(e,t);return 0===n.length&&(n=function(e,t={}){let n=e.match(/\b_type\s+in\s+\[(.*?)\]/);return n?n[1].split(/,\s*/).map(e=>e.trim().replace(/^["']+|["']+$/g,"")).map(e=>"$"===e[0]?t[e.slice(1)]:e).filter(Boolean):[]}(e,t)),n}let oa=e=>e instanceof op?"ListBuilder":(0,f.Uy$)(e)&&"function"==typeof e.then?"Promise":Array.isArray(e)?"array":typeof e,oc=e=>"listItem"===e.type,od=(e,t,n)=>(n.pane.items||[]).filter(ox).some(e=>e.schemaType.name===t.type&&e._id===t.id)||on(e,t,n),ou=(e,t)=>{let n=(t.parent.items.filter(oc).find(t=>t.id===e)||{child:void 0}).child;return n&&"function"==typeof n&&"function"==typeof n?n(e,t):n};class op extends oi{constructor(e,t){super(),this._context=e,this.spec=t||{},this.initialValueTemplatesSpecified=!!(t&&t.initialValueTemplates)}spec;items(e){return this.clone({items:e})}getItems(){return this.spec.items}serialize(e={path:[]}){let t=this.spec.id;if("string"!=typeof t||!t)throw new r$("`id` is required for lists",e.path,e.index).withHelpUrl(rM.ID_REQUIRED);let n=typeof this.spec.items>"u"?[]:this.spec.items;if(!Array.isArray(n))throw new r$("`items` must be an array of items",e.path,e.index).withHelpUrl(rM.LIST_ITEMS_MUST_BE_ARRAY);let i=(e.path||[]).concat(t),r=n.map((e,t)=>(function(e,t,n){if(e instanceof om)return e.serialize({path:n,index:t});if(e&&"divider"===e.type)return e;if(!e||"listItem"!==e.type){let i=e&&e.type||oa(e);throw new r$(`List items must be of type "listItem", got "${i}"${"array"===i?" - did you forget to spread (...moreItems)?":""}`,n,t).withHelpUrl(rM.INVALID_LIST_ITEM)}return e})(e,t,i)),o=r.filter((e,t)=>b(r,{id:e.id},t+1));if(o.length>0){let t=o.map(e=>e.id).slice(0,5),n=o.length>5?`${t.join(", ")}...`:t.join(", ");throw new r$(`List items with same ID found (${n})`,e.path,e.index).withHelpUrl(rM.LIST_ITEM_IDS_MUST_BE_UNIQUE)}return{...super.serialize(e),type:"list",canHandleIntent:this.spec.canHandleIntent||od,child:this.spec.child||ou,items:r}}clone(e){let t=new op(this._context);return t.spec={...this.spec,...e||{}},t}}class om{constructor(e,t){this._context=e,this.spec=t||{}}spec;id(e){return this.clone({id:e})}getId(){return this.spec.id}title(e){return this.clone({title:e,id:rB(e,this.spec.id)})}getTitle(){return this.spec.title}i18n(e){return this.clone({i18n:e})}getI18n(){return this.spec.i18n}icon(e){return this.clone({icon:e})}showIcon(e=!0){return this.clone({displayOptions:{...this.spec.displayOptions||{},showIcon:e}})}getShowIcon(){return this.spec.displayOptions?this.spec.displayOptions.showIcon:void 0}getIcon(){return this.spec.icon}child(e){return this.clone({child:e})}getChild(){return this.spec.child}schemaType(e){return this.clone({schemaType:e})}getSchemaType(){let e=this.spec.schemaType;return"string"==typeof e?this._context.schema.get(e):this.spec.schemaType}serialize(e={path:[]}){let{id:t,title:n,child:i}=this.spec;if("string"!=typeof t||!t)throw new r$("`id` is required for list items",e.path,e.index).withHelpUrl(rM.ID_REQUIRED);if(!e.titleIsOptional&&("string"!=typeof n||!n))throw new r$("`title` is required for list items",e.path,t).withHelpUrl(rM.TITLE_REQUIRED);let r=this.spec.schemaType;if("string"==typeof r){let n=this._context.schema.get(r);if(!n)throw new r$(`Could not find type "${r}" in schema`,e.path,t).withHelpUrl(rM.SCHEMA_TYPE_NOT_FOUND);r=n}let o={path:e.path.concat(t),hint:"child"},s=i instanceof rF||i instanceof os||i instanceof r1||i instanceof op?i.serialize(o):i;if("function"==typeof s){let e=s;s=(t,n)=>e(t,{...n,serializeOptions:o})}return{...this.spec,id:rV(t,e.path,e.index),schemaType:r,child:s,title:n,type:"listItem"}}clone(e){let t=new om(this._context);return t.spec={...this.spec,...e||{}},t}}let oh=(e,t)=>n=>{let i=t.schemaType&&("string"==typeof t.schemaType?t.schemaType:t.schemaType.name);return i?e.resolveDocumentNode({schemaType:i,documentId:n}):new r1(e).id("documentEditor").documentId(n)};class of extends om{constructor(e,t){super(e,t),this._context=e,this.spec=t||{}}spec;serialize(e={path:[]}){let t=super.serialize({...e,titleIsOptional:!0});if(!t.schemaType)throw new r$("`schemaType` is required for document list items",e.path,e.index).withHelpUrl(rM.SCHEMA_TYPE_REQUIRED);let n=t.child||oh(this._context,t);return{...t,child:n,schemaType:t.schemaType,_id:t.id}}clone(e){let t=new of(this._context);return t.spec={...this.spec,...e||{}},t}}function ox(e){return(0,f.Uy$)(e)&&"u">typeof e.schemaType&&"string"==typeof e._id}class og extends os{constructor(e,t){super(e),this._context=e,this.spec=t||{}}spec;child(e){return this.cloneWithoutDefaultIntentHandler({child:e})}clone(e){let t=super.clone(e),n=new og(this._context);return n.spec={...this.spec,...t.getSpec(),...e||{}},n}cloneWithoutDefaultIntentHandler(e){let t=super.clone(e),n=new og(this._context),i=this.spec.canHandleIntent,r=i&&i.identity===r9?{canHandleIntent:void 0}:{};return n.spec={...t.getSpec(),...this.spec,...e||{},...r},n}}let oy=["sanity.imageAsset","sanity.fileAsset"];function ob(e){return(function({schema:e}){return e.getTypeNames().filter(t=>{let n=e.get(t);return n&&n.type?.name==="document"}).filter(e=>!oy.includes(e))})(e).map(t=>oj(e,t))}function oj(e,t){let{schema:n}=e,i=n.get(t);if(!i)throw Error(`Schema type with name "${t}" not found`);let r=i.title||j(t);return new om(e).id(t).title(r).schemaType(i).child((n,i)=>{let r=i.parent,o="list"===r.type?r.items.find(e=>e.id===n):null,s=ov(e,t);return o&&o.title&&(s=s.title(o.title)),s})}function ov(e,t){let{schema:n,resolveDocumentNode:i}=e,r="string"==typeof t?t:t.schemaType,o="string"==typeof r?r:r.name,s="string"==typeof t?{schemaType:r}:t,l=n.get(o);if(!l)throw Error(`Schema type with name "${o}" not found`);let a=l.title||j(o);return new og(e).id(s.id||o).title(s.title||a).filter("_type == $type").params({type:o}).schemaType(l).defaultOrdering(rR.by).menuItemGroups(s.menuItemGroups||[{id:"sorting",title:"Sort",i18n:{title:{key:"menu-item-groups.actions-group",ns:ek}}},{id:"layout",title:"Layout",i18n:{title:{key:"menu-item-groups.layout-group",ns:ek}}},{id:"actions",title:"Actions",i18n:{title:{key:"menu-item-groups.sorting-group",ns:ek}}}]).child(s.child||(e=>i({schemaType:o,documentId:e}))).canHandleIntent(s.canHandleIntent||r6).menuItems(s.menuItems||[...rO(e,l),new rL(e).group("layout").i18n({title:{key:"menu-items.layout.compact-view",ns:ek}}).title("Compact view").icon(d.reJ).action("setLayout").params({layout:"default"}),new rL(e).group("layout").i18n({title:{key:"menu-items.layout.detailed-view",ns:ek}}).title("Detailed view").icon(d.cMY).action("setLayout").params({layout:"detail"})])}function ow({defaultDocumentNode:e,source:t}){let n=(0,f.nqf)(t),i={...t,getStructureBuilder:()=>r,resolveDocumentNode:t=>{let o=e?.(r,{...t,...n})||new r1(i);return o.getId()||(o=o.id("documentEditor")),t.documentId&&(o=o.documentId((0,f.vsM)(t.documentId))),o.schemaType(t.schemaType)}},r={defaults:()=>(function(e){let t=ob(e);return new op(e).id("__root__").title("Content").i18n({title:{key:"default-definition.content-title",ns:ek}}).items(t).showIcons(t.some(e=>{var t;return!!(t=e.getSchemaType())&&"string"!=typeof t&&!!t.icon}))})(i),documentTypeList:(...e)=>ov(i,...e),documentTypeListItem:(...e)=>oj(i,...e),documentTypeListItems:(...e)=>ob(i,...e),document:(...e)=>new r1(i,...e),documentWithInitialValueTemplate:(...e)=>r8(i,...e),defaultDocument:i.resolveDocumentNode,list:(...e)=>new op(i,...e),listItem:(...e)=>new om(i,...e),menuItem:(...e)=>new rL(i,...e),menuItemGroup:(...e)=>new rU(i,...e),menuItemsFromInitialValueTemplateItems:(...e)=>r7(i,...e),documentList:(...e)=>new os(i,...e),documentListItem:(...e)=>new of(i,...e),orderingMenuItem:(...e)=>rA(i,...e),orderingMenuItemsForType:(...e)=>rO(i,...e),editor:(...e)=>r2(i,...e),defaultInitialValueTemplateItems:(...e)=>r5(i,...e),initialValueTemplateItem:(e,t)=>new r3(i,{id:e,parameters:t,templateId:e}),component:e=>(0,h.isValidElementType)(e)?new rF().component(e):new rF(e),divider:()=>({id:m("__divider__"),type:"divider"}),view:rJ,context:i};return r}let oC=e=>{let{liveEdit:t}=e;return t?{label:"Live",color:"danger"}:null};oC.displayName="LiveEditBadge";let o_={activePanes:[]};function ok(e){o_.activePanes=e}function oI(e,t,n,i){let r=n?.panes||[],o=o_.activePanes||[],s=t.id||(0,v.Z)(),l="create"===e&&t.template;for(let n=o.length-1;n>=0;n--){let a=o[n];if("object"==typeof a&&(a.canHandleIntent?.(e,t,{pane:a,index:n})||"documentList"===a.type&&a.schemaTypeName===t.type&&"_type == $type"===a.options.filter)){let e=l?{template:t.template}:tq;return{panes:r.slice(0,n).concat([[{id:s,params:e,payload:i}]])}}}return{intent:e,params:t,payload:i}}let oE=(0,w.zo)(f.l$t)`
  height: 100%;
  overflow: auto;
  position: relative;
  scroll-behavior: smooth;
`;function oT({error:e,diff:t,documentContext:n,loading:i,schemaType:r}){return e?(0,s.jsx)(f.kwM,{}):i?(0,s.jsx)(f.Bwn,{showText:!0}):t?(0,s.jsx)(c.H7.Provider,{value:n,children:(0,s.jsx)(f.EyJ,{diff:t,schemaType:r})}):(0,s.jsx)(f.kwM,{})}let oS={error:d.uIy,warning:d.foC,info:d.hQ6},oz={error:"critical",warning:"caution",info:"primary"};function o$(e){let{marker:t,onOpen:n,schemaType:i,value:r}=e,o=(0,a.useCallback)(()=>n(t.path),[t,n]),[c,d]=(0,a.useState)(null);return(0,s.jsxs)(l.SV,{onCatch:d,children:[c&&(0,s.jsx)(l.Zb,{padding:3,radius:2,tone:"critical",children:(0,s.jsx)(l.xv,{size:1,children:c.error.message})}),!c&&(0,s.jsx)(l.Zb,{__unstable_focusRing:!0,as:"button",onClick:o,padding:3,radius:2,tone:oz[t.level],children:(0,s.jsxs)(l.kC,{align:"flex-start",gap:3,children:[(0,s.jsx)(l.xu,{flex:"none",children:(0,s.jsx)(l.xv,{size:1,children:(0,a.createElement)(oS[t.level])})}),(0,s.jsxs)(l.Kq,{flex:1,space:2,children:[(0,s.jsx)(oM,{path:t.path,schemaType:i,value:r}),(0,s.jsx)(l.xv,{muted:!0,size:1,children:t.message})]})]})})]})}function oM(e){let{path:t,schemaType:n,value:i}=e,r=(0,a.useMemo)(()=>{try{return function(e){let{path:t,schemaType:n,value:i}=e,r=[],o=n,s=i;for(let e of t){if("string"==typeof e){if(!(0,f.Uy$)(s)&&void 0!==s)throw Error(`Parent value is not an object, cannot get path segment: .${e}`);if("object"!==o.jsonType)throw Error(`Parent type is not an object schema type, cannot get path segment: .${e}`);s=s?.[e];let t=o.fields.find(t=>t.name===e);if(!t)return r.push({name:e}),r;o=t.type,r.push(o);continue}if("number"==typeof e){if(!(0,f.kJL)(s)&&void 0!==s)throw Error(`Parent value is not an array, cannot get path segment: [${e}]`);if("array"!==o.jsonType)throw Error(`Parent type is not an array schema type, cannot get path segment: [${e}]`);s=s?.[e];let t=o.of.find(e=>"string"==typeof s?"string"===e.jsonType:"number"==typeof s?"number"===e.jsonType:"boolean"==typeof s?"boolean"===e.jsonType:!!(0,f.Uy$)(s)&&e.name===s?._type);if(!t)throw Error(`Item type not found: [${e}]`);o=t,r.push(o);continue}if((0,f.Uy$)(e)&&e._key){if(!(0,f.kJL)(s))throw Error(`Parent value is not an array, cannot get path segment: [_key == ${e}]`);if("array"!==o.jsonType)throw Error(`Parent type is not an array schema type, cannot get path segment: .${e}`);if(s=(s??[]).find(t=>(0,f.Uy$)(t)&&t._key===e._key),!(0,f.Uy$)(s))throw Error(`Array item not found: [_key == ${e._key}]`);let t=o.of.find(e=>(0,f.Uy$)(s)&&e.name===s?._type);if(!t)throw Error(`Array item type not found: .${s?._type}`);o=t,r.push(o);continue}throw Error(`Invalid path segment: ${JSON.stringify(e)}`)}return r}({path:t,schemaType:n,value:i})}catch(e){console.error(e)}return null},[t,n,i]);return r?.length?(0,s.jsx)(l.xv,{size:1,children:r.map((e,t)=>(0,s.jsxs)(a.Fragment,{children:[t>0&&(0,s.jsx)("span",{style:{color:"var(--card-muted-fg-color)",opacity:.5},children:" / "}),(0,s.jsx)("span",{style:{fontWeight:500},children:e.title||e.name})]},t))}):null}let oR={},oD=_.BC.create("/",[_.BC.intents("/intent"),_.BC.create("/edit/:type/:editDocumentId",[_.BC.create({path:"/:params",transform:{params:{toState:function(e){try{return JSON.parse(decodeURIComponent(e))}catch{return console.warn("Failed to parse JSON parameters"),{}}},toPath:function(e){return JSON.stringify(e)}}}})]),_.BC.create({path:"/:panes",children:[_.BC.create("/:action",_.BC.create("/:legacyEditDocumentId"))],transform:{panes:{toState:function(e){var t;return -1!==(t=decodeURIComponent(e)).indexOf(",{")?function(e){let t=[],n=e;for(;n.length;){let[e,i,r]=n.match(oP)||[];if(!e){n=n.slice(1);continue}let o=r&&function(e){try{return JSON.parse(e)}catch(e){console.warn(`Failed to parse parameters: ${e.message}`);return}}(r);t.push({id:i,payload:o}),n=n.slice(e.length)}return[t]}(t):t.split(";").map(e=>{let[t,...n]=e.split("|").map(e=>{let[t,...n]=e.split(",");return function(e,t){let n={...t,params:oR,payload:void 0};return e.reduce((e,t)=>{if(oL(t)){let n=t.slice(0,t.indexOf("=")),i=t.slice(n.length+1);e.params={...e.params,[decodeURIComponent(n)]:decodeURIComponent(i)}}else oA(t)?e.payload=function(e){try{return e?(0,_.ZB)(e):void 0}catch(e){console.warn(`Failed to parse parameters: ${e.message}`);return}}(t):console.warn("Unknown pane segment: %s - skipping",t);return e},n)}(n,{id:t})});return[t,...n.map(e=>({...t,...e,id:e.id||t.id,params:{...C(t.params,oO),...e.params},payload:e.payload||t.payload}))]}).filter(e=>e.length>0)},toPath:function(e){return(e||[]).map(e=>e.map(oU).join("|")).map(encodeURIComponent).join(";")}}}})]),oP=/^([.a-z0-9_-]+),?({.*?})?(?:(;|$))/i,oL=e=>/^[a-z0-9]+=[^=]+/i.test(e),oA=e=>/^[A-Za-z0-9\-_]+(?:={0,2})$/.test(e),oO=["view","since","rev","inspect","comment"],oN=Boolean;function oU(e,t,n){let{payload:i,params:r={},id:o}=e,[s]=n,l=e===s,a=0!==t&&o===s.id,c=typeof i>"u"?void 0:(0,_.B8)(i),d=Object.entries(r).filter(e=>{let[t,n]=e;return!!n&&(!!l||!(n===s.params?.[t]&&!oO.includes(t)))}).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`);return[a?"":o].concat([d.length>0&&d,c].filter(oN).flat()).join(",")||","}let oH=[nW,nX,nU,nV,nO,nB],oV=[oC],oB=[{name:"sanity/structure/validation",component:function(e){let{onClose:t}=e,{onFocus:n,onPathOpen:i,schemaType:r,validation:o,value:c}=tH(),{t:d}=(0,f.$G7)("validation"),u=(0,a.useCallback)(e=>{i(e),n(e)},[n,i]);return(0,s.jsxs)(l.kC,{direction:"column",height:"fill",overflow:"hidden",children:[(0,s.jsx)(t3,{as:"header",closeButtonLabel:d("panel.close-button-aria-label"),flex:"none",onClose:t,title:d("panel.title")}),(0,s.jsxs)(l.Zb,{flex:1,overflow:"auto",padding:3,children:[0===o.length&&(0,s.jsx)(l.xu,{padding:2,children:(0,s.jsx)(l.xv,{muted:!0,size:1,children:d("panel.no-errors-message")})}),o.length>0&&(0,s.jsx)(l.Kq,{space:2,children:o.map((e,t)=>(0,s.jsx)(o$,{marker:e,onOpen:u,schemaType:r,value:c},t))})]})]})},useMenuItem:function(e){let{documentId:t,documentType:n}=e,{t:i}=(0,f.$G7)("validation"),{validation:r}=(0,f.a3k)(t,n),o=(0,a.useMemo)(()=>r.map(e=>({level:e.level,message:e.message,path:e.path})),[r]),s=o.some(x.z1),l=o.some(x.AY),c=(0,a.useMemo)(()=>s?d.uIy:l?d.foC:d.nSX,[s,l]),u=(0,a.useMemo)(()=>s?"critical":l?"caution":"positive",[s,l]);return{hidden:0===o.length,icon:c,title:i("panel.title"),tone:u,showAsAction:!0}}},{name:tZ,useMenuItem:()=>{let{features:e}=tK(),{t}=(0,f.$G7)();return{hidden:!e.reviewChanges,icon:d.vaD,title:t("changes.title")}},component:function(e){let{onClose:t}=e,{documentId:n,schemaType:i,timelineError:r,timelineStore:o,value:c}=tH(),d=(0,a.useRef)(null),u=(0,f.P08)(o,e=>e.diff),p=(0,f.P08)(o,e=>e.onOlderRevision),m=(0,f.P08)(o,e=>e.selectionState),h=(0,f.P08)(o,e=>e.sinceTime),x=!p,{t:g}=(0,f.$G7)("studio"),y=(0,a.useMemo)(()=>({documentId:n,schemaType:i,FieldWrapper:f.MUX,rootDiff:u,isComparingCurrent:x,value:c,showFromValue:!0}),[n,u,x,i,c]),b=(0,a.useMemo)(()=>u?function(e){let t=new Map;return(0,f.Z7x)(e,e=>{if("unchanged"===e.action||!("annotation"in e)||!e.annotation)return!0;let{author:n,timestamp:i}=e.annotation,r=t.get(n);return(!r||r.timestamp<i)&&t.set(n,e.annotation),!0}),Array.from(t.values()).sort((e,t)=>e.timestamp<t.timestamp?1:-1)}(u):[],[u]);return(0,s.jsxs)(l.kC,{"data-testid":"review-changes-pane",direction:"column",height:"fill",overflow:"hidden",children:[(0,s.jsx)(t3,{as:"header",closeButtonLabel:g("changes.action.close-label"),flex:"none",onClose:t,title:g("changes.title"),children:(0,s.jsxs)(l.kC,{gap:1,padding:3,paddingTop:0,paddingBottom:2,children:[(0,s.jsx)(l.xu,{flex:1,children:(0,s.jsx)(is,{mode:"since",chunk:h,placement:"bottom-start"})}),(0,s.jsx)(l.xu,{flex:"none",children:(0,s.jsx)(f.IIC,{annotations:b,description:g("changes.changes-by-author"),portal:!0,children:(0,s.jsx)(l.Jh,{maxLength:4,"aria-label":g("changes.changes-by-author"),children:b.map(({author:e})=>(0,s.jsx)(f.YtX,{user:e},e))})})})]})}),(0,s.jsx)(l.Zb,{flex:1,children:(0,s.jsx)(l.NM,{element:d.current,children:(0,s.jsx)(oE,{"data-ui":"Scroller",ref:d,children:(0,s.jsx)(l.xu,{flex:1,padding:4,children:(0,s.jsx)(oT,{diff:u,documentContext:y,error:r,loading:"loading"===m,schemaType:i})})})})})]})},onClose:({params:e})=>({params:{...e,since:void 0}}),onOpen:({params:e})=>({params:{...e,since:"@lastPublished"}})}],oF=(0,f.Cw0)(e=>{let t=e?.icon||d.kLv;return{name:"sanity/structure",document:{actions:e=>Array.from(new Set([...e,...oH])),badges:e=>Array.from(new Set([...e,...oV])),inspectors:e=>Array.from(new Set([...e,...oB]))},tools:[{name:e?.name||"structure",title:e?.title||"Structure",icon:t,component:(0,a.lazy)(()=>n.e(290).then(n.bind(n,10290))),canHandleIntent:(e,t)=>{var n;return"create"===e?"type"in t&&(!("template"in t)||{template:!0}):"edit"===e&&"id"in(n=t)&&(!("mode"in n)||{mode:"structure"===n.mode})},getIntentState:oI,controlsDocumentTitle:!0,options:e,router:oD}],i18n:{bundles:[eI]}}});function oq({defaultDocumentNode:e,structure:t,children:n}){let[i,r]=(0,a.useState)(!1),o=(0,f.Lky)(),l=(0,f.Q3k)(o),d=(0,f.H__)(),u=(0,a.useMemo)(()=>ow({defaultDocumentNode:e,source:o}),[e,o]),p=(0,a.useMemo)(()=>t?t(u,{...l,documentStore:d}):u.defaults(),[u,t,l,d]),m=(0,a.useMemo)(()=>({backButton:i,resizablePanes:!i,reviewChanges:!i,splitPanes:!i,splitViews:!i}),[i]),h=(0,a.useMemo)(()=>({features:m,layoutCollapsed:i,setLayoutCollapsed:r,rootPaneNode:p,structureContext:u.context}),[m,i,p,u.context]);return(0,s.jsx)(c.r1.Provider,{value:h,children:n})}var oG=Object.freeze({__proto__:null,default:iG}),oW=Object.freeze({__proto__:null,default:rz})}}]);